# runtemp.cmd.civet

import {
	undef, defined, SUCCEED, FAIL, flag, LOG,
	findFile, tryCmd, civet2tsFile, doUnitTest, doRun,
	} from 'base-utils'

if flag('h')
	# ---  -d invoked Chrome debugger
	#      -D causes debugging output
	SUCCEED "USAGE: runtemp [-d] [-D] { <stub> }"

# ---------------------------------------------------------------------------

let stub = 'temp'
lFlags: string[] := []
for arg of Deno.args
	if arg.startsWith('-')
		lFlags.push arg
	else if arg.match /^\d+$/
		stub = "temp#{arg}"
	else
		await tryCmd civet2tsFile, arg, 'lib'
		await tryCmd doUnitTest, arg, 'lib'

await tryCmd civet2tsFile, stub, undef
LOG '-'.repeat(40)
await tryCmd doRun, stub, undef, lFlags, {debug: flag('d')}
LOG '-'.repeat(40)
