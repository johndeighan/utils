"use strict";
// compile.cmd.civet

import {
	undef, defined, notdefined, pass, OL, assert, croak,
	getCmdArgs, watchFiles, allFilesMatching,
	DBG, LOG, WARN, ERR,
	getCompilerGlobPattern, compileFile, compileResult,
	} from '../lib/utils.lib.ts'

const {_, w: watch} = getCmdArgs({
	_: `files to compile, as one of the following:
	'<stub>.lib'  - file <stub>.lib.<ext>
	'<stub>.cmd'  - file <stub>.cmd.<ext>
	'<stub>.lib.test'  - file <stub>.lib.test.<ext>
	'<stub>.cmd.test'  - file <stub>.cmd.test.<ext>
	- a full or relative file path
where <ext> is a valid extension to compile`,
	w:    "watch for and recompile files if they change"
	})

let numCompiled = 0

// ---------------------------------------------------------------------------

const logResult = (hResult: compileResult): void => {

	const {relPath, status, outPath} = hResult
	switch(status) {
		case 'compiled': {
			LOG(`==> ${OL(relPath)}`)
			numCompiled += 1;break;
		}
		case 'exists': {
			pass();break;
		}
		default: {
			ERR(`Not compiled: ${OL(relPath)}`)
		}
	}
	return
}

// ---------------------------------------------------------------------------

if (_.length === 0) {
	const pattern = getCompilerGlobPattern()
	DBG("=====  Compiling all files  =====")
	DBG(`   pattern = ${OL(pattern)}`)
	for (const {path} of allFilesMatching(pattern)) {
		const hResult = compileFile(path)
		logResult(hResult)
	}
}

else {
	// --- Files can be specified as:
	//        - <stub>.(lib|cmd)
	//        - <stub>.(lib|cmd).test
	//        - a full or relative path
	//     Multiple files can be comma-separated

	for (const item of _) {const str: string = item;
		DBG(`non-option: ${OL(str)}`)
		for (const item1 of str.split(',')) {const str: string = item1;
			let ref;let ref1;if ((ref = str.match(/^([A-Za-z0-9_-]+)\.(lib|cmd)$/))) {const lMatches = ref;
				const [_, stub, purpose] = lMatches
				const pat = `**/${stub}.${purpose}.*`
				for (const {path} of allFilesMatching(pat)) {
					DBG(`compile file ${OL(path)}`)
					logResult(compileFile(path))
				}
			}
			else if ((ref1 = str.match(/^([A-Za-z0-9_-]+)\.(lib|cmd)\.test$/))) {const lMatches = ref1;
				const [_, stub, purpose] = lMatches
				const pat = `**/${stub}.${purpose}.test.*`
				for (const {path} of allFilesMatching(pat)) {
					DBG(`compile file ${OL(path)}`)
					logResult(compileFile(path))
				}
			}
			else {
				DBG(`compile file ${OL(str)}`)
				logResult(compileFile(str))
			}
		}
	}
}

LOG(`(${numCompiled} files compiled)`)

if (watch) {
	watchFiles(Deno.cwd(), ({kind, path}) => {
		console.log(`EVENT: ${kind} ${path}`)
		return false
	})
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2NtZC9jb21waWxlLmNtZC5jaXZldC50c3giLCJzb3VyY2VzIjpbInNyYy9jbWQvY29tcGlsZS5jbWQuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxvQkFBbUI7QUFDbkIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUNyRCxDQUFDLFVBQVUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0FBQzFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQ3JCLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxhQUFhLENBQUM7QUFDcEQsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQjtBQUM3QixBQUFBO0FBQ0EsQUFBQSxBQUFhLE1BQWIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFFLENBQUMsVUFBVSxDQUFBLEFBQUMsQ0FBQztBQUM3QixBQUFBLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBRztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FFRSxDQUFHLENBQUE7QUFDTCxBQUFBLENBQUMsQ0FBQyxDQUFDLElBQUksOENBQThDO0FBQ3JELENBQUMsQ0FBQyxDQUFBO0FBQ0YsQUFBQTtBQUNBLEFBQUEsQUFBQSxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ25CLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFTLE1BQVQsU0FBUyxDQUFDLENBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENB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Q3ZDLEFBQUEsS0FBSyxHQUFHLENBQUEsQUFBQyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ25DLEFBQUEsS0FBSyxTQUFTLENBQUEsQUFBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEM7SUFBQSxDO0dBQUEsQ0FBQTtBQUNoQyxBQUFBLEdBQUcsSUFBSSxDQUFBLENBQUE7QUFDUCxBQUFBLElBQUksR0FBRyxDQUFBLEFBQUMsQ0FBQyxhQUFhLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUNqQyxBQUFBLElBQUksU0FBUyxDQUFBLEFBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDO0dBQUEsQztFQUFBLEM7Q0FBQSxDO0FBQUEsQ0FBQTtBQUM5QixBQUFBO0FBQ0EsQUFBQSxBQUFBLEdBQUcsQ0FBQSxBQUFDLENBQUMsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFBO0FBQ3JDLEFBQUE7QUFDQSxBQUFBLEFBQUEsR0FBRyxDQUFBLEtBQUssQ0FBQSxDQUFBLENBQUE7QUFDUixBQUFBLENBQUMsVUFBVSxDQUFBLEFBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUN6QyxBQUFBLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQSxBQUFDLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQTtBQUN0QyxBQUFBLEVBQUUsTUFBTSxDQUFDLEs7Q0FBSyxDQUFBLEM7QUFBQSxDQUFBO0FBQ2QiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgY29tcGlsZS5jbWQuY2l2ZXRcblxuaW1wb3J0IHtcblx0dW5kZWYsIGRlZmluZWQsIG5vdGRlZmluZWQsIHBhc3MsIE9MLCBhc3NlcnQsIGNyb2FrLFxuXHRnZXRDbWRBcmdzLCB3YXRjaEZpbGVzLCBhbGxGaWxlc01hdGNoaW5nLFxuXHREQkcsIExPRywgV0FSTiwgRVJSLFxuXHRnZXRDb21waWxlckdsb2JQYXR0ZXJuLCBjb21waWxlRmlsZSwgY29tcGlsZVJlc3VsdCxcblx0fSBmcm9tICcuLi9saWIvdXRpbHMubGliLnRzJ1xuXG57Xywgdzogd2F0Y2h9IDo9IGdldENtZEFyZ3Mge1xuXHRfOiBcIlwiXCJcblx0XHRmaWxlcyB0byBjb21waWxlLCBhcyBvbmUgb2YgdGhlIGZvbGxvd2luZzpcblx0XHRcdCc8c3R1Yj4ubGliJyAgLSBmaWxlIDxzdHViPi5saWIuPGV4dD5cblx0XHRcdCc8c3R1Yj4uY21kJyAgLSBmaWxlIDxzdHViPi5jbWQuPGV4dD5cblx0XHRcdCc8c3R1Yj4ubGliLnRlc3QnICAtIGZpbGUgPHN0dWI+LmxpYi50ZXN0LjxleHQ+XG5cdFx0XHQnPHN0dWI+LmNtZC50ZXN0JyAgLSBmaWxlIDxzdHViPi5jbWQudGVzdC48ZXh0PlxuXHRcdFx0LSBhIGZ1bGwgb3IgcmVsYXRpdmUgZmlsZSBwYXRoXG5cdFx0d2hlcmUgPGV4dD4gaXMgYSB2YWxpZCBleHRlbnNpb24gdG8gY29tcGlsZVxuXHRcdFwiXCJcIlxuXHR3OiAgICBcIndhdGNoIGZvciBhbmQgcmVjb21waWxlIGZpbGVzIGlmIHRoZXkgY2hhbmdlXCJcblx0fVxuXG5sZXQgbnVtQ29tcGlsZWQgPSAwXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmxvZ1Jlc3VsdCA6PSAoaFJlc3VsdDogY29tcGlsZVJlc3VsdCk6IHZvaWQgPT5cblxuXHR7cmVsUGF0aCwgc3RhdHVzLCBvdXRQYXRofSA6PSBoUmVzdWx0XG5cdHN3aXRjaCBzdGF0dXNcblx0XHR3aGVuICdjb21waWxlZCdcblx0XHRcdExPRyBcIj09PiAje09MKHJlbFBhdGgpfVwiXG5cdFx0XHRudW1Db21waWxlZCArPSAxXG5cdFx0d2hlbiAnZXhpc3RzJ1xuXHRcdFx0cGFzcygpXG5cdFx0ZWxzZVxuXHRcdFx0RVJSIFwiTm90IGNvbXBpbGVkOiAje09MKHJlbFBhdGgpfVwiXG5cdHJldHVyblxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5pZiAoXy5sZW5ndGggPT0gMClcblx0cGF0dGVybiA6PSBnZXRDb21waWxlckdsb2JQYXR0ZXJuKClcblx0REJHIFwiPT09PT0gIENvbXBpbGluZyBhbGwgZmlsZXMgID09PT09XCJcblx0REJHIFwiICAgcGF0dGVybiA9ICN7T0wocGF0dGVybil9XCJcblx0Zm9yIHtwYXRofSBvZiBhbGxGaWxlc01hdGNoaW5nKHBhdHRlcm4pXG5cdFx0aFJlc3VsdCA6PSBjb21waWxlRmlsZSBwYXRoXG5cdFx0bG9nUmVzdWx0IGhSZXN1bHRcblxuZWxzZVxuXHQjIC0tLSBGaWxlcyBjYW4gYmUgc3BlY2lmaWVkIGFzOlxuXHQjICAgICAgICAtIDxzdHViPi4obGlifGNtZClcblx0IyAgICAgICAgLSA8c3R1Yj4uKGxpYnxjbWQpLnRlc3Rcblx0IyAgICAgICAgLSBhIGZ1bGwgb3IgcmVsYXRpdmUgcGF0aFxuXHQjICAgICBNdWx0aXBsZSBmaWxlcyBjYW4gYmUgY29tbWEtc2VwYXJhdGVkXG5cblx0Zm9yIHN0cjogc3RyaW5nIG9mIF9cblx0XHREQkcgXCJub24tb3B0aW9uOiAje09MKHN0cil9XCJcblx0XHRmb3Igc3RyOiBzdHJpbmcgb2Ygc3RyLnNwbGl0KCcsJylcblx0XHRcdGlmIGxNYXRjaGVzIDo9IHN0ci5tYXRjaCgvLy9eXG5cdFx0XHRcdFx0KFtBLVphLXowLTlfLV0rKVxuXHRcdFx0XHRcdFxcLlxuXHRcdFx0XHRcdChsaWJ8Y21kKVxuXHRcdFx0XHRcdCQvLy8pXG5cdFx0XHRcdFtfLCBzdHViLCBwdXJwb3NlXSA6PSBsTWF0Y2hlc1xuXHRcdFx0XHRwYXQgOj0gXCIqKi8je3N0dWJ9LiN7cHVycG9zZX0uKlwiXG5cdFx0XHRcdGZvciB7cGF0aH0gb2YgYWxsRmlsZXNNYXRjaGluZyhwYXQpXG5cdFx0XHRcdFx0REJHIFwiY29tcGlsZSBmaWxlICN7T0wocGF0aCl9XCJcblx0XHRcdFx0XHRsb2dSZXN1bHQgY29tcGlsZUZpbGUocGF0aClcblx0XHRcdGVsc2UgaWYgbE1hdGNoZXMgOj0gc3RyLm1hdGNoKC8vL15cblx0XHRcdFx0XHQoW0EtWmEtejAtOV8tXSspXG5cdFx0XHRcdFx0XFwuXG5cdFx0XHRcdFx0KGxpYnxjbWQpXG5cdFx0XHRcdFx0XFwuXG5cdFx0XHRcdFx0dGVzdFxuXHRcdFx0XHRcdCQvLy8pXG5cdFx0XHRcdFtfLCBzdHViLCBwdXJwb3NlXSA6PSBsTWF0Y2hlc1xuXHRcdFx0XHRwYXQgOj0gXCIqKi8je3N0dWJ9LiN7cHVycG9zZX0udGVzdC4qXCJcblx0XHRcdFx0Zm9yIHtwYXRofSBvZiBhbGxGaWxlc01hdGNoaW5nKHBhdClcblx0XHRcdFx0XHREQkcgXCJjb21waWxlIGZpbGUgI3tPTChwYXRoKX1cIlxuXHRcdFx0XHRcdGxvZ1Jlc3VsdCBjb21waWxlRmlsZShwYXRoKVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHREQkcgXCJjb21waWxlIGZpbGUgI3tPTChzdHIpfVwiXG5cdFx0XHRcdGxvZ1Jlc3VsdCBjb21waWxlRmlsZShzdHIpXG5cbkxPRyBcIigje251bUNvbXBpbGVkfSBmaWxlcyBjb21waWxlZClcIlxuXG5pZiB3YXRjaFxuXHR3YXRjaEZpbGVzIERlbm8uY3dkKCksICh7a2luZCwgcGF0aH0pID0+XG5cdFx0Y29uc29sZS5sb2cgXCJFVkVOVDogI3traW5kfSAje3BhdGh9XCJcblx0XHRyZXR1cm4gZmFsc2VcbiJdfQ==