"use strict";
// exec.lib.civet

type AutoPromise<T> = Promise<Awaited<T>>;
import fs from 'node:fs'
import {stripAnsiCode} from "@std/fmt/colors"
import {
	CompilerOptions, ScriptTarget, ModuleKind, CompilerHost,
	createSourceFile, createProgram, getPreEmitDiagnostics,
	flattenDiagnosticMessageText, createCompilerHost,
	} from "npm:typescript"

import {
	undef, defined, notdefined, assert, croak, hash,
	isString, isArray, isArrayOfStrings,
	} from 'datatypes'
import {
	getOptions, OL, pass, blockToArray,
	} from 'llutils'
import {
	getLogLevel, pushLogLevel, popLogLevel,
	DBG, LOG, WARN, ERR, LOGVALUE,
	INDENT, UNDENT, DBGVALUE, DBGLABELED,
	} from 'logger'
import {
	barf,
	} from 'fsys'

/**
 * @module exec - utilities for executing external code
 */

const textDecoder = new TextDecoder()

// ---------------------------------------------------------------------------

/**
 * convert ArrayBuffer, Int8Array, etc. to a string
 */

export const mkstr = (item: ((string | BufferSource) | undefined)): string => {

	if (isString(item)) {
		return stripAnsiCode(item)
	}
	else if (isArray(item)) {
		return stripAnsiCode(item.join(''))
	}
	else {
		return stripAnsiCode(textDecoder.decode(item))
	}
}

// ---------------------------------------------------------------------------

/**
 * build a command line from a command name and array of arguments
 */

export const getCmdLine = (cmdName: string, lArgs: string[]): string => {

	assert(isString(cmdName), `cmdName not a string: ${OL(cmdName)}`)
	assert(isArrayOfStrings(lArgs), `not an array of strings: ${OL(lArgs)}`)
	const cmdLine = `${cmdName} ${lArgs.join(' ')}`
	DBG(`cmdLine = ${OL(cmdLine)}`)
	return cmdLine
}

// ---------------------------------------------------------------------------

/**
 * build result hash to be returned by execCmd() or execCmdSync()
 */

export type TExecResult = {
	success: boolean
	code: number
	signal: (string | undefined)
	stdout?: string
	stderr?: string
	}

// ---------------------------------------------------------------------------
// ASYNC

export const execCmd = async (
	cmdName: string,
	lArgs: string[] = [],
	): AutoPromise<TExecResult> => {

	DBGLABELED("EXEC", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'inherit',
		stderr: 'inherit'
		})
	const {success, code, signal} = await child.output()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef
		}
}

// ---------------------------------------------------------------------------

export type TCmdDesc = [string, string[]]

export const execCmds = async (
		lCmds: TCmdDesc[]
		): AutoPromise<TExecResult[]> => {

	const results=[];for (const [cmdName, lArgs] of lCmds) {
		results.push(execCmd(cmdName, lArgs))
	};const lPromises =results

	const lResults = await Promise.all(lPromises)
	return lResults
}

// ---------------------------------------------------------------------------

export const execCmdSync = (
	cmdName: string,
	lArgs: string[] = [],
	): TExecResult => {

	DBGLABELED("EXEC SYNC", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'inherit',
		stderr: 'inherit'
		})
	const {success, code, signal} = child.outputSync()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef
		}
}

// ---------------------------------------------------------------------------
// ASYNC

export const getCmdOutput = async (
	cmdName: string,
	lArgs: string[] = [],
	): AutoPromise<TExecResult> => {

	DBGLABELED("EXEC(collect)", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'piped',
		stderr: 'piped'
		})
	const {success, code, signal, stdout, stderr} = await child.output()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef,
		stdout: mkstr(stdout),
		stderr: mkstr(stderr)
		}
}

// ---------------------------------------------------------------------------

export const getCmdOutputSync = (
	cmdName: string,
	lArgs: string[] = [],
	): TExecResult => {

	DBGLABELED("EXEC SYNC(collect)", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'piped',
		stderr: 'piped'
		})
	const {success, code, signal, stdout, stderr} = child.outputSync()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef,
		stdout: mkstr(stdout),
		stderr: mkstr(stderr)
		}
}

// ---------------------------------------------------------------------------

export const cmdSucceeds = (
	cmdName: string,
	lArgs: string[] = [],
	hOptions: hash = {}
	): boolean => {

	type opt = {
		quiet: boolean
		}
	const {quiet} = getOptions<opt>(hOptions, {
		quiet: true
		})
	try {
		if (!quiet) {
			pushLogLevel('silent')
		}
		getCmdOutputSync(cmdName, lArgs)
		if (!quiet) {
			popLogLevel()
		}
		return true
	}
	catch (err) {
		return false
	}
}

// ---------------------------------------------------------------------------

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFxleGVjLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXGxpYlxcZXhlYy5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxpQkFBZ0I7QUFDaEIsQUFBQTtBQUNBLEssVyx5QjtBQUFBLE1BQU0sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVM7QUFDeEIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUI7QUFDN0MsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxlQUFlLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxZQUFZLENBQUM7QUFDekQsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLHFCQUFxQixDQUFDO0FBQ3hELENBQUMsNEJBQTRCLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQztBQUNsRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCO0FBQ3hCLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNqRCxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0FBQ3JDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXO0FBQ25CLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsWUFBWSxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTO0FBQ2pCLEFBQUEsQUFBQSxNQUFNLENB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QSxDQUFBLENBQUE7QUFDZCxBQUFBLEdBQUcsV0FBVyxDQUFDLEM7RUFBQyxDQUFBO0FBQ2hCLEFBQUEsRUFBRSxNQUFNLENBQUMsSTtDQUFJLENBQUE7QUFDYixBQUFBLENBQUMsS0FBSyxDQUFDLENBQUEsR0FBRyxDQUFBLENBQUEsQ0FBQTtBQUNWLEFBQUEsRUFBRSxNQUFNLENBQUMsSztDQUFLLEM7QUFBQSxDQUFBO0FBQ2Q7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSIsIm5hbWVzIjpbXSwic291cmNlc0NvbnRlbnQiOlsiIyBleGVjLmxpYi5jaXZldFxyXG5cclxuaW1wb3J0IGZzIGZyb20gJ25vZGU6ZnMnXHJcbmltcG9ydCB7c3RyaXBBbnNpQ29kZX0gZnJvbSBcIkBzdGQvZm10L2NvbG9yc1wiXHJcbmltcG9ydCB7XHJcblx0Q29tcGlsZXJPcHRpb25zLCBTY3JpcHRUYXJnZXQsIE1vZHVsZUtpbmQsIENvbXBpbGVySG9zdCxcclxuXHRjcmVhdGVTb3VyY2VGaWxlLCBjcmVhdGVQcm9ncmFtLCBnZXRQcmVFbWl0RGlhZ25vc3RpY3MsXHJcblx0ZmxhdHRlbkRpYWdub3N0aWNNZXNzYWdlVGV4dCwgY3JlYXRlQ29tcGlsZXJIb3N0LFxyXG5cdH0gZnJvbSBcIm5wbTp0eXBlc2NyaXB0XCJcclxuXHJcbmltcG9ydCB7XHJcblx0dW5kZWYsIGRlZmluZWQsIG5vdGRlZmluZWQsIGFzc2VydCwgY3JvYWssIGhhc2gsXHJcblx0aXNTdHJpbmcsIGlzQXJyYXksIGlzQXJyYXlPZlN0cmluZ3MsXHJcblx0fSBmcm9tICdkYXRhdHlwZXMnXHJcbmltcG9ydCB7XHJcblx0Z2V0T3B0aW9ucywgT0wsIHBhc3MsIGJsb2NrVG9BcnJheSxcclxuXHR9IGZyb20gJ2xsdXRpbHMnXHJcbmltcG9ydCB7XHJcblx0Z2V0TG9nTGV2ZWwsIHB1c2hMb2dMZXZlbCwgcG9wTG9nTGV2ZWwsXHJcblx0REJHLCBMT0csIFdBUk4sIEVSUiwgTE9HVkFMVUUsXHJcblx0SU5ERU5ULCBVTkRFTlQsIERCR1ZBTFVFLCBEQkdMQUJFTEVELFxyXG5cdH0gZnJvbSAnbG9nZ2VyJ1xyXG5pbXBvcnQge1xyXG5cdGJhcmYsXHJcblx0fSBmcm9tICdmc3lzJ1xyXG5cclxuLyoqXHJcbiAqIEBtb2R1bGUgZXhlYyAtIHV0aWxpdGllcyBmb3IgZXhlY3V0aW5nIGV4dGVybmFsIGNvZGVcclxuICovXHJcblxyXG50ZXh0RGVjb2RlciA6PSBuZXcgVGV4dERlY29kZXIoKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBjb252ZXJ0IEFycmF5QnVmZmVyLCBJbnQ4QXJyYXksIGV0Yy4gdG8gYSBzdHJpbmdcclxuICovXHJcblxyXG5leHBvcnQgbWtzdHIgOj0gKGl0ZW06IChzdHJpbmcgfCBCdWZmZXJTb3VyY2UpPyk6IHN0cmluZyA9PlxyXG5cclxuXHRpZiBpc1N0cmluZyhpdGVtKVxyXG5cdFx0cmV0dXJuIHN0cmlwQW5zaUNvZGUoaXRlbSlcclxuXHRlbHNlIGlmIGlzQXJyYXkoaXRlbSlcclxuXHRcdHJldHVybiBzdHJpcEFuc2lDb2RlKGl0ZW0uam9pbignJykpXHJcblx0ZWxzZVxyXG5cdFx0cmV0dXJuIHN0cmlwQW5zaUNvZGUodGV4dERlY29kZXIuZGVjb2RlKGl0ZW0pKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBidWlsZCBhIGNvbW1hbmQgbGluZSBmcm9tIGEgY29tbWFuZCBuYW1lIGFuZCBhcnJheSBvZiBhcmd1bWVudHNcclxuICovXHJcblxyXG5leHBvcnQgZ2V0Q21kTGluZSA6PSAoY21kTmFtZTogc3RyaW5nLCBsQXJnczogc3RyaW5nW10pOiBzdHJpbmcgPT5cclxuXHJcblx0YXNzZXJ0IGlzU3RyaW5nKGNtZE5hbWUpLCBcImNtZE5hbWUgbm90IGEgc3RyaW5nOiAje09MKGNtZE5hbWUpfVwiXHJcblx0YXNzZXJ0IGlzQXJyYXlPZlN0cmluZ3MobEFyZ3MpLCBcIm5vdCBhbiBhcnJheSBvZiBzdHJpbmdzOiAje09MKGxBcmdzKX1cIlxyXG5cdGNtZExpbmUgOj0gXCIje2NtZE5hbWV9ICN7bEFyZ3Muam9pbignICcpfVwiXHJcblx0REJHIFwiY21kTGluZSA9ICN7T0woY21kTGluZSl9XCJcclxuXHRyZXR1cm4gY21kTGluZVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBidWlsZCByZXN1bHQgaGFzaCB0byBiZSByZXR1cm5lZCBieSBleGVjQ21kKCkgb3IgZXhlY0NtZFN5bmMoKVxyXG4gKi9cclxuXHJcbmV4cG9ydCB0eXBlIFRFeGVjUmVzdWx0ID0ge1xyXG5cdHN1Y2Nlc3M6IGJvb2xlYW5cclxuXHRjb2RlOiBudW1iZXJcclxuXHRzaWduYWw6IHN0cmluZz9cclxuXHRzdGRvdXQ/OiBzdHJpbmdcclxuXHRzdGRlcnI/OiBzdHJpbmdcclxuXHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4jIEFTWU5DXHJcblxyXG5leHBvcnQgZXhlY0NtZCA6PSAoXHJcblx0Y21kTmFtZTogc3RyaW5nLFxyXG5cdGxBcmdzOiBzdHJpbmdbXSA9IFtdLFxyXG5cdCk6IFRFeGVjUmVzdWx0ID0+XHJcblxyXG5cdERCR0xBQkVMRUQgXCJFWEVDXCIsIFwiI3tPTChnZXRDbWRMaW5lKGNtZE5hbWUsIGxBcmdzKSl9XCJcclxuXHREQkcgSU5ERU5UXHJcblx0Y2hpbGQgOj0gbmV3IERlbm8uQ29tbWFuZChjbWROYW1lLCB7XHJcblx0XHRhcmdzOiBsQXJncyxcclxuXHRcdGVudjoge0RFRkFVTFRfTE9HR0VSOiBnZXRMb2dMZXZlbCgpfVxyXG5cdFx0c3Rkb3V0OiAnaW5oZXJpdCdcclxuXHRcdHN0ZGVycjogJ2luaGVyaXQnXHJcblx0XHR9KVxyXG5cdHtzdWNjZXNzLCBjb2RlLCBzaWduYWx9IDo9IGF3YWl0IGNoaWxkLm91dHB1dCgpXHJcblx0REJHIFVOREVOVFxyXG5cdHJldHVybiB7XHJcblx0XHRzdWNjZXNzXHJcblx0XHRjb2RlXHJcblx0XHRzaWduYWw6IHNpZ25hbCB8fCB1bmRlZlxyXG5cdFx0fVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCB0eXBlIFRDbWREZXNjID0gW3N0cmluZywgc3RyaW5nW11dXHJcblxyXG5leHBvcnQgZXhlY0NtZHMgOj0gKFxyXG5cdFx0bENtZHM6IFRDbWREZXNjW11cclxuXHRcdCk6IFRFeGVjUmVzdWx0W10gPT5cclxuXHJcblx0bFByb21pc2VzIDo9IGZvciBbY21kTmFtZSwgbEFyZ3NdIG9mIGxDbWRzXHJcblx0XHRleGVjQ21kIGNtZE5hbWUsIGxBcmdzXHJcblxyXG5cdGxSZXN1bHRzIDo9IGF3YWl0IFByb21pc2UuYWxsKGxQcm9taXNlcylcclxuXHRyZXR1cm4gbFJlc3VsdHNcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgZXhlY0NtZFN5bmMgOj0gKFxyXG5cdGNtZE5hbWU6IHN0cmluZyxcclxuXHRsQXJnczogc3RyaW5nW10gPSBbXSxcclxuXHQpOiBURXhlY1Jlc3VsdCA9PlxyXG5cclxuXHREQkdMQUJFTEVEIFwiRVhFQyBTWU5DXCIsIFwiI3tPTChnZXRDbWRMaW5lKGNtZE5hbWUsIGxBcmdzKSl9XCJcclxuXHREQkcgSU5ERU5UXHJcblx0Y2hpbGQgOj0gbmV3IERlbm8uQ29tbWFuZChjbWROYW1lLCB7XHJcblx0XHRhcmdzOiBsQXJncyxcclxuXHRcdGVudjoge0RFRkFVTFRfTE9HR0VSOiBnZXRMb2dMZXZlbCgpfVxyXG5cdFx0c3Rkb3V0OiAnaW5oZXJpdCdcclxuXHRcdHN0ZGVycjogJ2luaGVyaXQnXHJcblx0XHR9KVxyXG5cdHtzdWNjZXNzLCBjb2RlLCBzaWduYWx9IDo9IGNoaWxkLm91dHB1dFN5bmMoKVxyXG5cdERCRyBVTkRFTlRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c3VjY2Vzc1xyXG5cdFx0Y29kZVxyXG5cdFx0c2lnbmFsOiBzaWduYWwgfHwgdW5kZWZcclxuXHRcdH1cclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiMgQVNZTkNcclxuXHJcbmV4cG9ydCBnZXRDbWRPdXRwdXQgOj0gKFxyXG5cdGNtZE5hbWU6IHN0cmluZyxcclxuXHRsQXJnczogc3RyaW5nW10gPSBbXSxcclxuXHQpOiBURXhlY1Jlc3VsdCA9PlxyXG5cclxuXHREQkdMQUJFTEVEIFwiRVhFQyhjb2xsZWN0KVwiLCBcIiN7T0woZ2V0Q21kTGluZShjbWROYW1lLCBsQXJncykpfVwiXHJcblx0REJHIElOREVOVFxyXG5cdGNoaWxkIDo9IG5ldyBEZW5vLkNvbW1hbmQoY21kTmFtZSwge1xyXG5cdFx0YXJnczogbEFyZ3MsXHJcblx0XHRlbnY6IHtERUZBVUxUX0xPR0dFUjogZ2V0TG9nTGV2ZWwoKX1cclxuXHRcdHN0ZG91dDogJ3BpcGVkJ1xyXG5cdFx0c3RkZXJyOiAncGlwZWQnXHJcblx0XHR9KVxyXG5cdHtzdWNjZXNzLCBjb2RlLCBzaWduYWwsIHN0ZG91dCwgc3RkZXJyfSA6PSBhd2FpdCBjaGlsZC5vdXRwdXQoKVxyXG5cdERCRyBVTkRFTlRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c3VjY2Vzc1xyXG5cdFx0Y29kZVxyXG5cdFx0c2lnbmFsOiBzaWduYWwgfHwgdW5kZWZcclxuXHRcdHN0ZG91dDogbWtzdHIoc3Rkb3V0KVxyXG5cdFx0c3RkZXJyOiBta3N0cihzdGRlcnIpXHJcblx0XHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGdldENtZE91dHB1dFN5bmMgOj0gKFxyXG5cdGNtZE5hbWU6IHN0cmluZyxcclxuXHRsQXJnczogc3RyaW5nW10gPSBbXSxcclxuXHQpOiBURXhlY1Jlc3VsdCA9PlxyXG5cclxuXHREQkdMQUJFTEVEIFwiRVhFQyBTWU5DKGNvbGxlY3QpXCIsIFwiI3tPTChnZXRDbWRMaW5lKGNtZE5hbWUsIGxBcmdzKSl9XCJcclxuXHREQkcgSU5ERU5UXHJcblx0Y2hpbGQgOj0gbmV3IERlbm8uQ29tbWFuZChjbWROYW1lLCB7XHJcblx0XHRhcmdzOiBsQXJncyxcclxuXHRcdGVudjoge0RFRkFVTFRfTE9HR0VSOiBnZXRMb2dMZXZlbCgpfVxyXG5cdFx0c3Rkb3V0OiAncGlwZWQnXHJcblx0XHRzdGRlcnI6ICdwaXBlZCdcclxuXHRcdH0pXHJcblx0e3N1Y2Nlc3MsIGNvZGUsIHNpZ25hbCwgc3Rkb3V0LCBzdGRlcnJ9IDo9IGNoaWxkLm91dHB1dFN5bmMoKVxyXG5cdERCRyBVTkRFTlRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c3VjY2Vzc1xyXG5cdFx0Y29kZVxyXG5cdFx0c2lnbmFsOiBzaWduYWwgfHwgdW5kZWZcclxuXHRcdHN0ZG91dDogbWtzdHIoc3Rkb3V0KVxyXG5cdFx0c3RkZXJyOiBta3N0cihzdGRlcnIpXHJcblx0XHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGNtZFN1Y2NlZWRzIDo9IChcclxuXHRjbWROYW1lOiBzdHJpbmcsXHJcblx0bEFyZ3M6IHN0cmluZ1tdID0gW10sXHJcblx0aE9wdGlvbnM6IGhhc2ggPSB7fVxyXG5cdCk6IGJvb2xlYW4gPT5cclxuXHJcblx0dHlwZSBvcHQgPSB7XHJcblx0XHRxdWlldDogYm9vbGVhblxyXG5cdFx0fVxyXG5cdHtxdWlldH0gOj0gZ2V0T3B0aW9uczxvcHQ+IGhPcHRpb25zLCB7XHJcblx0XHRxdWlldDogdHJ1ZVxyXG5cdFx0fVxyXG5cdHRyeVxyXG5cdFx0aWYgbm90IHF1aWV0XHJcblx0XHRcdHB1c2hMb2dMZXZlbCAnc2lsZW50J1xyXG5cdFx0Z2V0Q21kT3V0cHV0U3luYyBjbWROYW1lLCBsQXJnc1xyXG5cdFx0aWYgbm90IHF1aWV0XHJcblx0XHRcdHBvcExvZ0xldmVsKClcclxuXHRcdHJldHVybiB0cnVlXHJcblx0Y2F0Y2ggZXJyXHJcblx0XHRyZXR1cm4gZmFsc2VcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiJdfQ==