"use strict";
// exec.lib.civet

type AutoPromise<T> = Promise<Awaited<T>>;
import fs from 'node:fs'
import {stripAnsiCode} from "@std/fmt/colors"
import {
	CompilerOptions, ScriptTarget, ModuleKind, CompilerHost,
	createSourceFile, createProgram, getPreEmitDiagnostics,
	flattenDiagnosticMessageText, createCompilerHost,
	} from "npm:typescript"

import {
	undef, defined, notdefined, assert, croak, hash,
	isString, isArray, isArrayOfStrings,
	} from 'datatypes'
import {
	getOptions, pass, blockToArray,
	} from 'llutils'
import {OL} from 'to-nice'
import {
	getLogLevel, pushLogLevel, popLogLevel,
	DBG, LOG, WARN, ERR, LOGVALUE,
	INDENT, UNDENT, DBGVALUE, DBGLABELED,
	} from 'logger'
import {
	barf,
	} from 'fsys'

/**
 * @module exec - utilities for executing external code
 */

const textDecoder = new TextDecoder()

// ---------------------------------------------------------------------------

/**
 * convert ArrayBuffer, Int8Array, etc. to a string
 */

export const mkstr = (item: ((string | BufferSource) | undefined)): string => {

	if (isString(item)) {
		return stripAnsiCode(item)
	}
	else if (isArray(item)) {
		return stripAnsiCode(item.join(''))
	}
	else {
		return stripAnsiCode(textDecoder.decode(item))
	}
}

// ---------------------------------------------------------------------------

/**
 * build a command line from a command name and array of arguments
 */

export const getCmdLine = (cmdName: string, lArgs: string[]): string => {

	assert(isString(cmdName), `cmdName not a string: ${OL(cmdName)}`)
	assert(isArrayOfStrings(lArgs), `not an array of strings: ${OL(lArgs)}`)
	const cmdLine = `${cmdName} ${lArgs.join(' ')}`
	DBG(`cmdLine = ${OL(cmdLine)}`)
	return cmdLine
}

// ---------------------------------------------------------------------------

/**
 * build result hash to be returned by execCmd() or execCmdSync()
 */

export type TExecResult = {
	success: boolean
	code: number
	signal: (string | undefined)
	stdout?: string
	stderr?: string
	}

// ---------------------------------------------------------------------------
// ASYNC

export const execCmd = async (
	cmdName: string,
	lArgs: string[] = [],
	): AutoPromise<TExecResult> => {

	DBGLABELED("EXEC", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'inherit',
		stderr: 'inherit'
		})
	const {success, code, signal} = await child.output()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef
		}
}

// ---------------------------------------------------------------------------

export type TCmdDesc = [string, string[]]

export const execCmds = async (
		lCmds: TCmdDesc[]
		): AutoPromise<TExecResult[]> => {

	const results=[];for (const [cmdName, lArgs] of lCmds) {
		results.push(execCmd(cmdName, lArgs))
	};const lPromises =results

	const lResults = await Promise.all(lPromises)
	return lResults
}

// ---------------------------------------------------------------------------

export const execCmdSync = (
	cmdName: string,
	lArgs: string[] = [],
	): TExecResult => {

	DBGLABELED("EXEC SYNC", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'inherit',
		stderr: 'inherit'
		})
	const {success, code, signal} = child.outputSync()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef
		}
}

// ---------------------------------------------------------------------------
// ASYNC

export const getCmdOutput = async (
	cmdName: string,
	lArgs: string[] = [],
	): AutoPromise<TExecResult> => {

	DBGLABELED("EXEC(collect)", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'piped',
		stderr: 'piped'
		})
	const {success, code, signal, stdout, stderr} = await child.output()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef,
		stdout: mkstr(stdout),
		stderr: mkstr(stderr)
		}
}

// ---------------------------------------------------------------------------

export const getCmdOutputSync = (
	cmdName: string,
	lArgs: string[] = [],
	): TExecResult => {

	DBGLABELED("EXEC SYNC(collect)", `${OL(getCmdLine(cmdName, lArgs))}`)
	DBG(INDENT)
	const child = new Deno.Command(cmdName, {
		args: lArgs,
		env: {DEFAULT_LOGGER: getLogLevel()},
		stdout: 'piped',
		stderr: 'piped'
		})
	const {success, code, signal, stdout, stderr} = child.outputSync()
	DBG(UNDENT)
	return {
		success,
		code,
		signal: signal || undef,
		stdout: mkstr(stdout),
		stderr: mkstr(stderr)
		}
}

// ---------------------------------------------------------------------------

export const cmdSucceeds = (
	cmdName: string,
	lArgs: string[] = [],
	hOptions: hash = {}
	): boolean => {

	type opt = {
		quiet: boolean
		}
	const {quiet} = getOptions<opt>(hOptions, {
		quiet: true
		})
	try {
		if (!quiet) {
			pushLogLevel('silent')
		}
		getCmdOutputSync(cmdName, lArgs)
		if (!quiet) {
			popLogLevel()
		}
		return true
	}
	catch (err) {
		return false
	}
}

// ---------------------------------------------------------------------------

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFxleGVjLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXGxpYlxcZXhlYy5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxpQkFBZ0I7QUFDaEIsQUFBQTtBQUNBLEssVyx5QjtBQUFBLE1BQU0sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVM7QUFDeEIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUI7QUFDN0MsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxlQUFlLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxZQUFZLENBQUM7QUFDekQsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLHFCQUFxQixDQUFDO0FBQ3hELENBQUMsNEJBQTRCLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQztBQUNsRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCO0FBQ3hCLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNqRCxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0FBQ3JDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXO0FBQ25CLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsWUFBWSxDQUFDO0FBQ2hDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTO0FBQ2pCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQyxFQUFFLENB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SyxDQUFBO0FBQ2pDLEFBQUEsRUFBRSxHQUFHLENBQUEsQ0FBSSxLQUFLLENBQUEsQ0FBQSxDQUFBO0FBQ2QsQUFBQSxHQUFHLFdBQVcsQ0FBQyxDO0VBQUMsQ0FBQTtBQUNoQixBQUFBLEVBQUUsTUFBTSxDQUFDLEk7Q0FBSSxDQUFBO0FBQ2IsQUFBQSxDQUFDLEtBQUssQ0FBQyxDQUFBLEdBQUcsQ0FBQSxDQUFBLENBQUE7QUFDVixBQUFBLEVBQUUsTUFBTSxDQUFDLEs7Q0FBSyxDO0FBQUEsQ0FBQTtBQUNkO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgZXhlYy5saWIuY2l2ZXRcclxuXHJcbmltcG9ydCBmcyBmcm9tICdub2RlOmZzJ1xyXG5pbXBvcnQge3N0cmlwQW5zaUNvZGV9IGZyb20gXCJAc3RkL2ZtdC9jb2xvcnNcIlxyXG5pbXBvcnQge1xyXG5cdENvbXBpbGVyT3B0aW9ucywgU2NyaXB0VGFyZ2V0LCBNb2R1bGVLaW5kLCBDb21waWxlckhvc3QsXHJcblx0Y3JlYXRlU291cmNlRmlsZSwgY3JlYXRlUHJvZ3JhbSwgZ2V0UHJlRW1pdERpYWdub3N0aWNzLFxyXG5cdGZsYXR0ZW5EaWFnbm9zdGljTWVzc2FnZVRleHQsIGNyZWF0ZUNvbXBpbGVySG9zdCxcclxuXHR9IGZyb20gXCJucG06dHlwZXNjcmlwdFwiXHJcblxyXG5pbXBvcnQge1xyXG5cdHVuZGVmLCBkZWZpbmVkLCBub3RkZWZpbmVkLCBhc3NlcnQsIGNyb2FrLCBoYXNoLFxyXG5cdGlzU3RyaW5nLCBpc0FycmF5LCBpc0FycmF5T2ZTdHJpbmdzLFxyXG5cdH0gZnJvbSAnZGF0YXR5cGVzJ1xyXG5pbXBvcnQge1xyXG5cdGdldE9wdGlvbnMsIHBhc3MsIGJsb2NrVG9BcnJheSxcclxuXHR9IGZyb20gJ2xsdXRpbHMnXHJcbmltcG9ydCB7T0x9IGZyb20gJ3RvLW5pY2UnXHJcbmltcG9ydCB7XHJcblx0Z2V0TG9nTGV2ZWwsIHB1c2hMb2dMZXZlbCwgcG9wTG9nTGV2ZWwsXHJcblx0REJHLCBMT0csIFdBUk4sIEVSUiwgTE9HVkFMVUUsXHJcblx0SU5ERU5ULCBVTkRFTlQsIERCR1ZBTFVFLCBEQkdMQUJFTEVELFxyXG5cdH0gZnJvbSAnbG9nZ2VyJ1xyXG5pbXBvcnQge1xyXG5cdGJhcmYsXHJcblx0fSBmcm9tICdmc3lzJ1xyXG5cclxuLyoqXHJcbiAqIEBtb2R1bGUgZXhlYyAtIHV0aWxpdGllcyBmb3IgZXhlY3V0aW5nIGV4dGVybmFsIGNvZGVcclxuICovXHJcblxyXG50ZXh0RGVjb2RlciA6PSBuZXcgVGV4dERlY29kZXIoKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBjb252ZXJ0IEFycmF5QnVmZmVyLCBJbnQ4QXJyYXksIGV0Yy4gdG8gYSBzdHJpbmdcclxuICovXHJcblxyXG5leHBvcnQgbWtzdHIgOj0gKGl0ZW06IChzdHJpbmcgfCBCdWZmZXJTb3VyY2UpPyk6IHN0cmluZyA9PlxyXG5cclxuXHRpZiBpc1N0cmluZyhpdGVtKVxyXG5cdFx0cmV0dXJuIHN0cmlwQW5zaUNvZGUoaXRlbSlcclxuXHRlbHNlIGlmIGlzQXJyYXkoaXRlbSlcclxuXHRcdHJldHVybiBzdHJpcEFuc2lDb2RlKGl0ZW0uam9pbignJykpXHJcblx0ZWxzZVxyXG5cdFx0cmV0dXJuIHN0cmlwQW5zaUNvZGUodGV4dERlY29kZXIuZGVjb2RlKGl0ZW0pKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBidWlsZCBhIGNvbW1hbmQgbGluZSBmcm9tIGEgY29tbWFuZCBuYW1lIGFuZCBhcnJheSBvZiBhcmd1bWVudHNcclxuICovXHJcblxyXG5leHBvcnQgZ2V0Q21kTGluZSA6PSAoY21kTmFtZTogc3RyaW5nLCBsQXJnczogc3RyaW5nW10pOiBzdHJpbmcgPT5cclxuXHJcblx0YXNzZXJ0IGlzU3RyaW5nKGNtZE5hbWUpLCBcImNtZE5hbWUgbm90IGEgc3RyaW5nOiAje09MKGNtZE5hbWUpfVwiXHJcblx0YXNzZXJ0IGlzQXJyYXlPZlN0cmluZ3MobEFyZ3MpLCBcIm5vdCBhbiBhcnJheSBvZiBzdHJpbmdzOiAje09MKGxBcmdzKX1cIlxyXG5cdGNtZExpbmUgOj0gXCIje2NtZE5hbWV9ICN7bEFyZ3Muam9pbignICcpfVwiXHJcblx0REJHIFwiY21kTGluZSA9ICN7T0woY21kTGluZSl9XCJcclxuXHRyZXR1cm4gY21kTGluZVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8qKlxyXG4gKiBidWlsZCByZXN1bHQgaGFzaCB0byBiZSByZXR1cm5lZCBieSBleGVjQ21kKCkgb3IgZXhlY0NtZFN5bmMoKVxyXG4gKi9cclxuXHJcbmV4cG9ydCB0eXBlIFRFeGVjUmVzdWx0ID0ge1xyXG5cdHN1Y2Nlc3M6IGJvb2xlYW5cclxuXHRjb2RlOiBudW1iZXJcclxuXHRzaWduYWw6IHN0cmluZz9cclxuXHRzdGRvdXQ/OiBzdHJpbmdcclxuXHRzdGRlcnI/OiBzdHJpbmdcclxuXHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4jIEFTWU5DXHJcblxyXG5leHBvcnQgZXhlY0NtZCA6PSAoXHJcblx0Y21kTmFtZTogc3RyaW5nLFxyXG5cdGxBcmdzOiBzdHJpbmdbXSA9IFtdLFxyXG5cdCk6IFRFeGVjUmVzdWx0ID0+XHJcblxyXG5cdERCR0xBQkVMRUQgXCJFWEVDXCIsIFwiI3tPTChnZXRDbWRMaW5lKGNtZE5hbWUsIGxBcmdzKSl9XCJcclxuXHREQkcgSU5ERU5UXHJcblx0Y2hpbGQgOj0gbmV3IERlbm8uQ29tbWFuZChjbWROYW1lLCB7XHJcblx0XHRhcmdzOiBsQXJncyxcclxuXHRcdGVudjoge0RFRkFVTFRfTE9HR0VSOiBnZXRMb2dMZXZlbCgpfVxyXG5cdFx0c3Rkb3V0OiAnaW5oZXJpdCdcclxuXHRcdHN0ZGVycjogJ2luaGVyaXQnXHJcblx0XHR9KVxyXG5cdHtzdWNjZXNzLCBjb2RlLCBzaWduYWx9IDo9IGF3YWl0IGNoaWxkLm91dHB1dCgpXHJcblx0REJHIFVOREVOVFxyXG5cdHJldHVybiB7XHJcblx0XHRzdWNjZXNzXHJcblx0XHRjb2RlXHJcblx0XHRzaWduYWw6IHNpZ25hbCB8fCB1bmRlZlxyXG5cdFx0fVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCB0eXBlIFRDbWREZXNjID0gW3N0cmluZywgc3RyaW5nW11dXHJcblxyXG5leHBvcnQgZXhlY0NtZHMgOj0gKFxyXG5cdFx0bENtZHM6IFRDbWREZXNjW11cclxuXHRcdCk6IFRFeGVjUmVzdWx0W10gPT5cclxuXHJcblx0bFByb21pc2VzIDo9IGZvciBbY21kTmFtZSwgbEFyZ3NdIG9mIGxDbWRzXHJcblx0XHRleGVjQ21kIGNtZE5hbWUsIGxBcmdzXHJcblxyXG5cdGxSZXN1bHRzIDo9IGF3YWl0IFByb21pc2UuYWxsKGxQcm9taXNlcylcclxuXHRyZXR1cm4gbFJlc3VsdHNcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgZXhlY0NtZFN5bmMgOj0gKFxyXG5cdGNtZE5hbWU6IHN0cmluZyxcclxuXHRsQXJnczogc3RyaW5nW10gPSBbXSxcclxuXHQpOiBURXhlY1Jlc3VsdCA9PlxyXG5cclxuXHREQkdMQUJFTEVEIFwiRVhFQyBTWU5DXCIsIFwiI3tPTChnZXRDbWRMaW5lKGNtZE5hbWUsIGxBcmdzKSl9XCJcclxuXHREQkcgSU5ERU5UXHJcblx0Y2hpbGQgOj0gbmV3IERlbm8uQ29tbWFuZChjbWROYW1lLCB7XHJcblx0XHRhcmdzOiBsQXJncyxcclxuXHRcdGVudjoge0RFRkFVTFRfTE9HR0VSOiBnZXRMb2dMZXZlbCgpfVxyXG5cdFx0c3Rkb3V0OiAnaW5oZXJpdCdcclxuXHRcdHN0ZGVycjogJ2luaGVyaXQnXHJcblx0XHR9KVxyXG5cdHtzdWNjZXNzLCBjb2RlLCBzaWduYWx9IDo9IGNoaWxkLm91dHB1dFN5bmMoKVxyXG5cdERCRyBVTkRFTlRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c3VjY2Vzc1xyXG5cdFx0Y29kZVxyXG5cdFx0c2lnbmFsOiBzaWduYWwgfHwgdW5kZWZcclxuXHRcdH1cclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiMgQVNZTkNcclxuXHJcbmV4cG9ydCBnZXRDbWRPdXRwdXQgOj0gKFxyXG5cdGNtZE5hbWU6IHN0cmluZyxcclxuXHRsQXJnczogc3RyaW5nW10gPSBbXSxcclxuXHQpOiBURXhlY1Jlc3VsdCA9PlxyXG5cclxuXHREQkdMQUJFTEVEIFwiRVhFQyhjb2xsZWN0KVwiLCBcIiN7T0woZ2V0Q21kTGluZShjbWROYW1lLCBsQXJncykpfVwiXHJcblx0REJHIElOREVOVFxyXG5cdGNoaWxkIDo9IG5ldyBEZW5vLkNvbW1hbmQoY21kTmFtZSwge1xyXG5cdFx0YXJnczogbEFyZ3MsXHJcblx0XHRlbnY6IHtERUZBVUxUX0xPR0dFUjogZ2V0TG9nTGV2ZWwoKX1cclxuXHRcdHN0ZG91dDogJ3BpcGVkJ1xyXG5cdFx0c3RkZXJyOiAncGlwZWQnXHJcblx0XHR9KVxyXG5cdHtzdWNjZXNzLCBjb2RlLCBzaWduYWwsIHN0ZG91dCwgc3RkZXJyfSA6PSBhd2FpdCBjaGlsZC5vdXRwdXQoKVxyXG5cdERCRyBVTkRFTlRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c3VjY2Vzc1xyXG5cdFx0Y29kZVxyXG5cdFx0c2lnbmFsOiBzaWduYWwgfHwgdW5kZWZcclxuXHRcdHN0ZG91dDogbWtzdHIoc3Rkb3V0KVxyXG5cdFx0c3RkZXJyOiBta3N0cihzdGRlcnIpXHJcblx0XHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGdldENtZE91dHB1dFN5bmMgOj0gKFxyXG5cdGNtZE5hbWU6IHN0cmluZyxcclxuXHRsQXJnczogc3RyaW5nW10gPSBbXSxcclxuXHQpOiBURXhlY1Jlc3VsdCA9PlxyXG5cclxuXHREQkdMQUJFTEVEIFwiRVhFQyBTWU5DKGNvbGxlY3QpXCIsIFwiI3tPTChnZXRDbWRMaW5lKGNtZE5hbWUsIGxBcmdzKSl9XCJcclxuXHREQkcgSU5ERU5UXHJcblx0Y2hpbGQgOj0gbmV3IERlbm8uQ29tbWFuZChjbWROYW1lLCB7XHJcblx0XHRhcmdzOiBsQXJncyxcclxuXHRcdGVudjoge0RFRkFVTFRfTE9HR0VSOiBnZXRMb2dMZXZlbCgpfVxyXG5cdFx0c3Rkb3V0OiAncGlwZWQnXHJcblx0XHRzdGRlcnI6ICdwaXBlZCdcclxuXHRcdH0pXHJcblx0e3N1Y2Nlc3MsIGNvZGUsIHNpZ25hbCwgc3Rkb3V0LCBzdGRlcnJ9IDo9IGNoaWxkLm91dHB1dFN5bmMoKVxyXG5cdERCRyBVTkRFTlRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c3VjY2Vzc1xyXG5cdFx0Y29kZVxyXG5cdFx0c2lnbmFsOiBzaWduYWwgfHwgdW5kZWZcclxuXHRcdHN0ZG91dDogbWtzdHIoc3Rkb3V0KVxyXG5cdFx0c3RkZXJyOiBta3N0cihzdGRlcnIpXHJcblx0XHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGNtZFN1Y2NlZWRzIDo9IChcclxuXHRjbWROYW1lOiBzdHJpbmcsXHJcblx0bEFyZ3M6IHN0cmluZ1tdID0gW10sXHJcblx0aE9wdGlvbnM6IGhhc2ggPSB7fVxyXG5cdCk6IGJvb2xlYW4gPT5cclxuXHJcblx0dHlwZSBvcHQgPSB7XHJcblx0XHRxdWlldDogYm9vbGVhblxyXG5cdFx0fVxyXG5cdHtxdWlldH0gOj0gZ2V0T3B0aW9uczxvcHQ+IGhPcHRpb25zLCB7XHJcblx0XHRxdWlldDogdHJ1ZVxyXG5cdFx0fVxyXG5cdHRyeVxyXG5cdFx0aWYgbm90IHF1aWV0XHJcblx0XHRcdHB1c2hMb2dMZXZlbCAnc2lsZW50J1xyXG5cdFx0Z2V0Q21kT3V0cHV0U3luYyBjbWROYW1lLCBsQXJnc1xyXG5cdFx0aWYgbm90IHF1aWV0XHJcblx0XHRcdHBvcExvZ0xldmVsKClcclxuXHRcdHJldHVybiB0cnVlXHJcblx0Y2F0Y2ggZXJyXHJcblx0XHRyZXR1cm4gZmFsc2VcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiJdfQ==