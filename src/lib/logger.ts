"use strict";
// logger.civet

import {existsSync} from "@std/fs"
import {sprintf} from "@std/fmt/printf"
import {
	ConsoleHandler, FileHandler, setup, getLogger,
	LogRecord,
	} from "@std/log"

import {
	assert, croak, pass,
	} from './llutils.ts'
import {
	undef, defined, hash, isString,
	} from './datatypes.ts'
import {
	mkpath, relpath, isDir, isFile, mkDir,
	} from './fs.ts'

const Deno = globalThis.Deno
export const logFileName : string = "./logs/logs.txt"
export const sepdash : string = '-'.repeat(32)
export const sepeq : string   = '='.repeat(32)

// --- These are not exported
const isSep = (str : string): boolean => {
	return (str === sepdash) || (str === sepeq)
}

const getMainModule = (): string => {
	const path: string = new URL(Deno.mainModule).pathname
	return relpath(path.slice(1))
}

// --- There always needs to be a 'logs' folder in the current directory
// mkDir './logs'

let indent : number = 0
const prefix = () => '   '.repeat(indent)

// --- Used when current logger is 'profile'
let prevMS: number = 0
let prevFileMS: number = 0
let headerOutput: boolean = false
let fileHeaderOutput: boolean = false

const hFileLabel: hash = {
	DEBUG: 'D ',
	INFO:  'I ',
	WARN:  'W ',
	ERROR: 'ERROR: '
	}

const hConsoleLabel: hash = {
	DEBUG: '',
	INFO:  '',
	WARN:  '',
	ERROR: ''
	}

// ---------------------------------------------------------------------------

export const hLoggerConfig: hash = {
	handlers: {

		profile: new ConsoleHandler('DEBUG', {
			formatter: ((rec: LogRecord) => {
				const {datetime, msg, levelName} = rec
				const ms = datetime.getMilliseconds()
				const msStr = sprintf("%5d", ms - prevMS)
				prevMS = ms
				const label = hConsoleLabel[levelName]
				if (!headerOutput) {
					headerOutput = true
					return `ms\n-----\n${msStr} ${label}${prefix()}${msg}`
				}
				else {
					return `${msStr} ${label}${prefix()}${msg}`
				}
			}
				)
			}),

		pfile: new FileHandler('DEBUG', {
			filename: mkpath(logFileName),
			mode: 'a',
			formatter: (rec) => {
				const {datetime, msg, levelName} = rec
				const ms = datetime.getMilliseconds()
				const msStr = sprintf("%5d", ms - prevFileMS)
				prevFileMS = ms
				const label = hFileLabel[levelName]
				if (!fileHeaderOutput) {
					fileHeaderOutput = true
					return `ms\n-----\n${msStr} ${label}${prefix()}${msg}`
				}
				else {
					return `${msStr} ${label}${prefix()}${msg}`
				}
			}
			}),

		console: new ConsoleHandler('DEBUG', {
			formatter: ((rec) => {
				const {levelName, msg} = rec
				assert(isString(msg), `Not a string: ${msg}`)
				if (msg.startsWith('=====  ')) {
					return ''
				}
				const label = hConsoleLabel[levelName]
				assert(defined(label), `No label for ${levelName}`)
				return `${label}${prefix()}${msg}`
			}
				)
			}),

		file: new FileHandler('DEBUG', {
			filename: logFileName,
			mode: 'a',
			formatter: (rec) => {
				const {levelName, msg} = rec
				if (isSep(msg)) {
					return msg
				}
				else if (msg.startsWith('=====  ')) {
					return msg
				}
				else {
					const label = hFileLabel[levelName]
					assert(defined(label), `No label for ${levelName}`)
					return `${label}${prefix()}${msg}`
				}
			}
				}),
	},

	// --- assign handlers to loggers
	//     must include:
	//        'profile', 'debug', 'info', 'warn', 'error', 'file' and 'silent'
	loggers: {
		profile: {
			level: "DEBUG",
			num: 1,
			handlers: ["profile", "pfile"]
			},
		debug: {
			level: "DEBUG",
			num: 2,
			handlers: ["console", "file"]
			},
		info: {
			level: "INFO",
			num: 3,
			handlers: ["console", "file"]
			},
		warn: {
			level: "WARN",
			num: 4,
			handlers: ["console", "file"]
			},
		error: {
			level: "ERROR",
			num: 5,
			handlers: ["console", "file"]
			},
		file: {
			level: "DEBUG",
			num: 6,
			handlers: ["file"]
			},
		silent: {
			level: "ERROR",
			num: 7,
			handlers: []
			}
		}
	}

await setup(hLoggerConfig)

export const INDENT : string = 'MOKaHenzkyZNbNWmUYijCNoqmIrIemFh'
export const UNDENT : string = 'MXrveSEaCkCfQjEgPdMIaEDFMIWMtHqz'
export const CLEAR  : string = '2EYCEu1v7xs0i4L3o5rAV1ZNLFkQYNHh'

// ---------------------------------------------------------------------------
// levels: profile, debug, info, warn, error, file, silent

class LoggerEx {

	defLevel: string       = Deno.env.get('DEFAULT_LOGGER') || 'info'
	lLoggerStack: string[] = [this.defLevel]
	hConfig: hash          = hLoggerConfig
	hLoggers: hash         = this.hConfig.loggers
	silent: boolean        = false
	mainModule: string     = getMainModule()

	constructor() {
		this.check(this.defLevel)
	}

	curLevel(): string {
		const result = this.lLoggerStack.at(-1)
		if (result === undef) {
			throw new Error("empty stack")
		}
		else {
			return result
		}
	}

	levelChanged(): void {
		switch(this.curLevel()) {
			case 'profile': {
				// --- NOTE: These are package global variables
				prevMS = prevFileMS = Date.now()
				headerOutput = false
				fileHeaderOutput = false;break;
			}
		}
		return
	}

	setLevel(level: string): void {
		this.check(level)
		this.lLoggerStack[this.lLoggerStack.length-1] = level
		this.levelChanged()
		return
	}

	pushLevel(level: string): void {
		this.check(level)
		this.lLoggerStack.push(level)
		this.levelChanged()
		return
	}

	popLevel(): string {
		assert((this.lLoggerStack.length > 0), "Empty logger stack")
		const level = this.lLoggerStack.pop()
		if (level === undef) {
			throw new Error("empty stack")
		}
		this.levelChanged()
		return level
	}

	isActive(level: string): boolean {
		this.check(level)
		const curNum = this.hLoggers[this.curLevel()].num
		const lvlNum = this.hLoggers[level].num
		return (lvlNum >= curNum)
	}

	output(level: string, lItems: any[]): void {
		const main = getMainModule()
		if (main !== this.mainModule) {
			const logger = getLogger('debug')
			logger.debug(`=====  ${main}  =====`)
			this.mainModule = main
		}
		if (this.isActive(level)) {
			for (const item of lItems) {
				switch(item) {
					case INDENT: {
						indent += 1;break;
					}
					case UNDENT: {
						indent = (indent===0) ? 0 : indent-1;break;
					}
					case CLEAR: {
						this.clearLog();break;
					}
					default: {
						const str = isString(item) ? item : JSON.stringify(item)
						const logger = getLogger(this.curLevel())
						switch(level) {
//							when 'profile'
//								logger.profile str
							case 'debug': {
								logger.debug(str);break;
							}
							case 'info': {
								logger.info(str);break;
							}
							case 'warn': {
								logger.warn(str);break;
							}
							case 'error': {
								logger.error(str);break;
							}
//							when 'file'
//								logger.file str
							case 'silent': {
								pass();break;
							}
							default: {
								logger.debug(str)
							}
						}
					}
				}
			}
		}
		return
	}

	flush(): void {
		this.hConfig.handlers.file.flush()
		this.hConfig.handlers.pfile.flush()
		return
	}

	clearLog(): void {
		this.flush()
		Deno.writeTextFileSync(logFileName, '')
		prevMS = prevFileMS = Date.now()
		return
	}

	getFullLog(): string {
		this.flush()
		const text = Deno.readTextFileSync(logFileName)
		return text ? text.trim() : ''
	}

	getLog(): string {
		this.flush()
		const text = Deno.readTextFileSync(logFileName)
		const lLines = text ? text.trim().split('\n') : []
		const lNewLines = lLines.filter((x) => !x.match(/^=====\s\s/))
		const resultStr = lNewLines.join('\n')
		return resultStr
	}

	check(level: string): void {
		assert(this.hLoggers[level], `Bad logger level: '${level}'`)
		return
	}
}

export const logger: LoggerEx = new LoggerEx()

// ---------------------------------------------------------------------------

export const DBG  = (...lItems: any[]): void => logger.output('debug', lItems)
export const LOG  = (...lItems: any[]): void => logger.output('info', lItems)
export const WARN = (...lItems: any[]): void => logger.output('warn', lItems)
export const ERR  = (...lItems: any[]): void => logger.output('error', lItems)

export const curLogLevel  = (): string => { return logger.curLevel() }
export const setLogLevel  = (level: string): void => logger.setLevel(level)
export const pushLogLevel = (level: string): void => logger.pushLevel(level)
export const popLogLevel  = (): string => { return logger.popLevel() }
export const clearLog     = (): void => { return logger.clearLog() }
export const getFullLog   = (): string => { return logger.getFullLog() }
export const getLog       = (): string => { return logger.getLog() }
export const flushLog     = (): void => logger.flush()

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9sb2dnZXIuY2l2ZXQudHN4Iiwic291cmNlcyI6WyJzcmMvbGliL2xvZ2dlci5jaXZldCJdLCJtYXBwaW5ncyI6IjtBQUFBLGVBQWM7QUFDZCxBQUFBO0FBQ0EsQUFBQSxNQUFNLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUztBQUNsQyxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUN2QyxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUMvQyxDQUFDLFNBQVMsQ0FBQztBQUNYLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVO0FBQ2xCLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNyQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYztBQUN0QixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCO0FBQ3hCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDO0FBQ3ZDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTO0FBQ2pCLEFBQUE7QUFDQSxBQUFBLEFBQUksTUFBSixJQUFJLENBQUMsQ0FBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJO0FBQ3ZCLEFBQUEsQUFBQSxNQUFNLENBQXFCLE1BQXBCLFdBQVcsQ0FB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QUFBQSxBQUFBLE1BQU0sQ0FBYSxNQUFaLFdBQVcsRUFBRSxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFBLENBQUEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUEsQ0FBQTtBQUM3RCxBQUFBLEFBQUEsTUFBTSxDQUFhLE1BQVosV0FBVyxFQUFFLENBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQztBQUN0RSxBQUFBLEFBQUEsTUFBTSxDQUFhLE1BQVosWUFBWSxDQUFDLENBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztBQUN2RSxBQUFBLEFBQUEsTUFBTSxDQUFhLE1BQVosV0FBVyxFQUFFLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsQ0FBQSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQSxDQUFBO0FBQzdELEFBQUEsQUFBQSxNQUFNLENBQWEsTUFBWixRQUFRLEtBQUssQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFBLENBQUE7QUFDM0QsQUFBQSxBQUFBLE1BQU0sQ0FBYSxNQUFaLFVBQVUsR0FBRyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFBLENBQUEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUEsQ0FBQTtBQUMvRCxBQUFBLEFBQUEsTUFBTSxDQUFhLE1BQVosTUFBTSxPQUFPLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsQ0FBQSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQSxDQUFBO0FBQzNELEFBQUEsQUFBQSxNQUFNLENBQWEsTUFBWixRQUFRLEtBQUssQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDakQiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgbG9nZ2VyLmNpdmV0XG5cbmltcG9ydCB7ZXhpc3RzU3luY30gZnJvbSBcIkBzdGQvZnNcIlxuaW1wb3J0IHtzcHJpbnRmfSBmcm9tIFwiQHN0ZC9mbXQvcHJpbnRmXCJcbmltcG9ydCB7XG5cdENvbnNvbGVIYW5kbGVyLCBGaWxlSGFuZGxlciwgc2V0dXAsIGdldExvZ2dlcixcblx0TG9nUmVjb3JkLFxuXHR9IGZyb20gXCJAc3RkL2xvZ1wiXG5cbmltcG9ydCB7XG5cdGFzc2VydCwgY3JvYWssIHBhc3MsXG5cdH0gZnJvbSAnLi9sbHV0aWxzLnRzJ1xuaW1wb3J0IHtcblx0dW5kZWYsIGRlZmluZWQsIGhhc2gsIGlzU3RyaW5nLFxuXHR9IGZyb20gJy4vZGF0YXR5cGVzLnRzJ1xuaW1wb3J0IHtcblx0bWtwYXRoLCByZWxwYXRoLCBpc0RpciwgaXNGaWxlLCBta0Rpcixcblx0fSBmcm9tICcuL2ZzLnRzJ1xuXG5EZW5vIDo9IGdsb2JhbFRoaXMuRGVub1xuZXhwb3J0IGxvZ0ZpbGVOYW1lIDogc3RyaW5nIDo9IFwiLi9sb2dzL2xvZ3MudHh0XCJcbmV4cG9ydCBzZXBkYXNoIDogc3RyaW5nIDo9ICctJy5yZXBlYXQoMzIpXG5leHBvcnQgc2VwZXEgOiBzdHJpbmcgICA6PSAnPScucmVwZWF0KDMyKVxuXG4jIC0tLSBUaGVzZSBhcmUgbm90IGV4cG9ydGVkXG5pc1NlcCA6PSAoc3RyIDogc3RyaW5nKTogYm9vbGVhbiA9PlxuXHRyZXR1cm4gKHN0ciA9PSBzZXBkYXNoKSB8fCAoc3RyID09IHNlcGVxKVxuXG5nZXRNYWluTW9kdWxlIDo9ICgpOiBzdHJpbmcgPT5cblx0cGF0aDogc3RyaW5nIDo9IG5ldyBVUkwoRGVuby5tYWluTW9kdWxlKS5wYXRobmFtZVxuXHRyZXR1cm4gcmVscGF0aChwYXRoLnNsaWNlKDEpKVxuXG4jIC0tLSBUaGVyZSBhbHdheXMgbmVlZHMgdG8gYmUgYSAnbG9ncycgZm9sZGVyIGluIHRoZSBjdXJyZW50IGRpcmVjdG9yeVxuIyBta0RpciAnLi9sb2dzJ1xuXG5sZXQgaW5kZW50IDogbnVtYmVyID0gMFxucHJlZml4IDo9ICgpID0+ICcgICAnLnJlcGVhdChpbmRlbnQpXG5cbiMgLS0tIFVzZWQgd2hlbiBjdXJyZW50IGxvZ2dlciBpcyAncHJvZmlsZSdcbmxldCBwcmV2TVM6IG51bWJlciA9IDBcbmxldCBwcmV2RmlsZU1TOiBudW1iZXIgPSAwXG5sZXQgaGVhZGVyT3V0cHV0OiBib29sZWFuID0gZmFsc2VcbmxldCBmaWxlSGVhZGVyT3V0cHV0OiBib29sZWFuID0gZmFsc2VcblxuaEZpbGVMYWJlbDogaGFzaCA6PSB7XG5cdERFQlVHOiAnRCAnXG5cdElORk86ICAnSSAnXG5cdFdBUk46ICAnVyAnXG5cdEVSUk9SOiAnRVJST1I6ICdcblx0fVxuXG5oQ29uc29sZUxhYmVsOiBoYXNoIDo9IHtcblx0REVCVUc6ICcnXG5cdElORk86ICAnJ1xuXHRXQVJOOiAgJydcblx0RVJST1I6ICcnXG5cdH1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGhMb2dnZXJDb25maWc6IGhhc2ggOj0ge1xuXHRoYW5kbGVyczpcblxuXHRcdHByb2ZpbGU6IG5ldyBDb25zb2xlSGFuZGxlcignREVCVUcnLCB7XG5cdFx0XHRmb3JtYXR0ZXI6ICgocmVjOiBMb2dSZWNvcmQpID0+XG5cdFx0XHRcdHtkYXRldGltZSwgbXNnLCBsZXZlbE5hbWV9IDo9IHJlY1xuXHRcdFx0XHRtcyA6PSBkYXRldGltZS5nZXRNaWxsaXNlY29uZHMoKVxuXHRcdFx0XHRtc1N0ciA6PSBzcHJpbnRmKFwiJTVkXCIsIG1zIC0gcHJldk1TKVxuXHRcdFx0XHRwcmV2TVMgPSBtc1xuXHRcdFx0XHRsYWJlbCA6PSBoQ29uc29sZUxhYmVsW2xldmVsTmFtZV1cblx0XHRcdFx0aWYgbm90IGhlYWRlck91dHB1dFxuXHRcdFx0XHRcdGhlYWRlck91dHB1dCA9IHRydWVcblx0XHRcdFx0XHRyZXR1cm4gXCJtc1xcbi0tLS0tXFxuI3ttc1N0cn0gI3tsYWJlbH0je3ByZWZpeCgpfSN7bXNnfVwiXG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRyZXR1cm4gXCIje21zU3RyfSAje2xhYmVsfSN7cHJlZml4KCl9I3ttc2d9XCJcblx0XHRcdFx0KVxuXHRcdFx0fSlcblxuXHRcdHBmaWxlOiBuZXcgRmlsZUhhbmRsZXIoJ0RFQlVHJywge1xuXHRcdFx0ZmlsZW5hbWU6IG1rcGF0aChsb2dGaWxlTmFtZSlcblx0XHRcdG1vZGU6ICdhJ1xuXHRcdFx0Zm9ybWF0dGVyOiAocmVjKSA9PlxuXHRcdFx0XHR7ZGF0ZXRpbWUsIG1zZywgbGV2ZWxOYW1lfSA6PSByZWNcblx0XHRcdFx0bXMgOj0gZGF0ZXRpbWUuZ2V0TWlsbGlzZWNvbmRzKClcblx0XHRcdFx0bXNTdHIgOj0gc3ByaW50ZihcIiU1ZFwiLCBtcyAtIHByZXZGaWxlTVMpXG5cdFx0XHRcdHByZXZGaWxlTVMgPSBtc1xuXHRcdFx0XHRsYWJlbCA6PSBoRmlsZUxhYmVsW2xldmVsTmFtZV1cblx0XHRcdFx0aWYgbm90IGZpbGVIZWFkZXJPdXRwdXRcblx0XHRcdFx0XHRmaWxlSGVhZGVyT3V0cHV0ID0gdHJ1ZVxuXHRcdFx0XHRcdHJldHVybiBcIm1zXFxuLS0tLS1cXG4je21zU3RyfSAje2xhYmVsfSN7cHJlZml4KCl9I3ttc2d9XCJcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHJldHVybiBcIiN7bXNTdHJ9ICN7bGFiZWx9I3twcmVmaXgoKX0je21zZ31cIlxuXHRcdFx0fSlcblxuXHRcdGNvbnNvbGU6IG5ldyBDb25zb2xlSGFuZGxlcignREVCVUcnLCB7XG5cdFx0XHRmb3JtYXR0ZXI6ICgocmVjKSA9PlxuXHRcdFx0XHR7bGV2ZWxOYW1lLCBtc2d9IDo9IHJlY1xuXHRcdFx0XHRhc3NlcnQgaXNTdHJpbmcobXNnKSwgXCJOb3QgYSBzdHJpbmc6ICN7bXNnfVwiXG5cdFx0XHRcdGlmIG1zZy5zdGFydHNXaXRoKCc9PT09PSAgJylcblx0XHRcdFx0XHRyZXR1cm4gJydcblx0XHRcdFx0bGFiZWwgOj0gaENvbnNvbGVMYWJlbFtsZXZlbE5hbWVdXG5cdFx0XHRcdGFzc2VydCBkZWZpbmVkKGxhYmVsKSwgXCJObyBsYWJlbCBmb3IgI3tsZXZlbE5hbWV9XCJcblx0XHRcdFx0cmV0dXJuIFwiI3tsYWJlbH0je3ByZWZpeCgpfSN7bXNnfVwiXG5cdFx0XHRcdClcblx0XHRcdH0pXG5cblx0XHRmaWxlOiBuZXcgRmlsZUhhbmRsZXIoJ0RFQlVHJywge1xuXHRcdFx0ZmlsZW5hbWU6IGxvZ0ZpbGVOYW1lXG5cdFx0XHRtb2RlOiAnYSdcblx0XHRcdGZvcm1hdHRlcjogKHJlYykgPT5cblx0XHRcdFx0e2xldmVsTmFtZSwgbXNnfSA6PSByZWNcblx0XHRcdFx0aWYgaXNTZXAobXNnKVxuXHRcdFx0XHRcdHJldHVybiBtc2dcblx0XHRcdFx0ZWxzZSBpZiBtc2cuc3RhcnRzV2l0aCgnPT09PT0gICcpXG5cdFx0XHRcdFx0cmV0dXJuIG1zZ1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0bGFiZWwgOj0gaEZpbGVMYWJlbFtsZXZlbE5hbWVdXG5cdFx0XHRcdFx0YXNzZXJ0IGRlZmluZWQobGFiZWwpLCBcIk5vIGxhYmVsIGZvciAje2xldmVsTmFtZX1cIlxuXHRcdFx0XHRcdHJldHVybiBcIiN7bGFiZWx9I3twcmVmaXgoKX0je21zZ31cIlxuXHRcdFx0XHR9KVxuXG5cdCMgLS0tIGFzc2lnbiBoYW5kbGVycyB0byBsb2dnZXJzXG5cdCMgICAgIG11c3QgaW5jbHVkZTpcblx0IyAgICAgICAgJ3Byb2ZpbGUnLCAnZGVidWcnLCAnaW5mbycsICd3YXJuJywgJ2Vycm9yJywgJ2ZpbGUnIGFuZCAnc2lsZW50J1xuXHRsb2dnZXJzOiB7XG5cdFx0cHJvZmlsZToge1xuXHRcdFx0bGV2ZWw6IFwiREVCVUdcIlxuXHRcdFx0bnVtOiAxXG5cdFx0XHRoYW5kbGVyczogW1wicHJvZmlsZVwiLCBcInBmaWxlXCJdXG5cdFx0XHR9XG5cdFx0ZGVidWc6IHtcblx0XHRcdGxldmVsOiBcIkRFQlVHXCJcblx0XHRcdG51bTogMlxuXHRcdFx0aGFuZGxlcnM6IFtcImNvbnNvbGVcIiwgXCJmaWxlXCJdXG5cdFx0XHR9XG5cdFx0aW5mbzoge1xuXHRcdFx0bGV2ZWw6IFwiSU5GT1wiXG5cdFx0XHRudW06IDNcblx0XHRcdGhhbmRsZXJzOiBbXCJjb25zb2xlXCIsIFwiZmlsZVwiXVxuXHRcdFx0fVxuXHRcdHdhcm46IHtcblx0XHRcdGxldmVsOiBcIldBUk5cIixcblx0XHRcdG51bTogNFxuXHRcdFx0aGFuZGxlcnM6IFtcImNvbnNvbGVcIiwgXCJmaWxlXCJdXG5cdFx0XHR9XG5cdFx0ZXJyb3I6IHtcblx0XHRcdGxldmVsOiBcIkVSUk9SXCJcblx0XHRcdG51bTogNVxuXHRcdFx0aGFuZGxlcnM6IFtcImNvbnNvbGVcIiwgXCJmaWxlXCJdXG5cdFx0XHR9XG5cdFx0ZmlsZToge1xuXHRcdFx0bGV2ZWw6IFwiREVCVUdcIixcblx0XHRcdG51bTogNlxuXHRcdFx0aGFuZGxlcnM6IFtcImZpbGVcIl1cblx0XHRcdH1cblx0XHRzaWxlbnQ6IHtcblx0XHRcdGxldmVsOiBcIkVSUk9SXCJcblx0XHRcdG51bTogN1xuXHRcdFx0aGFuZGxlcnM6IFtdXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cbmF3YWl0IHNldHVwKGhMb2dnZXJDb25maWcpXG5cbmV4cG9ydCBJTkRFTlQgOiBzdHJpbmcgOj0gJ01PS2FIZW56a3laTmJOV21VWWlqQ05vcW1JckllbUZoJ1xuZXhwb3J0IFVOREVOVCA6IHN0cmluZyA6PSAnTVhydmVTRWFDa0NmUWpFZ1BkTUlhRURGTUlXTXRIcXonXG5leHBvcnQgQ0xFQVIgIDogc3RyaW5nIDo9ICcyRVlDRXUxdjd4czBpNEwzbzVyQVYxWk5MRmtRWU5IaCdcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgbGV2ZWxzOiBwcm9maWxlLCBkZWJ1ZywgaW5mbywgd2FybiwgZXJyb3IsIGZpbGUsIHNpbGVudFxuXG5jbGFzcyBMb2dnZXJFeFxuXG5cdGRlZkxldmVsOiBzdHJpbmcgICAgICAgPSBEZW5vLmVudi5nZXQoJ0RFRkFVTFRfTE9HR0VSJykgfHwgJ2luZm8nXG5cdGxMb2dnZXJTdGFjazogc3RyaW5nW10gPSBbQGRlZkxldmVsXVxuXHRoQ29uZmlnOiBoYXNoICAgICAgICAgID0gaExvZ2dlckNvbmZpZ1xuXHRoTG9nZ2VyczogaGFzaCAgICAgICAgID0gQGhDb25maWcubG9nZ2Vyc1xuXHRzaWxlbnQ6IGJvb2xlYW4gICAgICAgID0gZmFsc2Vcblx0bWFpbk1vZHVsZTogc3RyaW5nICAgICA9IGdldE1haW5Nb2R1bGUoKVxuXG5cdGNvbnN0cnVjdG9yKClcblx0XHRAY2hlY2sgQGRlZkxldmVsXG5cblx0Y3VyTGV2ZWwoKTogc3RyaW5nXG5cdFx0cmVzdWx0IDo9IEBsTG9nZ2VyU3RhY2suYXQoLTEpXG5cdFx0aWYgKHJlc3VsdCA9PSB1bmRlZilcblx0XHRcdHRocm93IG5ldyBFcnJvcihcImVtcHR5IHN0YWNrXCIpXG5cdFx0ZWxzZVxuXHRcdFx0cmV0dXJuIHJlc3VsdFxuXG5cdGxldmVsQ2hhbmdlZCgpOiB2b2lkXG5cdFx0c3dpdGNoIEBjdXJMZXZlbCgpXG5cdFx0XHR3aGVuICdwcm9maWxlJ1xuXHRcdFx0XHQjIC0tLSBOT1RFOiBUaGVzZSBhcmUgcGFja2FnZSBnbG9iYWwgdmFyaWFibGVzXG5cdFx0XHRcdHByZXZNUyA9IHByZXZGaWxlTVMgPSBEYXRlLm5vdygpXG5cdFx0XHRcdGhlYWRlck91dHB1dCA9IGZhbHNlXG5cdFx0XHRcdGZpbGVIZWFkZXJPdXRwdXQgPSBmYWxzZVxuXHRcdHJldHVyblxuXG5cdHNldExldmVsKGxldmVsOiBzdHJpbmcpOiB2b2lkXG5cdFx0QGNoZWNrIGxldmVsXG5cdFx0QGxMb2dnZXJTdGFja1tAbExvZ2dlclN0YWNrLmxlbmd0aC0xXSA9IGxldmVsXG5cdFx0QGxldmVsQ2hhbmdlZCgpXG5cdFx0cmV0dXJuXG5cblx0cHVzaExldmVsKGxldmVsOiBzdHJpbmcpOiB2b2lkXG5cdFx0QGNoZWNrIGxldmVsXG5cdFx0QGxMb2dnZXJTdGFjay5wdXNoIGxldmVsXG5cdFx0QGxldmVsQ2hhbmdlZCgpXG5cdFx0cmV0dXJuXG5cblx0cG9wTGV2ZWwoKTogc3RyaW5nXG5cdFx0YXNzZXJ0IChAbExvZ2dlclN0YWNrLmxlbmd0aCA+IDApLCBcIkVtcHR5IGxvZ2dlciBzdGFja1wiXG5cdFx0bGV2ZWwgOj0gQGxMb2dnZXJTdGFjay5wb3AoKVxuXHRcdGlmIChsZXZlbCA9PSB1bmRlZilcblx0XHRcdHRocm93IG5ldyBFcnJvcihcImVtcHR5IHN0YWNrXCIpXG5cdFx0QGxldmVsQ2hhbmdlZCgpXG5cdFx0cmV0dXJuIGxldmVsXG5cblx0aXNBY3RpdmUobGV2ZWw6IHN0cmluZyk6IGJvb2xlYW5cblx0XHRAY2hlY2sgbGV2ZWxcblx0XHRjdXJOdW0gOj0gQGhMb2dnZXJzW0BjdXJMZXZlbCgpXS5udW1cblx0XHRsdmxOdW0gOj0gQGhMb2dnZXJzW2xldmVsXS5udW1cblx0XHRyZXR1cm4gKGx2bE51bSA+PSBjdXJOdW0pXG5cblx0b3V0cHV0KGxldmVsOiBzdHJpbmcsIGxJdGVtczogYW55W10pOiB2b2lkXG5cdFx0bWFpbiA6PSBnZXRNYWluTW9kdWxlKClcblx0XHRpZiAobWFpbiAhPSBAbWFpbk1vZHVsZSlcblx0XHRcdGxvZ2dlciA6PSBnZXRMb2dnZXIoJ2RlYnVnJylcblx0XHRcdGxvZ2dlci5kZWJ1ZyBcIj09PT09ICAje21haW59ICA9PT09PVwiXG5cdFx0XHRAbWFpbk1vZHVsZSA9IG1haW5cblx0XHRpZiBAaXNBY3RpdmUobGV2ZWwpXG5cdFx0XHRmb3IgaXRlbSBvZiBsSXRlbXNcblx0XHRcdFx0c3dpdGNoIGl0ZW1cblx0XHRcdFx0XHR3aGVuIElOREVOVFxuXHRcdFx0XHRcdFx0aW5kZW50ICs9IDFcblx0XHRcdFx0XHR3aGVuIFVOREVOVFxuXHRcdFx0XHRcdFx0aW5kZW50ID0gKGluZGVudD09MCkgPyAwIDogaW5kZW50LTFcblx0XHRcdFx0XHR3aGVuIENMRUFSXG5cdFx0XHRcdFx0XHRAY2xlYXJMb2coKVxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdHN0ciA6PSBpc1N0cmluZyhpdGVtKSA/IGl0ZW0gOiBKU09OLnN0cmluZ2lmeShpdGVtKVxuXHRcdFx0XHRcdFx0bG9nZ2VyIDo9IGdldExvZ2dlcihAY3VyTGV2ZWwoKSlcblx0XHRcdFx0XHRcdHN3aXRjaCBsZXZlbFxuI1x0XHRcdFx0XHRcdFx0d2hlbiAncHJvZmlsZSdcbiNcdFx0XHRcdFx0XHRcdFx0bG9nZ2VyLnByb2ZpbGUgc3RyXG5cdFx0XHRcdFx0XHRcdHdoZW4gJ2RlYnVnJ1xuXHRcdFx0XHRcdFx0XHRcdGxvZ2dlci5kZWJ1ZyBzdHJcblx0XHRcdFx0XHRcdFx0d2hlbiAnaW5mbydcblx0XHRcdFx0XHRcdFx0XHRsb2dnZXIuaW5mbyBzdHJcblx0XHRcdFx0XHRcdFx0d2hlbiAnd2Fybidcblx0XHRcdFx0XHRcdFx0XHRsb2dnZXIud2FybiBzdHJcblx0XHRcdFx0XHRcdFx0d2hlbiAnZXJyb3InXG5cdFx0XHRcdFx0XHRcdFx0bG9nZ2VyLmVycm9yIHN0clxuI1x0XHRcdFx0XHRcdFx0d2hlbiAnZmlsZSdcbiNcdFx0XHRcdFx0XHRcdFx0bG9nZ2VyLmZpbGUgc3RyXG5cdFx0XHRcdFx0XHRcdHdoZW4gJ3NpbGVudCdcblx0XHRcdFx0XHRcdFx0XHRwYXNzKClcblx0XHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHRcdGxvZ2dlci5kZWJ1ZyBzdHJcblx0XHRyZXR1cm5cblxuXHRmbHVzaCgpOiB2b2lkXG5cdFx0QGhDb25maWcuaGFuZGxlcnMuZmlsZS5mbHVzaCgpXG5cdFx0QGhDb25maWcuaGFuZGxlcnMucGZpbGUuZmx1c2goKVxuXHRcdHJldHVyblxuXG5cdGNsZWFyTG9nKCk6IHZvaWRcblx0XHRAZmx1c2goKVxuXHRcdERlbm8ud3JpdGVUZXh0RmlsZVN5bmMgbG9nRmlsZU5hbWUsICcnXG5cdFx0cHJldk1TID0gcHJldkZpbGVNUyA9IERhdGUubm93KClcblx0XHRyZXR1cm5cblxuXHRnZXRGdWxsTG9nKCk6IHN0cmluZ1xuXHRcdEBmbHVzaCgpXG5cdFx0dGV4dCA6PSBEZW5vLnJlYWRUZXh0RmlsZVN5bmMobG9nRmlsZU5hbWUpXG5cdFx0cmV0dXJuIHRleHQgPyB0ZXh0LnRyaW0oKSA6ICcnXG5cblx0Z2V0TG9nKCk6IHN0cmluZ1xuXHRcdEBmbHVzaCgpXG5cdFx0dGV4dCA6PSBEZW5vLnJlYWRUZXh0RmlsZVN5bmMobG9nRmlsZU5hbWUpXG5cdFx0bExpbmVzIDo9IHRleHQgPyB0ZXh0LnRyaW0oKS5zcGxpdCgnXFxuJykgOiBbXVxuXHRcdGxOZXdMaW5lcyA6PSBsTGluZXMuZmlsdGVyKCh4KSA9PiBub3QgeC5tYXRjaCgvXj09PT09XFxzXFxzLykpXG5cdFx0cmVzdWx0U3RyIDo9IGxOZXdMaW5lcy5qb2luKCdcXG4nKVxuXHRcdHJldHVybiByZXN1bHRTdHJcblxuXHRjaGVjayhsZXZlbDogc3RyaW5nKTogdm9pZFxuXHRcdGFzc2VydCBAaExvZ2dlcnNbbGV2ZWxdLCBcIkJhZCBsb2dnZXIgbGV2ZWw6ICcje2xldmVsfSdcIlxuXHRcdHJldHVyblxuXG5leHBvcnQgbG9nZ2VyOiBMb2dnZXJFeCA6PSBuZXcgTG9nZ2VyRXgoKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgREJHICA6PSAoLi4ubEl0ZW1zOiBhbnlbXSk6IHZvaWQgPT4gbG9nZ2VyLm91dHB1dCAnZGVidWcnLCBsSXRlbXNcbmV4cG9ydCBMT0cgIDo9ICguLi5sSXRlbXM6IGFueVtdKTogdm9pZCA9PiBsb2dnZXIub3V0cHV0ICdpbmZvJywgbEl0ZW1zXG5leHBvcnQgV0FSTiA6PSAoLi4ubEl0ZW1zOiBhbnlbXSk6IHZvaWQgPT4gbG9nZ2VyLm91dHB1dCAnd2FybicsIGxJdGVtc1xuZXhwb3J0IEVSUiAgOj0gKC4uLmxJdGVtczogYW55W10pOiB2b2lkID0+IGxvZ2dlci5vdXRwdXQgJ2Vycm9yJywgbEl0ZW1zXG5cbmV4cG9ydCBjdXJMb2dMZXZlbCAgOj0gKCk6IHN0cmluZyA9PiByZXR1cm4gbG9nZ2VyLmN1ckxldmVsKClcbmV4cG9ydCBzZXRMb2dMZXZlbCAgOj0gKGxldmVsOiBzdHJpbmcpOiB2b2lkID0+IGxvZ2dlci5zZXRMZXZlbChsZXZlbClcbmV4cG9ydCBwdXNoTG9nTGV2ZWwgOj0gKGxldmVsOiBzdHJpbmcpOiB2b2lkID0+IGxvZ2dlci5wdXNoTGV2ZWwobGV2ZWwpXG5leHBvcnQgcG9wTG9nTGV2ZWwgIDo9ICgpOiBzdHJpbmcgPT4gcmV0dXJuIGxvZ2dlci5wb3BMZXZlbCgpXG5leHBvcnQgY2xlYXJMb2cgICAgIDo9ICgpOiB2b2lkID0+IHJldHVybiBsb2dnZXIuY2xlYXJMb2coKVxuZXhwb3J0IGdldEZ1bGxMb2cgICA6PSAoKTogc3RyaW5nID0+IHJldHVybiBsb2dnZXIuZ2V0RnVsbExvZygpXG5leHBvcnQgZ2V0TG9nICAgICAgIDo9ICgpOiBzdHJpbmcgPT4gcmV0dXJuIGxvZ2dlci5nZXRMb2coKVxuZXhwb3J0IGZsdXNoTG9nICAgICA6PSAoKTogdm9pZCA9PiBsb2dnZXIuZmx1c2goKVxuIl19