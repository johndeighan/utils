"use strict";
// text-table.lib.civet

import {sprintf} from "@std/fmt/printf"

import {
	undef, defined, notdefined, assert, nonEmpty,
	isString, isNumber, isInteger, isArray,
	array, arrayof, hash, hashof, integer, char,
	intArray, isArrayOfIntegers,
	} from './datatypes.lib.ts'
import {
	getOptions, OL, croak, words, rtrim, alignString,
	toBlock, TAlignment,
	} from './llutils.lib.ts'
import {
	LOGVALUE, DBG,
	} from './logger.lib.ts'

// ---------------------------------------------------------------------------

type colDesc = {
	width: integer
	format: string
	align: TAlignment
	total: (number | undefined)     // running total
	subtotal: (number | undefined)  // running subtotal, undef on subtotal()
	}

type titleRec     = {opcode: 'title', title: string, align: TAlignment}
type labelsRec    = {opcode: 'labels', lRow: string[]}
type dataRec      = {opcode: 'data', lRow: string[]}
type sepRec       = {opcode: 'sep', ch: char}
type fullsepRec   = {opcode: 'fullsep', ch: char}
type totalsRec    = {opcode: 'totals', lRow: string[]}
type subtotalsRec = {opcode: 'subtotals', lRow: string[]}

type rowDesc = titleRec | labelsRec | dataRec | sepRec | fullsepRec | totalsRec | subtotalsRec

/**
 * class used to construct a text table as a string
 *
 * SYNOPSIS:
 * 	table := new TextTable('l r%.2f r%.2f')
 * 	table.title   'My Expenses'
 * 	table.fullsep '-'
 * 	table.labels  ['', 'Jan', 'Feb']
 * 	table.sep()
 * 	table.data    ['coffee', 30, 40]
 * 	table.data    ['dining', 130, 40]
 * 	table.sep     '-'
 * 	table.subtotals()
 * 	table.data    ['one time', 10, 20]
 * 	table.data    ['other', 1000, 40]
 * 	table.fullsep '='
 * 	table.totals()
 *
 * 	textTable := table.asString(o'hide=1')
 */

export class TextTable {

	hOptions: hash
	numCols: integer
	lLabels: string[] = []

	lCols: colDesc[] = []
	lRows: rowDesc[] = []

	constructor(
			formatStr: string,
			hOptions: hash={}
			) {

		// --- Valid options:
		//        decPlaces - used for numbers with no % style format
		//                    default: 2
		//        parseNumbers - string data that looks like a number
		//                       is treated as a number, default: false

		this.hOptions = getOptions(hOptions, {
			decPlaces: 2,
			parseNumbers: false
			})

		for (const word of words(formatStr)) {
			let ref;if ((ref = word.match(/^(l|c|r)(\%\S+)?$/))) {const lMatches = ref;
				const [_, align, fmt] = lMatches
				this.lCols.push({
					width: 0,     // adjusted as data is added
					format: fmt,
					align: (align || 'left') as TAlignment,
					total: undef,     // incremented as data is added
					subtotal: undef  // incremented as data is added,
					                 // undef when subtotal is output
					})
			}
			else {
				croak(`Bad format string: ${OL(word)}`)
			}
		}
		this.numCols = this.lCols.length
	}

	// ..........................................................

	title(title: string, align: TAlignment='center') {

		assert(nonEmpty(title), "Bad title: '@{title}'")
		this.lRows.push({
			opcode: 'title',
			title,
			align
			})
		return
	}

	// ..........................................................

	labels(lLabels: ((string | undefined))[]) {

		assert((lLabels.length === this.numCols), `lLabels = ${OL(lLabels)}`)
		const lRow: string[] = lLabels.map((item, colNum) => {
			return item || ''
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'labels',
			lRow
			})
		this.lLabels = lRow
		return
	}

	// ..........................................................

	accum(hCol: colDesc, amt: number) {

		if (defined(hCol.total)) {
			hCol.total += amt
		}
		else {
			hCol.total = amt
		}
		if (defined(hCol.subtotal)) {
			hCol.subtotal += amt
		}
		else {
			hCol.subtotal = amt
		}
		return
	}

	// ..........................................................

	data(lData: (number | string | undefined)[]) {

		assert((lData.length === this.numCols), `lData = ${OL(lData)}`)
		const lRow: string[] = lData.map((item, colNum) => {
			switch(typeof item) {
				case 'number': {
					const hCol = this.lCols[colNum]
					this.accum(hCol, item)
					return this.formatNum(item, hCol.format)
				}
				case 'string': {
					const hCol = this.lCols[colNum]
					if (this.hOptions.parseNumbers && item.match(/^\d+(\.\d*)?([Ee]\d+)?$/)) {
						const num = parseFloat(item)
						if (Number.isNaN(num)) {
							return item
						}
						else {
							this.accum(hCol, num)
							return this.formatNum(num, hCol.format)
						}
					}
					else {
						return item
					}
				}
				default: {
					return ''
				}
			}
		})

		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'data',
			lRow
			})
		return
	}

	// ..........................................................

	sep(ch: char = '-') {

		this.lRows.push({
			opcode: 'sep',
			ch
			})
		return
	}

	// ..........................................................

	fullsep(ch: char ='-') {

		this.lRows.push({
			opcode: 'fullsep',
			ch
			})
		return
	}

	// ..........................................................

	totals() {

		const lRow = this.lCols.map((hCol, colNum) => {
			const {total, format} = hCol
			if (defined(total)) {
				return this.formatNum(total, format)
			}
			else {
				return ''
			}
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'totals',
			lRow
			})
		return
	}

	// ..........................................................

	subtotals() {

		const lRow = this.lCols.map((hCol, colNum) => {
			const {subtotal, format} = hCol
			if (defined(hCol.subtotal)) {
				hCol.subtotal = 0
			}
			if (defined(subtotal)) {
				return this.formatNum(subtotal, format)
			}
			else {
				return ''
			}
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'subtotals',
			lRow
			})
		return
	}

	// ..........................................................

	adjustColWidths(lRow: string[]) {

		let i1 = 0;for (const str of lRow) {const colNum = i1++;
			const hCol = this.lCols[colNum]
			if (str.length > hCol.width) {
				hCol.width = str.length
			}
		}
		return
	}

	// ..........................................................

	formatNum(num: number, fmt: string): string {

		if (defined(fmt)) {
			return sprintf(fmt, num)
		}
		else {
			return num.toFixed(this.hOptions.decPlaces)
		}
	}

	// ..........................................................

	dumpInternals() {

		LOGVALUE('numCols:', this.numCols)
		LOGVALUE('lCols:', this.lCols)
		LOGVALUE('lRows:', this.lRows)
		return
	}

	// ..........................................................

	getTotalWidth(lHidden: integer[] = []) {

		const accFunc = (acc: integer, hCol: colDesc, i: integer) => {
			if (lHidden.includes(i)) {
				return acc
			}
			else {
				return acc + 1 + hCol.width
			}
		}
		return this.lCols.reduce(accFunc, 0) - 1
	}

	// ..........................................................

	getColsToHide(
		hide: (string | integer | integer[])
		): integer[] {

		if (isArrayOfIntegers(hide)) {
			return hide
		}
		switch(typeof hide) {
			case 'string': { {
				const results=[];for (const str of hide.split(',')) {
					if (str.match(/^\d+$/)) {
						results.push(parseInt(str))
					}
					else {
						results.push(this.lLabels.indexOf(str.trim()))
					}
				};const lInts =results  // might be -1
				return lInts}
			}
			case 'number': {
				return [hide]
			}
			default: {
				return []
			}
		}
	}

	// ..........................................................
	// --- option 'lHide' should be an array of integers

	asString(hOptions={}) {

		// --- option to hide certain columns
		const {hide} = getOptions(hOptions, {
			hide: undef
			})
		DBG('hide', hide)
		const lHidden = this.getColsToHide(hide)
		DBG('lHidden', lHidden)

		// --- create a filter function
		const ff = (
			(lHidden.length === 0)
			? (x:any) => { return true }
			: (x:any, i:integer) => { return !lHidden.includes(i) }
			)

		const totalWidth = this.getTotalWidth(lHidden)
		DBG('totalWidth', totalWidth)

		// --- Map each item in @lRows to a string
		const lLines = this.lRows.map((h) => {
			switch(h.opcode) {

				case 'title': {
					return alignString(h.title, totalWidth, h.align)
				}

				case 'labels': {
					// --- labels are always center aligned
					return h.lRow.map((str, colNum) => {
						const {width} = this.lCols[colNum]
						return alignString(str, width, 'center')
					}
						).filter(ff).join(' ')
				}

				case 'data':case 'totals':case 'subtotals': {
					return h.lRow.map((str, colNum) => {
						const {width, align} = this.lCols[colNum]
						return alignString(str, width, align)
					}
						).filter(ff).join(' ')
				}

				case 'sep': {
					return this.lCols.map((hCol) => {
						return h.ch.repeat(hCol.width)
					}
						).filter(ff).join(' ')
				}

				case 'fullsep': {
					return h.ch.repeat(totalWidth)
				}
			}
		})

		return toBlock(lLines.map((line) => rtrim(line)))
	}
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi90ZXh0LXRhYmxlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbInNyYy9saWIvdGV4dC10YWJsZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSx1QkFBc0I7QUFDdEIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUN2QyxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDOUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDeEMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDN0MsQ0FBQyxRQUFRLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztBQUM3QixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CO0FBQzVCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ2xELENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDO0FBQ3JCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0I7QUFDMUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUM7QUFDZixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCO0FBQ3pCLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFB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RyxDQUFDLEc7RUFBRyxDQUFBO0FBQ3BCLEFBQUEsRUFBRSxJQUFJLENBQUEsQ0FBQTtBQUNOLEFBQUEsR0FBRyxJQUFJLENBQUMsS0FBSyxDLENBQUUsQ0FBQyxHO0VBQUcsQ0FBQTtBQUNuQixBQUFBLEVBQUUsR0FBRyxDQUFBLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQzNCLEFBQUEsR0FBRyxJQUFJLENBQUMsUUFBUSxDLEVBQUcsQ0FBQyxHO0VBQUcsQ0FBQTtBQUN2QixBQUFBLEVBQUUsSUFBSSxDQUFBLENBQUE7QUFDTixBQUFBLEdBQUcsSUFBSSxDQUFDLFFBQVEsQyxDQUFFLENBQUMsRztFQUFHLENBQUE7QUFDdEIsQUFBQSxFQUFFLE07Q0FBTSxDQUFBO0FBQ1IsQUFBQTtBQUNBLEFBQUEsQ0FBQyw2REFBNEQ7QUFDN0QsQUFBQTtBQUNBLEFBQUEsQyxJQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQTtBQUM3QyxBQUFBO0FBQ0EsQUFBQSxFQUFFLE1BQU0sQ0FBQSxBQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFFLENBQUMsSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUMzRCxBQUFBLEVBQWdCLE1BQWQsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQSxBQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDL0MsQUFBQSxHQUFHLE1BQU0sQ0FBQSxBQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUEsQ0FBQSxDQUFBO0FBQ3JCLEFBQUEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFBLENBQUEsQ0FBQTtBQUNqQixBQUFBLEtBQVMsTUFBSixJQUFJLENBQUMsQ0FBRSxDQUFDLEksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDO0FBQzNCLEFBQUEsS0FBSyxJLENBQUMsS0FBSyxDQUFBLEFBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFBO0FBQ3RCLEFBQUEsS0FBSyxNQUFNLENBQUMsSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDO0lBQUMsQ0FBQTtBQUN6QyxBQUFBLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQSxDQUFBLENBQUE7QUFDakIsQUFBQSxLQUFTLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztBQUMzQixBQUFBLEtBQUssR0FBRyxDQUFBLEksQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUcsQ0FBQyxBQUMxQyxFQUFFLENBQUMsQUFBUyxBQUFvQixBQUNoQyxDQUFDLEVBQUUsRUFBRSxHQUFHLEFBQUksQUFBdUIsQUFDbkMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxBQUFFLEFBQW1CLEFBQy9CLENBQUMsQ0FBRyxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQ1osQUFBQSxNQUFTLE1BQUgsR0FBRyxDQUFDLENBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO0FBQzdCLEFBQUEsTUFBTSxHQUFHLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDMUIsQUFBQSxPQUFPLE1BQU0sQ0FBQyxJO01BQUksQ0FBQTtBQUNsQixBQUFBLE1BQU0sSUFBSSxDQUFBLENBQUE7QUFDVixBQUFBLE9BQU8sSSxDQUFDLEtBQUssQ0FBQSxBQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQTtBQUN2QixBQUFBLE9BQU8sTUFBTSxDQUFDLEksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQztNQUFDLEM7S0FBQSxDQUFBO0FBQzFDLEFBQUEsS0FBSyxJQUFJLENBQUEsQ0FBQTtBQUNULEFBQUEsTUFBTSxNQUFNLENBQUMsSTtLQUFJLEM7SUFBQSxDQUFBO0FBQ2pCLEFBQUEsSUFBSSxPQUFJLENBQUEsQ0FBQSxDQUFBO0FBQ1IsQUFBQSxLQUFLLE1BQU0sQ0FBQyxFO0lBQUUsQztHQUFBLEM7RUFBQSxDQUFBLENBQUE7QUFDZCxBQUFBO0FBQ0EsQUFBQSxFQUFFLEksQ0FBQyxlQUFlLENBQUEsQUFBQyxJQUFJLENBQUE7QUFDdkIsQUFBQSxFQUFFLEksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFBLEFBQUMsQ0FBQztBQUNmLEFBQUEsR0FBRyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUE7QUFDakIsQUFBQSxHQUFHLElBQUk7QUFDUCxHQUFHLENBQUMsQ0FBQTtBQUNKLEFBQUEsRUFBRSxNO0NBQU0sQ0FBQTtBQUNSLEFBQUE7QUFDQSxBQUFBLENBQUMsNkRBQTREO0FBQzdELEFBQUE7QUFDQSxBQUFBLEMsR0FBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUEsQ0FBQTtBQUNwQixBQUFBO0FBQ0EsQUFBQSxFQUFFLEksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFBLEFBQUMsQ0FBQztBQUNmLEFBQUEsR0FBRyxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUE7QUFDaEIsQUFBQSxHQUFHLEVBQUU7QUFDTCxHQUFHLENBQUMsQ0FBQTtBQUNKLEFBQUEsRUFBRSxNO0NBQU0sQ0FBQTtBQUNSLEFBQUE7QUFDQSxBQUFBLENBQUMsNkRBQTREO0FBQzdELEFBQUE7QUFDQSxBQUFBLEMsT0FBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBLENBQUE7QUFDdkIsQUFBQTtBQUNBLEFBQUEsRUFBRSxJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQSxBQUFDLENBQUM7QUFDZixBQUFBLEdBQUcsTUFBTSxDQUFDLENB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QUE7QUFDQSxBQUFBLElBQUksSUFBSSxDQUFDLE1BQU0sQyxLQUFDLFFBQVEsQyxLQUFDLFdBQVcsQ0FBQSxDQUFBLENBQUE7QUFDcEMsQUFBQSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZDLEFBQUEsTUFBb0IsTUFBZCxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUUsQ0FBQyxJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztBQUN0QyxBQUFBLE1BQU0sTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEM7S0FBQyxDQUFBO0FBQzNDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDO0lBQUMsQ0FBQTtBQUM1QixBQUFBO0FBQ0EsQUFBQSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQSxDQUFBO0FBQ2QsQUFBQSxLQUFLLE1BQU0sQ0FBQyxJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ2hDLEFBQUEsTUFBTSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQztLQUFDLENBQUE7QUFDcEMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEM7SUFBQyxDQUFBO0FBQzVCLEFBQUE7QUFDQSxBQUFBLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQSxDQUFBLENBQUE7QUFDbEIsQUFBQSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEM7SUFBQyxDO0dBQUEsQztFQUFBLENBQUEsQ0FBQTtBQUNuQyxBQUFBO0FBQ0EsQUFBQSxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQztDQUFDLEM7QUFBQSxDQUFBO0FBQ25EIiwibmFtZXMiOltdLCJzb3VyY2VzQ29udGVudCI6WyIjIHRleHQtdGFibGUubGliLmNpdmV0XHJcblxyXG5pbXBvcnQge3NwcmludGZ9IGZyb20gXCJAc3RkL2ZtdC9wcmludGZcIlxyXG5cclxuaW1wb3J0IHtcclxuXHR1bmRlZiwgZGVmaW5lZCwgbm90ZGVmaW5lZCwgYXNzZXJ0LCBub25FbXB0eSxcclxuXHRpc1N0cmluZywgaXNOdW1iZXIsIGlzSW50ZWdlciwgaXNBcnJheSxcclxuXHRhcnJheSwgYXJyYXlvZiwgaGFzaCwgaGFzaG9mLCBpbnRlZ2VyLCBjaGFyLFxyXG5cdGludEFycmF5LCBpc0FycmF5T2ZJbnRlZ2VycyxcclxuXHR9IGZyb20gJy4vZGF0YXR5cGVzLmxpYi50cydcclxuaW1wb3J0IHtcclxuXHRnZXRPcHRpb25zLCBPTCwgY3JvYWssIHdvcmRzLCBydHJpbSwgYWxpZ25TdHJpbmcsXHJcblx0dG9CbG9jaywgVEFsaWdubWVudCxcclxuXHR9IGZyb20gJy4vbGx1dGlscy5saWIudHMnXHJcbmltcG9ydCB7XHJcblx0TE9HVkFMVUUsIERCRyxcclxuXHR9IGZyb20gJy4vbG9nZ2VyLmxpYi50cydcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG50eXBlIGNvbERlc2MgPSB7XHJcblx0d2lkdGg6IGludGVnZXJcclxuXHRmb3JtYXQ6IHN0cmluZ1xyXG5cdGFsaWduOiBUQWxpZ25tZW50XHJcblx0dG90YWw6IG51bWJlcj8gICAgICMgcnVubmluZyB0b3RhbFxyXG5cdHN1YnRvdGFsOiBudW1iZXI/ICAjIHJ1bm5pbmcgc3VidG90YWwsIHVuZGVmIG9uIHN1YnRvdGFsKClcclxuXHR9XHJcblxyXG50eXBlIHRpdGxlUmVjICAgICA9IHtvcGNvZGU6ICd0aXRsZScsIHRpdGxlOiBzdHJpbmcsIGFsaWduOiBUQWxpZ25tZW50fVxyXG50eXBlIGxhYmVsc1JlYyAgICA9IHtvcGNvZGU6ICdsYWJlbHMnLCBsUm93OiBzdHJpbmdbXX1cclxudHlwZSBkYXRhUmVjICAgICAgPSB7b3Bjb2RlOiAnZGF0YScsIGxSb3c6IHN0cmluZ1tdfVxyXG50eXBlIHNlcFJlYyAgICAgICA9IHtvcGNvZGU6ICdzZXAnLCBjaDogY2hhcn1cclxudHlwZSBmdWxsc2VwUmVjICAgPSB7b3Bjb2RlOiAnZnVsbHNlcCcsIGNoOiBjaGFyfVxyXG50eXBlIHRvdGFsc1JlYyAgICA9IHtvcGNvZGU6ICd0b3RhbHMnLCBsUm93OiBzdHJpbmdbXX1cclxudHlwZSBzdWJ0b3RhbHNSZWMgPSB7b3Bjb2RlOiAnc3VidG90YWxzJywgbFJvdzogc3RyaW5nW119XHJcblxyXG50eXBlIHJvd0Rlc2MgPSB0aXRsZVJlYyB8IGxhYmVsc1JlYyB8IGRhdGFSZWMgfCBzZXBSZWMgfCBmdWxsc2VwUmVjIHwgdG90YWxzUmVjIHwgc3VidG90YWxzUmVjXHJcblxyXG4vKipcclxuICogY2xhc3MgdXNlZCB0byBjb25zdHJ1Y3QgYSB0ZXh0IHRhYmxlIGFzIGEgc3RyaW5nXHJcbiAqXHJcbiAqIFNZTk9QU0lTOlxyXG4gKiBcdHRhYmxlIDo9IG5ldyBUZXh0VGFibGUoJ2wgciUuMmYgciUuMmYnKVxyXG4gKiBcdHRhYmxlLnRpdGxlICAgJ015IEV4cGVuc2VzJ1xyXG4gKiBcdHRhYmxlLmZ1bGxzZXAgJy0nXHJcbiAqIFx0dGFibGUubGFiZWxzICBbJycsICdKYW4nLCAnRmViJ11cclxuICogXHR0YWJsZS5zZXAoKVxyXG4gKiBcdHRhYmxlLmRhdGEgICAgWydjb2ZmZWUnLCAzMCwgNDBdXHJcbiAqIFx0dGFibGUuZGF0YSAgICBbJ2RpbmluZycsIDEzMCwgNDBdXHJcbiAqIFx0dGFibGUuc2VwICAgICAnLSdcclxuICogXHR0YWJsZS5zdWJ0b3RhbHMoKVxyXG4gKiBcdHRhYmxlLmRhdGEgICAgWydvbmUgdGltZScsIDEwLCAyMF1cclxuICogXHR0YWJsZS5kYXRhICAgIFsnb3RoZXInLCAxMDAwLCA0MF1cclxuICogXHR0YWJsZS5mdWxsc2VwICc9J1xyXG4gKiBcdHRhYmxlLnRvdGFscygpXHJcbiAqXHJcbiAqIFx0dGV4dFRhYmxlIDo9IHRhYmxlLmFzU3RyaW5nKG8naGlkZT0xJylcclxuICovXHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dFRhYmxlXHJcblxyXG5cdGhPcHRpb25zOiBoYXNoXHJcblx0bnVtQ29sczogaW50ZWdlclxyXG5cdGxMYWJlbHM6IHN0cmluZ1tdID0gW11cclxuXHJcblx0bENvbHM6IGNvbERlc2NbXSA9IFtdXHJcblx0bFJvd3M6IHJvd0Rlc2NbXSA9IFtdXHJcblxyXG5cdGNvbnN0cnVjdG9yKFxyXG5cdFx0XHRmb3JtYXRTdHI6IHN0cmluZyxcclxuXHRcdFx0aE9wdGlvbnM6IGhhc2g9e31cclxuXHRcdFx0KVxyXG5cclxuXHRcdCMgLS0tIFZhbGlkIG9wdGlvbnM6XHJcblx0XHQjICAgICAgICBkZWNQbGFjZXMgLSB1c2VkIGZvciBudW1iZXJzIHdpdGggbm8gJSBzdHlsZSBmb3JtYXRcclxuXHRcdCMgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDJcclxuXHRcdCMgICAgICAgIHBhcnNlTnVtYmVycyAtIHN0cmluZyBkYXRhIHRoYXQgbG9va3MgbGlrZSBhIG51bWJlclxyXG5cdFx0IyAgICAgICAgICAgICAgICAgICAgICAgaXMgdHJlYXRlZCBhcyBhIG51bWJlciwgZGVmYXVsdDogZmFsc2VcclxuXHJcblx0XHRAaE9wdGlvbnMgPSBnZXRPcHRpb25zIGhPcHRpb25zLCB7XHJcblx0XHRcdGRlY1BsYWNlczogMlxyXG5cdFx0XHRwYXJzZU51bWJlcnM6IGZhbHNlXHJcblx0XHRcdH1cclxuXHJcblx0XHRmb3Igd29yZCBvZiB3b3Jkcyhmb3JtYXRTdHIpXHJcblx0XHRcdGlmIChsTWF0Y2hlcyA6PSB3b3JkLm1hdGNoKC9eKGx8Y3xyKShcXCVcXFMrKT8kLykpXHJcblx0XHRcdFx0W18sIGFsaWduLCBmbXRdIDo9IGxNYXRjaGVzXHJcblx0XHRcdFx0QGxDb2xzLnB1c2gge1xyXG5cdFx0XHRcdFx0d2lkdGg6IDAgICAgICMgYWRqdXN0ZWQgYXMgZGF0YSBpcyBhZGRlZFxyXG5cdFx0XHRcdFx0Zm9ybWF0OiBmbXRcclxuXHRcdFx0XHRcdGFsaWduOiAoYWxpZ24gfHwgJ2xlZnQnKSBhcyBUQWxpZ25tZW50XHJcblx0XHRcdFx0XHR0b3RhbDogdW5kZWYgICAgICMgaW5jcmVtZW50ZWQgYXMgZGF0YSBpcyBhZGRlZFxyXG5cdFx0XHRcdFx0c3VidG90YWw6IHVuZGVmICAjIGluY3JlbWVudGVkIGFzIGRhdGEgaXMgYWRkZWQsXHJcblx0XHRcdFx0XHQgICAgICAgICAgICAgICAgICMgdW5kZWYgd2hlbiBzdWJ0b3RhbCBpcyBvdXRwdXRcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdGNyb2FrIFwiQmFkIGZvcm1hdCBzdHJpbmc6ICN7T0wod29yZCl9XCJcclxuXHRcdEBudW1Db2xzID0gQGxDb2xzLmxlbmd0aFxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHJcblx0dGl0bGUodGl0bGU6IHN0cmluZywgYWxpZ246IFRBbGlnbm1lbnQ9J2NlbnRlcicpXHJcblxyXG5cdFx0YXNzZXJ0IG5vbkVtcHR5KHRpdGxlKSwgXCJCYWQgdGl0bGU6ICdAe3RpdGxlfSdcIlxyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICd0aXRsZSdcclxuXHRcdFx0dGl0bGVcclxuXHRcdFx0YWxpZ25cclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRsYWJlbHMobExhYmVsczogKHN0cmluZz8pW10pXHJcblxyXG5cdFx0YXNzZXJ0IChsTGFiZWxzLmxlbmd0aCA9PSBAbnVtQ29scyksIFwibExhYmVscyA9ICN7T0wobExhYmVscyl9XCJcclxuXHRcdGxSb3c6IHN0cmluZ1tdIDo9IGxMYWJlbHMubWFwIChpdGVtLCBjb2xOdW0pID0+XHJcblx0XHRcdHJldHVybiBpdGVtIHx8ICcnXHJcblx0XHRAYWRqdXN0Q29sV2lkdGhzIGxSb3dcclxuXHRcdEBsUm93cy5wdXNoIHtcclxuXHRcdFx0b3Bjb2RlOiAnbGFiZWxzJ1xyXG5cdFx0XHRsUm93XHJcblx0XHRcdH1cclxuXHRcdEBsTGFiZWxzID0gbFJvd1xyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRhY2N1bShoQ29sOiBjb2xEZXNjLCBhbXQ6IG51bWJlcilcclxuXHJcblx0XHRpZiBkZWZpbmVkKGhDb2wudG90YWwpXHJcblx0XHRcdGhDb2wudG90YWwgKz0gYW10XHJcblx0XHRlbHNlXHJcblx0XHRcdGhDb2wudG90YWwgPSBhbXRcclxuXHRcdGlmIGRlZmluZWQoaENvbC5zdWJ0b3RhbClcclxuXHRcdFx0aENvbC5zdWJ0b3RhbCArPSBhbXRcclxuXHRcdGVsc2VcclxuXHRcdFx0aENvbC5zdWJ0b3RhbCA9IGFtdFxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRkYXRhKGxEYXRhOiAobnVtYmVyIHwgc3RyaW5nIHwgdW5kZWZpbmVkKVtdKVxyXG5cclxuXHRcdGFzc2VydCAobERhdGEubGVuZ3RoID09IEBudW1Db2xzKSwgXCJsRGF0YSA9ICN7T0wobERhdGEpfVwiXHJcblx0XHRsUm93OiBzdHJpbmdbXSA6PSBsRGF0YS5tYXAgKGl0ZW0sIGNvbE51bSkgPT5cclxuXHRcdFx0c3dpdGNoIHR5cGVvZiBpdGVtXHJcblx0XHRcdFx0d2hlbiAnbnVtYmVyJ1xyXG5cdFx0XHRcdFx0aENvbCA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRcdFx0QGFjY3VtIGhDb2wsIGl0ZW1cclxuXHRcdFx0XHRcdHJldHVybiBAZm9ybWF0TnVtKGl0ZW0sIGhDb2wuZm9ybWF0KVxyXG5cdFx0XHRcdHdoZW4gJ3N0cmluZydcclxuXHRcdFx0XHRcdGhDb2wgOj0gQGxDb2xzW2NvbE51bV1cclxuXHRcdFx0XHRcdGlmIEBoT3B0aW9ucy5wYXJzZU51bWJlcnMgJiYgaXRlbS5tYXRjaCgvLy9eXHJcblx0XHRcdFx0XHRcdFx0XFxkKyAgICAgICAgICMgb25lIG9yIG1vcmUgZGlnaXRzXHJcblx0XHRcdFx0XHRcdFx0KFxcLlxcZCopPyAgICAjIG9wdGlvbmFsIGRlY2ltYWwgcGFydFxyXG5cdFx0XHRcdFx0XHRcdChbRWVdXFxkKyk/ICAjIG9wdGlvbmFsIGV4cG9uZW50XHJcblx0XHRcdFx0XHRcdFx0JC8vLylcclxuXHRcdFx0XHRcdFx0bnVtIDo9IHBhcnNlRmxvYXQoaXRlbSlcclxuXHRcdFx0XHRcdFx0aWYgTnVtYmVyLmlzTmFOKG51bSlcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gaXRlbVxyXG5cdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0QGFjY3VtIGhDb2wsIG51bVxyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBAZm9ybWF0TnVtKG51bSwgaENvbC5mb3JtYXQpXHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtXHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0cmV0dXJuICcnXHJcblxyXG5cdFx0QGFkanVzdENvbFdpZHRocyBsUm93XHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ2RhdGEnXHJcblx0XHRcdGxSb3dcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRzZXAoY2g6IGNoYXIgPSAnLScpXHJcblxyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICdzZXAnXHJcblx0XHRcdGNoXHJcblx0XHRcdH1cclxuXHRcdHJldHVyblxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHJcblx0ZnVsbHNlcChjaDogY2hhciA9Jy0nKVxyXG5cclxuXHRcdEBsUm93cy5wdXNoIHtcclxuXHRcdFx0b3Bjb2RlOiAnZnVsbHNlcCdcclxuXHRcdFx0Y2hcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHR0b3RhbHMoKVxyXG5cclxuXHRcdGxSb3cgOj0gQGxDb2xzLm1hcCAoaENvbCwgY29sTnVtKSA9PlxyXG5cdFx0XHR7dG90YWwsIGZvcm1hdH0gOj0gaENvbFxyXG5cdFx0XHRpZiBkZWZpbmVkKHRvdGFsKVxyXG5cdFx0XHRcdHJldHVybiBAZm9ybWF0TnVtKHRvdGFsLCBmb3JtYXQpXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRyZXR1cm4gJydcclxuXHRcdEBhZGp1c3RDb2xXaWR0aHMgbFJvd1xyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICd0b3RhbHMnXHJcblx0XHRcdGxSb3dcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRzdWJ0b3RhbHMoKVxyXG5cclxuXHRcdGxSb3cgOj0gQGxDb2xzLm1hcCAoaENvbCwgY29sTnVtKSA9PlxyXG5cdFx0XHR7c3VidG90YWwsIGZvcm1hdH0gOj0gaENvbFxyXG5cdFx0XHRpZiBkZWZpbmVkKGhDb2wuc3VidG90YWwpXHJcblx0XHRcdFx0aENvbC5zdWJ0b3RhbCA9IDBcclxuXHRcdFx0aWYgZGVmaW5lZChzdWJ0b3RhbClcclxuXHRcdFx0XHRyZXR1cm4gQGZvcm1hdE51bShzdWJ0b3RhbCwgZm9ybWF0KVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0cmV0dXJuICcnXHJcblx0XHRAYWRqdXN0Q29sV2lkdGhzIGxSb3dcclxuXHRcdEBsUm93cy5wdXNoIHtcclxuXHRcdFx0b3Bjb2RlOiAnc3VidG90YWxzJ1xyXG5cdFx0XHRsUm93XHJcblx0XHRcdH1cclxuXHRcdHJldHVyblxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHJcblx0YWRqdXN0Q29sV2lkdGhzKGxSb3c6IHN0cmluZ1tdKVxyXG5cclxuXHRcdGZvciBzdHIsY29sTnVtIG9mIGxSb3dcclxuXHRcdFx0aENvbCA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRpZiAoc3RyLmxlbmd0aCA+IGhDb2wud2lkdGgpXHJcblx0XHRcdFx0aENvbC53aWR0aCA9IHN0ci5sZW5ndGhcclxuXHRcdHJldHVyblxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHJcblx0Zm9ybWF0TnVtKG51bTogbnVtYmVyLCBmbXQ6IHN0cmluZyk6IHN0cmluZ1xyXG5cclxuXHRcdGlmIGRlZmluZWQoZm10KVxyXG5cdFx0XHRyZXR1cm4gc3ByaW50ZihmbXQsIG51bSlcclxuXHRcdGVsc2VcclxuXHRcdFx0cmV0dXJuIG51bS50b0ZpeGVkKEBoT3B0aW9ucy5kZWNQbGFjZXMpXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRkdW1wSW50ZXJuYWxzKClcclxuXHJcblx0XHRMT0dWQUxVRSAnbnVtQ29sczonLCBAbnVtQ29sc1xyXG5cdFx0TE9HVkFMVUUgJ2xDb2xzOicsIEBsQ29sc1xyXG5cdFx0TE9HVkFMVUUgJ2xSb3dzOicsIEBsUm93c1xyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRnZXRUb3RhbFdpZHRoKGxIaWRkZW46IGludGVnZXJbXSA9IFtdKVxyXG5cclxuXHRcdGFjY0Z1bmMgOj0gKGFjYzogaW50ZWdlciwgaENvbDogY29sRGVzYywgaTogaW50ZWdlcikgPT5cclxuXHRcdFx0aWYgbEhpZGRlbi5pbmNsdWRlcyhpKVxyXG5cdFx0XHRcdHJldHVybiBhY2NcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiBhY2MgKyAxICsgaENvbC53aWR0aFxyXG5cdFx0cmV0dXJuIEBsQ29scy5yZWR1Y2UoYWNjRnVuYywgMCkgLSAxXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRnZXRDb2xzVG9IaWRlKFxyXG5cdFx0aGlkZTogKHN0cmluZyB8IGludGVnZXIgfCBpbnRlZ2VyW10pXHJcblx0XHQpOiBpbnRlZ2VyW11cclxuXHJcblx0XHRpZiBpc0FycmF5T2ZJbnRlZ2VycyhoaWRlKVxyXG5cdFx0XHRyZXR1cm4gaGlkZVxyXG5cdFx0c3dpdGNoIHR5cGVvZiBoaWRlXHJcblx0XHRcdHdoZW4gJ3N0cmluZydcclxuXHRcdFx0XHRsSW50cyA6PSBmb3Igc3RyIG9mIGhpZGUuc3BsaXQoJywnKVxyXG5cdFx0XHRcdFx0aWYgc3RyLm1hdGNoKC9eXFxkKyQvKVxyXG5cdFx0XHRcdFx0XHRwYXJzZUludChzdHIpXHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdEBsTGFiZWxzLmluZGV4T2Yoc3RyLnRyaW0oKSkgICMgbWlnaHQgYmUgLTFcclxuXHRcdFx0XHRyZXR1cm4gbEludHNcclxuXHRcdFx0d2hlbiAnbnVtYmVyJ1xyXG5cdFx0XHRcdHJldHVybiBbaGlkZV1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiBbXVxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHQjIC0tLSBvcHRpb24gJ2xIaWRlJyBzaG91bGQgYmUgYW4gYXJyYXkgb2YgaW50ZWdlcnNcclxuXHJcblx0YXNTdHJpbmcoaE9wdGlvbnM9e30pXHJcblxyXG5cdFx0IyAtLS0gb3B0aW9uIHRvIGhpZGUgY2VydGFpbiBjb2x1bW5zXHJcblx0XHR7aGlkZX0gOj0gZ2V0T3B0aW9ucyBoT3B0aW9ucywge1xyXG5cdFx0XHRoaWRlOiB1bmRlZlxyXG5cdFx0XHR9XHJcblx0XHREQkcgJ2hpZGUnLCBoaWRlXHJcblx0XHRsSGlkZGVuIDo9IEBnZXRDb2xzVG9IaWRlKGhpZGUpXHJcblx0XHREQkcgJ2xIaWRkZW4nLCBsSGlkZGVuXHJcblxyXG5cdFx0IyAtLS0gY3JlYXRlIGEgZmlsdGVyIGZ1bmN0aW9uXHJcblx0XHRmZiA6PSAoXHJcblx0XHRcdChsSGlkZGVuLmxlbmd0aCA9PSAwKVxyXG5cdFx0XHQ/ICh4OmFueSkgPT4gcmV0dXJuIHRydWVcclxuXHRcdFx0OiAoeDphbnksIGk6aW50ZWdlcikgPT4gcmV0dXJuIG5vdCBsSGlkZGVuLmluY2x1ZGVzKGkpXHJcblx0XHRcdClcclxuXHJcblx0XHR0b3RhbFdpZHRoIDo9IEBnZXRUb3RhbFdpZHRoKGxIaWRkZW4pXHJcblx0XHREQkcgJ3RvdGFsV2lkdGgnLCB0b3RhbFdpZHRoXHJcblxyXG5cdFx0IyAtLS0gTWFwIGVhY2ggaXRlbSBpbiBAbFJvd3MgdG8gYSBzdHJpbmdcclxuXHRcdGxMaW5lcyA6PSBAbFJvd3MubWFwIChoKSA9PlxyXG5cdFx0XHRzd2l0Y2ggaC5vcGNvZGVcclxuXHJcblx0XHRcdFx0d2hlbiAndGl0bGUnXHJcblx0XHRcdFx0XHRyZXR1cm4gYWxpZ25TdHJpbmcoaC50aXRsZSwgdG90YWxXaWR0aCwgaC5hbGlnbilcclxuXHJcblx0XHRcdFx0d2hlbiAnbGFiZWxzJ1xyXG5cdFx0XHRcdFx0IyAtLS0gbGFiZWxzIGFyZSBhbHdheXMgY2VudGVyIGFsaWduZWRcclxuXHRcdFx0XHRcdHJldHVybiBoLmxSb3cubWFwKChzdHIsIGNvbE51bSkgPT5cclxuXHRcdFx0XHRcdFx0e3dpZHRofSA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gYWxpZ25TdHJpbmcoc3RyLCB3aWR0aCwgJ2NlbnRlcicpXHJcblx0XHRcdFx0XHRcdCkuZmlsdGVyKGZmKS5qb2luKCcgJylcclxuXHJcblx0XHRcdFx0d2hlbiAnZGF0YScsJ3RvdGFscycsJ3N1YnRvdGFscydcclxuXHRcdFx0XHRcdHJldHVybiBoLmxSb3cubWFwKChzdHIsIGNvbE51bSkgPT5cclxuXHRcdFx0XHRcdFx0e3dpZHRoLCBhbGlnbn0gOj0gQGxDb2xzW2NvbE51bV1cclxuXHRcdFx0XHRcdFx0cmV0dXJuIGFsaWduU3RyaW5nKHN0ciwgd2lkdGgsIGFsaWduKVxyXG5cdFx0XHRcdFx0XHQpLmZpbHRlcihmZikuam9pbignICcpXHJcblxyXG5cdFx0XHRcdHdoZW4gJ3NlcCdcclxuXHRcdFx0XHRcdHJldHVybiBAbENvbHMubWFwKChoQ29sKSA9PlxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gaC5jaC5yZXBlYXQoaENvbC53aWR0aClcclxuXHRcdFx0XHRcdFx0KS5maWx0ZXIoZmYpLmpvaW4oJyAnKVxyXG5cclxuXHRcdFx0XHR3aGVuICdmdWxsc2VwJ1xyXG5cdFx0XHRcdFx0cmV0dXJuIGguY2gucmVwZWF0KHRvdGFsV2lkdGgpXHJcblxyXG5cdFx0cmV0dXJuIHRvQmxvY2sobExpbmVzLm1hcCgobGluZSkgPT4gcnRyaW0obGluZSkpKVxyXG4iXX0=