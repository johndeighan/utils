"use strict";
// text-table.lib.civet

import {sprintf} from "@std/fmt/printf"

import {
	undef, defined, notdefined, assert, croak, nonEmpty,
	isString, isNumber, isInteger, isArray,
	array, arrayof, hash, hashof, integer, char,
	intArray, isArrayOfIntegers,
	} from 'datatypes'
import {
	getOptions, OL, words, rtrim, alignString,
	toBlock, TAlignment,
	} from 'llutils'
import {
	LOGVALUE, DBG,
	} from 'logger'

// ---------------------------------------------------------------------------

type colDesc = {
	width: integer
	format: string
	align: TAlignment
	total: (number | undefined)     // running total
	subtotal: (number | undefined)  // running subtotal, undef on subtotal()
	}

type titleRec     = {opcode: 'title', title: string, align: TAlignment}
type labelsRec    = {opcode: 'labels', lRow: string[]}
type dataRec      = {opcode: 'data', lRow: string[]}
type sepRec       = {opcode: 'sep', ch: char}
type fullsepRec   = {opcode: 'fullsep', ch: char}
type totalsRec    = {opcode: 'totals', lRow: string[]}
type subtotalsRec = {opcode: 'subtotals', lRow: string[]}

type rowDesc = titleRec | labelsRec | dataRec | sepRec | fullsepRec | totalsRec | subtotalsRec

/**
 * class used to construct a text table as a string
 *
 * SYNOPSIS:
 * 	table := new TextTable('l r%.2f r%.2f')
 * 	table.title   'My Expenses'
 * 	table.fullsep '-'
 * 	table.labels  ['', 'Jan', 'Feb']
 * 	table.sep()
 * 	table.data    ['coffee', 30, 40]
 * 	table.data    ['dining', 130, 40]
 * 	table.sep     '-'
 * 	table.subtotals()
 * 	table.data    ['one time', 10, 20]
 * 	table.data    ['other', 1000, 40]
 * 	table.fullsep '='
 * 	table.totals()
 *
 * 	textTable := table.asString(o'hide=1')
 */

type opt = {
	decPlaces: number
	parseNumbers: boolean
	}

export class TextTable {

	hOptions: opt
	numCols: integer
	lLabels: string[] = []

	lCols: colDesc[] = []
	lRows: rowDesc[] = []

	constructor(
			formatStr: string,
			hOptions: hash={}
			) {

		// --- Valid options:
		//        decPlaces - used for numbers with no % style format
		//                    default: 2
		//        parseNumbers - string data that looks like a number
		//                       is treated as a number, default: false

		this.hOptions = getOptions<opt>(hOptions, {
			decPlaces: 2,
			parseNumbers: false
			})

		for (const word of words(formatStr)) {
			let ref;if ((ref = word.match(/^(l|c|r)(\%\S+)?$/))) {const lMatches = ref;
				const [_, align, fmt] = lMatches
				this.lCols.push({
					width: 0,     // adjusted as data is added
					format: fmt,
					align: (align || 'left') as TAlignment,
					total: undef,     // incremented as data is added
					subtotal: undef  // incremented as data is added,
					                 // undef when subtotal is output
					})
			}
			else {
				croak(`Bad format string: ${OL(word)}`)
			}
		}
		this.numCols = this.lCols.length
	}

	// ..........................................................

	title(title: string, align: TAlignment='center') {

		assert(nonEmpty(title), "Bad title: '@{title}'")
		this.lRows.push({
			opcode: 'title',
			title,
			align
			})
		return
	}

	// ..........................................................

	labels(lLabels: ((string | undefined))[]) {

		assert((lLabels.length === this.numCols), `lLabels = ${OL(lLabels)}`)
		const lRow: string[] = lLabels.map((item, colNum) => {
			return item || ''
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'labels',
			lRow
			})
		this.lLabels = lRow
		return
	}

	// ..........................................................

	accum(hCol: colDesc, amt: number) {

		if (defined(hCol.total)) {
			hCol.total += amt
		}
		else {
			hCol.total = amt
		}
		if (defined(hCol.subtotal)) {
			hCol.subtotal += amt
		}
		else {
			hCol.subtotal = amt
		}
		return
	}

	// ..........................................................

	data(lData: (number | string | undefined)[]) {

		assert((lData.length === this.numCols), `lData = ${OL(lData)}`)
		const lRow: string[] = lData.map((item, colNum) => {
			switch(typeof item) {
				case 'number': {
					const hCol = this.lCols[colNum]
					this.accum(hCol, item)
					return this.formatNum(item, hCol.format)
				}
				case 'string': {
					const hCol = this.lCols[colNum]
					if (this.hOptions.parseNumbers && item.match(/^\d+(\.\d*)?([Ee]\d+)?$/)) {
						const num = parseFloat(item)
						if (Number.isNaN(num)) {
							return item
						}
						else {
							this.accum(hCol, num)
							return this.formatNum(num, hCol.format)
						}
					}
					else {
						return item
					}
				}
				default: {
					return ''
				}
			}
		})

		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'data',
			lRow
			})
		return
	}

	// ..........................................................

	sep(ch: char = '-') {

		this.lRows.push({
			opcode: 'sep',
			ch
			})
		return
	}

	// ..........................................................

	fullsep(ch: char ='-') {

		this.lRows.push({
			opcode: 'fullsep',
			ch
			})
		return
	}

	// ..........................................................

	totals() {

		const lRow = this.lCols.map((hCol, colNum) => {
			const {total, format} = hCol
			if (defined(total)) {
				return this.formatNum(total, format)
			}
			else {
				return ''
			}
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'totals',
			lRow
			})
		return
	}

	// ..........................................................

	subtotals() {

		const lRow = this.lCols.map((hCol, colNum) => {
			const {subtotal, format} = hCol
			if (defined(hCol.subtotal)) {
				hCol.subtotal = 0
			}
			if (defined(subtotal)) {
				return this.formatNum(subtotal, format)
			}
			else {
				return ''
			}
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'subtotals',
			lRow
			})
		return
	}

	// ..........................................................

	adjustColWidths(lRow: string[]) {

		let i1 = 0;for (const str of lRow) {const colNum = i1++;
			const hCol = this.lCols[colNum]
			if (str.length > hCol.width) {
				hCol.width = str.length
			}
		}
		return
	}

	// ..........................................................

	formatNum(num: number, fmt: string): string {

		if (defined(fmt)) {
			return sprintf(fmt, num)
		}
		else {
			return num.toFixed(this.hOptions.decPlaces)
		}
	}

	// ..........................................................

	dumpInternals() {

		LOGVALUE('numCols:', this.numCols)
		LOGVALUE('lCols:', this.lCols)
		LOGVALUE('lRows:', this.lRows)
		return
	}

	// ..........................................................

	getTotalWidth(lHidden: integer[] = []) {

		const accFunc = (acc: integer, hCol: colDesc, i: integer) => {
			if (lHidden.includes(i)) {
				return acc
			}
			else {
				return acc + 1 + hCol.width
			}
		}
		return this.lCols.reduce(accFunc, 0) - 1
	}

	// ..........................................................

	getColsToHide(
		hide: (string | integer | integer[])
		): integer[] {

		if (isArrayOfIntegers(hide)) {
			return hide
		}
		switch(typeof hide) {
			case 'string': { {
				const results=[];for (const str of hide.split(',')) {
					if (str.match(/^\d+$/)) {
						results.push(parseInt(str))
					}
					else {
						results.push(this.lLabels.indexOf(str.trim()))
					}
				};const lInts =results  // might be -1
				return lInts}
			}
			case 'number': {
				return [hide]
			}
			default: {
				return []
			}
		}
	}

	// ..........................................................
	// --- option 'lHide' should be an array of integers

	asString(hOptions={}) {

		// --- option to hide certain columns
		type opt = {
			lHide: number[]
			}
		const {lHide} = getOptions<opt>(hOptions, {
			lHide: []
			})
		DBG('lHide', lHide)
		const lHidden = this.getColsToHide(lHide)
		DBG('lHidden', lHidden)

		// --- create a filter function
		const ff = (
			(lHidden.length === 0)
			? (x:any) => { return true }
			: (x:any, i:integer) => { return !lHidden.includes(i) }
			)

		const totalWidth = this.getTotalWidth(lHidden)
		DBG('totalWidth', totalWidth)

		// --- Map each item in @lRows to a string
		const lLines = this.lRows.map((h) => {
			switch(h.opcode) {

				case 'title': {
					return alignString(h.title, totalWidth, h.align)
				}

				case 'labels': {
					// --- labels are always center aligned
					return h.lRow.map((str, colNum) => {
						const {width} = this.lCols[colNum]
						return alignString(str, width, 'center')
					}
						).filter(ff).join(' ')
				}

				case 'data':case 'totals':case 'subtotals': {
					return h.lRow.map((str, colNum) => {
						const {width, align} = this.lCols[colNum]
						return alignString(str, width, align)
					}
						).filter(ff).join(' ')
				}

				case 'sep': {
					return this.lCols.map((hCol) => {
						return h.ch.repeat(hCol.width)
					}
						).filter(ff).join(' ')
				}

				case 'fullsep': {
					return h.ch.repeat(totalWidth)
				}
			}
		})

		return toBlock(lLines.map((line) => rtrim(line)))
	}
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi90ZXh0LXRhYmxlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbInNyYy9saWIvdGV4dC10YWJsZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSx1QkFBc0I7QUFDdEIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUN2QyxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDckQsQ0FBQyxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDeEMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDN0MsQ0FBQyxRQUFRLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztBQUM3QixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztBQUNuQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLFdBQVcsQ0FBQztBQUMzQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQztBQUNyQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUztBQUNqQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNmLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRO0FBQ2hCLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFB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QUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDO0tBQUMsQ0FBQTtBQUNwQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQztJQUFDLENBQUE7QUFDNUIsQUFBQTtBQUNBLEFBQUEsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFBLENBQUEsQ0FBQTtBQUNsQixBQUFBLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFVBQVUsQztJQUFDLEM7R0FBQSxDO0VBQUEsQ0FBQSxDQUFBO0FBQ25DLEFBQUE7QUFDQSxBQUFBLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDO0NBQUMsQztBQUFBLENBQUE7QUFDbkQiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgdGV4dC10YWJsZS5saWIuY2l2ZXRcclxuXHJcbmltcG9ydCB7c3ByaW50Zn0gZnJvbSBcIkBzdGQvZm10L3ByaW50ZlwiXHJcblxyXG5pbXBvcnQge1xyXG5cdHVuZGVmLCBkZWZpbmVkLCBub3RkZWZpbmVkLCBhc3NlcnQsIGNyb2FrLCBub25FbXB0eSxcclxuXHRpc1N0cmluZywgaXNOdW1iZXIsIGlzSW50ZWdlciwgaXNBcnJheSxcclxuXHRhcnJheSwgYXJyYXlvZiwgaGFzaCwgaGFzaG9mLCBpbnRlZ2VyLCBjaGFyLFxyXG5cdGludEFycmF5LCBpc0FycmF5T2ZJbnRlZ2VycyxcclxuXHR9IGZyb20gJ2RhdGF0eXBlcydcclxuaW1wb3J0IHtcclxuXHRnZXRPcHRpb25zLCBPTCwgd29yZHMsIHJ0cmltLCBhbGlnblN0cmluZyxcclxuXHR0b0Jsb2NrLCBUQWxpZ25tZW50LFxyXG5cdH0gZnJvbSAnbGx1dGlscydcclxuaW1wb3J0IHtcclxuXHRMT0dWQUxVRSwgREJHLFxyXG5cdH0gZnJvbSAnbG9nZ2VyJ1xyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbnR5cGUgY29sRGVzYyA9IHtcclxuXHR3aWR0aDogaW50ZWdlclxyXG5cdGZvcm1hdDogc3RyaW5nXHJcblx0YWxpZ246IFRBbGlnbm1lbnRcclxuXHR0b3RhbDogbnVtYmVyPyAgICAgIyBydW5uaW5nIHRvdGFsXHJcblx0c3VidG90YWw6IG51bWJlcj8gICMgcnVubmluZyBzdWJ0b3RhbCwgdW5kZWYgb24gc3VidG90YWwoKVxyXG5cdH1cclxuXHJcbnR5cGUgdGl0bGVSZWMgICAgID0ge29wY29kZTogJ3RpdGxlJywgdGl0bGU6IHN0cmluZywgYWxpZ246IFRBbGlnbm1lbnR9XHJcbnR5cGUgbGFiZWxzUmVjICAgID0ge29wY29kZTogJ2xhYmVscycsIGxSb3c6IHN0cmluZ1tdfVxyXG50eXBlIGRhdGFSZWMgICAgICA9IHtvcGNvZGU6ICdkYXRhJywgbFJvdzogc3RyaW5nW119XHJcbnR5cGUgc2VwUmVjICAgICAgID0ge29wY29kZTogJ3NlcCcsIGNoOiBjaGFyfVxyXG50eXBlIGZ1bGxzZXBSZWMgICA9IHtvcGNvZGU6ICdmdWxsc2VwJywgY2g6IGNoYXJ9XHJcbnR5cGUgdG90YWxzUmVjICAgID0ge29wY29kZTogJ3RvdGFscycsIGxSb3c6IHN0cmluZ1tdfVxyXG50eXBlIHN1YnRvdGFsc1JlYyA9IHtvcGNvZGU6ICdzdWJ0b3RhbHMnLCBsUm93OiBzdHJpbmdbXX1cclxuXHJcbnR5cGUgcm93RGVzYyA9IHRpdGxlUmVjIHwgbGFiZWxzUmVjIHwgZGF0YVJlYyB8IHNlcFJlYyB8IGZ1bGxzZXBSZWMgfCB0b3RhbHNSZWMgfCBzdWJ0b3RhbHNSZWNcclxuXHJcbi8qKlxyXG4gKiBjbGFzcyB1c2VkIHRvIGNvbnN0cnVjdCBhIHRleHQgdGFibGUgYXMgYSBzdHJpbmdcclxuICpcclxuICogU1lOT1BTSVM6XHJcbiAqIFx0dGFibGUgOj0gbmV3IFRleHRUYWJsZSgnbCByJS4yZiByJS4yZicpXHJcbiAqIFx0dGFibGUudGl0bGUgICAnTXkgRXhwZW5zZXMnXHJcbiAqIFx0dGFibGUuZnVsbHNlcCAnLSdcclxuICogXHR0YWJsZS5sYWJlbHMgIFsnJywgJ0phbicsICdGZWInXVxyXG4gKiBcdHRhYmxlLnNlcCgpXHJcbiAqIFx0dGFibGUuZGF0YSAgICBbJ2NvZmZlZScsIDMwLCA0MF1cclxuICogXHR0YWJsZS5kYXRhICAgIFsnZGluaW5nJywgMTMwLCA0MF1cclxuICogXHR0YWJsZS5zZXAgICAgICctJ1xyXG4gKiBcdHRhYmxlLnN1YnRvdGFscygpXHJcbiAqIFx0dGFibGUuZGF0YSAgICBbJ29uZSB0aW1lJywgMTAsIDIwXVxyXG4gKiBcdHRhYmxlLmRhdGEgICAgWydvdGhlcicsIDEwMDAsIDQwXVxyXG4gKiBcdHRhYmxlLmZ1bGxzZXAgJz0nXHJcbiAqIFx0dGFibGUudG90YWxzKClcclxuICpcclxuICogXHR0ZXh0VGFibGUgOj0gdGFibGUuYXNTdHJpbmcobydoaWRlPTEnKVxyXG4gKi9cclxuXHJcbnR5cGUgb3B0ID0ge1xyXG5cdGRlY1BsYWNlczogbnVtYmVyXHJcblx0cGFyc2VOdW1iZXJzOiBib29sZWFuXHJcblx0fVxyXG5cclxuZXhwb3J0IGNsYXNzIFRleHRUYWJsZVxyXG5cclxuXHRoT3B0aW9uczogb3B0XHJcblx0bnVtQ29sczogaW50ZWdlclxyXG5cdGxMYWJlbHM6IHN0cmluZ1tdID0gW11cclxuXHJcblx0bENvbHM6IGNvbERlc2NbXSA9IFtdXHJcblx0bFJvd3M6IHJvd0Rlc2NbXSA9IFtdXHJcblxyXG5cdGNvbnN0cnVjdG9yKFxyXG5cdFx0XHRmb3JtYXRTdHI6IHN0cmluZyxcclxuXHRcdFx0aE9wdGlvbnM6IGhhc2g9e31cclxuXHRcdFx0KVxyXG5cclxuXHRcdCMgLS0tIFZhbGlkIG9wdGlvbnM6XHJcblx0XHQjICAgICAgICBkZWNQbGFjZXMgLSB1c2VkIGZvciBudW1iZXJzIHdpdGggbm8gJSBzdHlsZSBmb3JtYXRcclxuXHRcdCMgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDJcclxuXHRcdCMgICAgICAgIHBhcnNlTnVtYmVycyAtIHN0cmluZyBkYXRhIHRoYXQgbG9va3MgbGlrZSBhIG51bWJlclxyXG5cdFx0IyAgICAgICAgICAgICAgICAgICAgICAgaXMgdHJlYXRlZCBhcyBhIG51bWJlciwgZGVmYXVsdDogZmFsc2VcclxuXHJcblx0XHRAaE9wdGlvbnMgPSBnZXRPcHRpb25zPG9wdD4gaE9wdGlvbnMsIHtcclxuXHRcdFx0ZGVjUGxhY2VzOiAyXHJcblx0XHRcdHBhcnNlTnVtYmVyczogZmFsc2VcclxuXHRcdFx0fVxyXG5cclxuXHRcdGZvciB3b3JkIG9mIHdvcmRzKGZvcm1hdFN0cilcclxuXHRcdFx0aWYgKGxNYXRjaGVzIDo9IHdvcmQubWF0Y2goL14obHxjfHIpKFxcJVxcUyspPyQvKSlcclxuXHRcdFx0XHRbXywgYWxpZ24sIGZtdF0gOj0gbE1hdGNoZXNcclxuXHRcdFx0XHRAbENvbHMucHVzaCB7XHJcblx0XHRcdFx0XHR3aWR0aDogMCAgICAgIyBhZGp1c3RlZCBhcyBkYXRhIGlzIGFkZGVkXHJcblx0XHRcdFx0XHRmb3JtYXQ6IGZtdFxyXG5cdFx0XHRcdFx0YWxpZ246IChhbGlnbiB8fCAnbGVmdCcpIGFzIFRBbGlnbm1lbnRcclxuXHRcdFx0XHRcdHRvdGFsOiB1bmRlZiAgICAgIyBpbmNyZW1lbnRlZCBhcyBkYXRhIGlzIGFkZGVkXHJcblx0XHRcdFx0XHRzdWJ0b3RhbDogdW5kZWYgICMgaW5jcmVtZW50ZWQgYXMgZGF0YSBpcyBhZGRlZCxcclxuXHRcdFx0XHRcdCAgICAgICAgICAgICAgICAgIyB1bmRlZiB3aGVuIHN1YnRvdGFsIGlzIG91dHB1dFxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0Y3JvYWsgXCJCYWQgZm9ybWF0IHN0cmluZzogI3tPTCh3b3JkKX1cIlxyXG5cdFx0QG51bUNvbHMgPSBAbENvbHMubGVuZ3RoXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHR0aXRsZSh0aXRsZTogc3RyaW5nLCBhbGlnbjogVEFsaWdubWVudD0nY2VudGVyJylcclxuXHJcblx0XHRhc3NlcnQgbm9uRW1wdHkodGl0bGUpLCBcIkJhZCB0aXRsZTogJ0B7dGl0bGV9J1wiXHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ3RpdGxlJ1xyXG5cdFx0XHR0aXRsZVxyXG5cdFx0XHRhbGlnblxyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGxhYmVscyhsTGFiZWxzOiAoc3RyaW5nPylbXSlcclxuXHJcblx0XHRhc3NlcnQgKGxMYWJlbHMubGVuZ3RoID09IEBudW1Db2xzKSwgXCJsTGFiZWxzID0gI3tPTChsTGFiZWxzKX1cIlxyXG5cdFx0bFJvdzogc3RyaW5nW10gOj0gbExhYmVscy5tYXAgKGl0ZW0sIGNvbE51bSkgPT5cclxuXHRcdFx0cmV0dXJuIGl0ZW0gfHwgJydcclxuXHRcdEBhZGp1c3RDb2xXaWR0aHMgbFJvd1xyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICdsYWJlbHMnXHJcblx0XHRcdGxSb3dcclxuXHRcdFx0fVxyXG5cdFx0QGxMYWJlbHMgPSBsUm93XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGFjY3VtKGhDb2w6IGNvbERlc2MsIGFtdDogbnVtYmVyKVxyXG5cclxuXHRcdGlmIGRlZmluZWQoaENvbC50b3RhbClcclxuXHRcdFx0aENvbC50b3RhbCArPSBhbXRcclxuXHRcdGVsc2VcclxuXHRcdFx0aENvbC50b3RhbCA9IGFtdFxyXG5cdFx0aWYgZGVmaW5lZChoQ29sLnN1YnRvdGFsKVxyXG5cdFx0XHRoQ29sLnN1YnRvdGFsICs9IGFtdFxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRoQ29sLnN1YnRvdGFsID0gYW10XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGRhdGEobERhdGE6IChudW1iZXIgfCBzdHJpbmcgfCB1bmRlZmluZWQpW10pXHJcblxyXG5cdFx0YXNzZXJ0IChsRGF0YS5sZW5ndGggPT0gQG51bUNvbHMpLCBcImxEYXRhID0gI3tPTChsRGF0YSl9XCJcclxuXHRcdGxSb3c6IHN0cmluZ1tdIDo9IGxEYXRhLm1hcCAoaXRlbSwgY29sTnVtKSA9PlxyXG5cdFx0XHRzd2l0Y2ggdHlwZW9mIGl0ZW1cclxuXHRcdFx0XHR3aGVuICdudW1iZXInXHJcblx0XHRcdFx0XHRoQ29sIDo9IEBsQ29sc1tjb2xOdW1dXHJcblx0XHRcdFx0XHRAYWNjdW0gaENvbCwgaXRlbVxyXG5cdFx0XHRcdFx0cmV0dXJuIEBmb3JtYXROdW0oaXRlbSwgaENvbC5mb3JtYXQpXHJcblx0XHRcdFx0d2hlbiAnc3RyaW5nJ1xyXG5cdFx0XHRcdFx0aENvbCA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRcdFx0aWYgQGhPcHRpb25zLnBhcnNlTnVtYmVycyAmJiBpdGVtLm1hdGNoKC8vL15cclxuXHRcdFx0XHRcdFx0XHRcXGQrICAgICAgICAgIyBvbmUgb3IgbW9yZSBkaWdpdHNcclxuXHRcdFx0XHRcdFx0XHQoXFwuXFxkKik/ICAgICMgb3B0aW9uYWwgZGVjaW1hbCBwYXJ0XHJcblx0XHRcdFx0XHRcdFx0KFtFZV1cXGQrKT8gICMgb3B0aW9uYWwgZXhwb25lbnRcclxuXHRcdFx0XHRcdFx0XHQkLy8vKVxyXG5cdFx0XHRcdFx0XHRudW0gOj0gcGFyc2VGbG9hdChpdGVtKVxyXG5cdFx0XHRcdFx0XHRpZiBOdW1iZXIuaXNOYU4obnVtKVxyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBpdGVtXHJcblx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRAYWNjdW0gaENvbCwgbnVtXHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIEBmb3JtYXROdW0obnVtLCBoQ29sLmZvcm1hdClcclxuXHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRyZXR1cm4gJydcclxuXHJcblx0XHRAYWRqdXN0Q29sV2lkdGhzIGxSb3dcclxuXHRcdEBsUm93cy5wdXNoIHtcclxuXHRcdFx0b3Bjb2RlOiAnZGF0YSdcclxuXHRcdFx0bFJvd1xyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHNlcChjaDogY2hhciA9ICctJylcclxuXHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ3NlcCdcclxuXHRcdFx0Y2hcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRmdWxsc2VwKGNoOiBjaGFyID0nLScpXHJcblxyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICdmdWxsc2VwJ1xyXG5cdFx0XHRjaFxyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHRvdGFscygpXHJcblxyXG5cdFx0bFJvdyA6PSBAbENvbHMubWFwIChoQ29sLCBjb2xOdW0pID0+XHJcblx0XHRcdHt0b3RhbCwgZm9ybWF0fSA6PSBoQ29sXHJcblx0XHRcdGlmIGRlZmluZWQodG90YWwpXHJcblx0XHRcdFx0cmV0dXJuIEBmb3JtYXROdW0odG90YWwsIGZvcm1hdClcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiAnJ1xyXG5cdFx0QGFkanVzdENvbFdpZHRocyBsUm93XHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ3RvdGFscydcclxuXHRcdFx0bFJvd1xyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHN1YnRvdGFscygpXHJcblxyXG5cdFx0bFJvdyA6PSBAbENvbHMubWFwIChoQ29sLCBjb2xOdW0pID0+XHJcblx0XHRcdHtzdWJ0b3RhbCwgZm9ybWF0fSA6PSBoQ29sXHJcblx0XHRcdGlmIGRlZmluZWQoaENvbC5zdWJ0b3RhbClcclxuXHRcdFx0XHRoQ29sLnN1YnRvdGFsID0gMFxyXG5cdFx0XHRpZiBkZWZpbmVkKHN1YnRvdGFsKVxyXG5cdFx0XHRcdHJldHVybiBAZm9ybWF0TnVtKHN1YnRvdGFsLCBmb3JtYXQpXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRyZXR1cm4gJydcclxuXHRcdEBhZGp1c3RDb2xXaWR0aHMgbFJvd1xyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICdzdWJ0b3RhbHMnXHJcblx0XHRcdGxSb3dcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRhZGp1c3RDb2xXaWR0aHMobFJvdzogc3RyaW5nW10pXHJcblxyXG5cdFx0Zm9yIHN0cixjb2xOdW0gb2YgbFJvd1xyXG5cdFx0XHRoQ29sIDo9IEBsQ29sc1tjb2xOdW1dXHJcblx0XHRcdGlmIChzdHIubGVuZ3RoID4gaENvbC53aWR0aClcclxuXHRcdFx0XHRoQ29sLndpZHRoID0gc3RyLmxlbmd0aFxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRmb3JtYXROdW0obnVtOiBudW1iZXIsIGZtdDogc3RyaW5nKTogc3RyaW5nXHJcblxyXG5cdFx0aWYgZGVmaW5lZChmbXQpXHJcblx0XHRcdHJldHVybiBzcHJpbnRmKGZtdCwgbnVtKVxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRyZXR1cm4gbnVtLnRvRml4ZWQoQGhPcHRpb25zLmRlY1BsYWNlcylcclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGR1bXBJbnRlcm5hbHMoKVxyXG5cclxuXHRcdExPR1ZBTFVFICdudW1Db2xzOicsIEBudW1Db2xzXHJcblx0XHRMT0dWQUxVRSAnbENvbHM6JywgQGxDb2xzXHJcblx0XHRMT0dWQUxVRSAnbFJvd3M6JywgQGxSb3dzXHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGdldFRvdGFsV2lkdGgobEhpZGRlbjogaW50ZWdlcltdID0gW10pXHJcblxyXG5cdFx0YWNjRnVuYyA6PSAoYWNjOiBpbnRlZ2VyLCBoQ29sOiBjb2xEZXNjLCBpOiBpbnRlZ2VyKSA9PlxyXG5cdFx0XHRpZiBsSGlkZGVuLmluY2x1ZGVzKGkpXHJcblx0XHRcdFx0cmV0dXJuIGFjY1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0cmV0dXJuIGFjYyArIDEgKyBoQ29sLndpZHRoXHJcblx0XHRyZXR1cm4gQGxDb2xzLnJlZHVjZShhY2NGdW5jLCAwKSAtIDFcclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGdldENvbHNUb0hpZGUoXHJcblx0XHRoaWRlOiAoc3RyaW5nIHwgaW50ZWdlciB8IGludGVnZXJbXSlcclxuXHRcdCk6IGludGVnZXJbXVxyXG5cclxuXHRcdGlmIGlzQXJyYXlPZkludGVnZXJzKGhpZGUpXHJcblx0XHRcdHJldHVybiBoaWRlXHJcblx0XHRzd2l0Y2ggdHlwZW9mIGhpZGVcclxuXHRcdFx0d2hlbiAnc3RyaW5nJ1xyXG5cdFx0XHRcdGxJbnRzIDo9IGZvciBzdHIgb2YgaGlkZS5zcGxpdCgnLCcpXHJcblx0XHRcdFx0XHRpZiBzdHIubWF0Y2goL15cXGQrJC8pXHJcblx0XHRcdFx0XHRcdHBhcnNlSW50KHN0cilcclxuXHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0QGxMYWJlbHMuaW5kZXhPZihzdHIudHJpbSgpKSAgIyBtaWdodCBiZSAtMVxyXG5cdFx0XHRcdHJldHVybiBsSW50c1xyXG5cdFx0XHR3aGVuICdudW1iZXInXHJcblx0XHRcdFx0cmV0dXJuIFtoaWRlXVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0cmV0dXJuIFtdXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cdCMgLS0tIG9wdGlvbiAnbEhpZGUnIHNob3VsZCBiZSBhbiBhcnJheSBvZiBpbnRlZ2Vyc1xyXG5cclxuXHRhc1N0cmluZyhoT3B0aW9ucz17fSlcclxuXHJcblx0XHQjIC0tLSBvcHRpb24gdG8gaGlkZSBjZXJ0YWluIGNvbHVtbnNcclxuXHRcdHR5cGUgb3B0ID0ge1xyXG5cdFx0XHRsSGlkZTogbnVtYmVyW11cclxuXHRcdFx0fVxyXG5cdFx0e2xIaWRlfSA6PSBnZXRPcHRpb25zPG9wdD4gaE9wdGlvbnMsIHtcclxuXHRcdFx0bEhpZGU6IFtdXHJcblx0XHRcdH1cclxuXHRcdERCRyAnbEhpZGUnLCBsSGlkZVxyXG5cdFx0bEhpZGRlbiA6PSBAZ2V0Q29sc1RvSGlkZShsSGlkZSlcclxuXHRcdERCRyAnbEhpZGRlbicsIGxIaWRkZW5cclxuXHJcblx0XHQjIC0tLSBjcmVhdGUgYSBmaWx0ZXIgZnVuY3Rpb25cclxuXHRcdGZmIDo9IChcclxuXHRcdFx0KGxIaWRkZW4ubGVuZ3RoID09IDApXHJcblx0XHRcdD8gKHg6YW55KSA9PiByZXR1cm4gdHJ1ZVxyXG5cdFx0XHQ6ICh4OmFueSwgaTppbnRlZ2VyKSA9PiByZXR1cm4gbm90IGxIaWRkZW4uaW5jbHVkZXMoaSlcclxuXHRcdFx0KVxyXG5cclxuXHRcdHRvdGFsV2lkdGggOj0gQGdldFRvdGFsV2lkdGgobEhpZGRlbilcclxuXHRcdERCRyAndG90YWxXaWR0aCcsIHRvdGFsV2lkdGhcclxuXHJcblx0XHQjIC0tLSBNYXAgZWFjaCBpdGVtIGluIEBsUm93cyB0byBhIHN0cmluZ1xyXG5cdFx0bExpbmVzIDo9IEBsUm93cy5tYXAgKGgpID0+XHJcblx0XHRcdHN3aXRjaCBoLm9wY29kZVxyXG5cclxuXHRcdFx0XHR3aGVuICd0aXRsZSdcclxuXHRcdFx0XHRcdHJldHVybiBhbGlnblN0cmluZyhoLnRpdGxlLCB0b3RhbFdpZHRoLCBoLmFsaWduKVxyXG5cclxuXHRcdFx0XHR3aGVuICdsYWJlbHMnXHJcblx0XHRcdFx0XHQjIC0tLSBsYWJlbHMgYXJlIGFsd2F5cyBjZW50ZXIgYWxpZ25lZFxyXG5cdFx0XHRcdFx0cmV0dXJuIGgubFJvdy5tYXAoKHN0ciwgY29sTnVtKSA9PlxyXG5cdFx0XHRcdFx0XHR7d2lkdGh9IDo9IEBsQ29sc1tjb2xOdW1dXHJcblx0XHRcdFx0XHRcdHJldHVybiBhbGlnblN0cmluZyhzdHIsIHdpZHRoLCAnY2VudGVyJylcclxuXHRcdFx0XHRcdFx0KS5maWx0ZXIoZmYpLmpvaW4oJyAnKVxyXG5cclxuXHRcdFx0XHR3aGVuICdkYXRhJywndG90YWxzJywnc3VidG90YWxzJ1xyXG5cdFx0XHRcdFx0cmV0dXJuIGgubFJvdy5tYXAoKHN0ciwgY29sTnVtKSA9PlxyXG5cdFx0XHRcdFx0XHR7d2lkdGgsIGFsaWdufSA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gYWxpZ25TdHJpbmcoc3RyLCB3aWR0aCwgYWxpZ24pXHJcblx0XHRcdFx0XHRcdCkuZmlsdGVyKGZmKS5qb2luKCcgJylcclxuXHJcblx0XHRcdFx0d2hlbiAnc2VwJ1xyXG5cdFx0XHRcdFx0cmV0dXJuIEBsQ29scy5tYXAoKGhDb2wpID0+XHJcblx0XHRcdFx0XHRcdHJldHVybiBoLmNoLnJlcGVhdChoQ29sLndpZHRoKVxyXG5cdFx0XHRcdFx0XHQpLmZpbHRlcihmZikuam9pbignICcpXHJcblxyXG5cdFx0XHRcdHdoZW4gJ2Z1bGxzZXAnXHJcblx0XHRcdFx0XHRyZXR1cm4gaC5jaC5yZXBlYXQodG90YWxXaWR0aClcclxuXHJcblx0XHRyZXR1cm4gdG9CbG9jayhsTGluZXMubWFwKChsaW5lKSA9PiBydHJpbShsaW5lKSkpXHJcbiJdfQ==