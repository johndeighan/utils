"use strict";
// text-table.lib.civet

import {sprintf} from "@std/fmt/printf"

import {
	undef, defined, notdefined, assert, croak, nonEmpty,
	isString, isNumber, isInteger, isArray,
	array, arrayof, hash, hashof, integer, char,
	intArray, isArrayOfIntegers,
	} from 'datatypes'
import {
	getOptions, words, rtrim, alignString,
	toBlock, TAlignment,
	} from 'llutils'
import {OL} from 'to-nice'
import {
	LOGVALUE, DBG,
	} from 'logger'

// ---------------------------------------------------------------------------

type TColDesc = {
	width: integer
	format: string
	align: TAlignment
	total: (number | undefined)     // running total
	subtotal: (number | undefined)  // running subtotal, undef on subtotal()
	}

type titleRec     = {opcode: 'title', title: string, align: TAlignment}
type labelsRec    = {opcode: 'labels', lRow: string[]}
type dataRec      = {opcode: 'data', lRow: string[]}
type sepRec       = {opcode: 'sep', ch: char}
type fullsepRec   = {opcode: 'fullsep', ch: char}
type totalsRec    = {opcode: 'totals', lRow: string[]}
type subtotalsRec = {opcode: 'subtotals', lRow: string[]}

type rowDesc = titleRec | labelsRec | dataRec | sepRec | fullsepRec | totalsRec | subtotalsRec

/**
 * class used to construct a text table as a string
 *
 * SYNOPSIS:
 * 	table := new TextTable('l r%.2f r%.2f')
 * 	table.title   'My Expenses'
 * 	table.fullsep '-'
 * 	table.labels  ['', 'Jan', 'Feb']
 * 	table.sep()
 * 	table.data    ['coffee', 30, 40]
 * 	table.data    ['dining', 130, 40]
 * 	table.sep     '-'
 * 	table.subtotals()
 * 	table.data    ['one time', 10, 20]
 * 	table.data    ['other', 1000, 40]
 * 	table.fullsep '='
 * 	table.totals()
 *
 * 	textTable := table.asString(o'hide=1')
 */

type opt = {
	decPlaces: number
	parseNumbers: boolean
	}

export class TextTable {

	hOptions: opt
	numCols: integer
	lLabels: string[] = []

	lCols: TColDesc[] = []
	lRows: rowDesc[] = []

	constructor(
			formatStr: string,
			hOptions: hash={}
			) {

		// --- Valid options:
		//        decPlaces - used for numbers with no % style format
		//                    default: 2
		//        parseNumbers - string data that looks like a number
		//                       is treated as a number, default: false

		this.hOptions = getOptions<opt>(hOptions, {
			decPlaces: 2,
			parseNumbers: false
			})

		for (const word of words(formatStr)) {
			let ref;if ((ref = word.match(/^(l|c|r)(\%\S+)?$/))) {const lMatches = ref;
				const [_, align, fmt] = lMatches
				this.lCols.push({
					width: 0,     // adjusted as data is added
					format: fmt,
					align: (align || 'left') as TAlignment,
					total: undef,     // incremented as data is added
					subtotal: undef  // incremented as data is added,
					                 // undef when subtotal is output
					})
			}
			else {
				croak(`Bad format string: ${OL(word)}`)
			}
		}
		this.numCols = this.lCols.length
	}

	// ..........................................................

	title(title: string, align: TAlignment='center') {

		assert(nonEmpty(title), "Bad title: '@{title}'")
		this.lRows.push({
			opcode: 'title',
			title,
			align
			})
		return
	}

	// ..........................................................

	labels(lLabels: ((string | undefined))[]) {

		assert((lLabels.length === this.numCols), `lLabels = ${OL(lLabels)}`)
		const lRow: string[] = lLabels.map((item, colNum) => {
			return item || ''
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'labels',
			lRow
			})
		this.lLabels = lRow
		return
	}

	// ..........................................................

	accum(hCol: TColDesc, amt: number) {

		if (defined(hCol.total)) {
			hCol.total += amt
		}
		else {
			hCol.total = amt
		}
		if (defined(hCol.subtotal)) {
			hCol.subtotal += amt
		}
		else {
			hCol.subtotal = amt
		}
		return
	}

	// ..........................................................

	data(lData: (number | string | undefined)[]) {

		assert((lData.length === this.numCols), `lData = ${OL(lData)}`)
		const lRow: string[] = lData.map((item, colNum) => {
			switch(typeof item) {
				case 'number': {
					const hCol = this.lCols[colNum]
					this.accum(hCol, item)
					return this.formatNum(item, hCol.format)
				}
				case 'string': {
					const hCol = this.lCols[colNum]
					if (this.hOptions.parseNumbers && item.match(/^\d+(\.\d*)?([Ee]\d+)?$/)) {
						const num = parseFloat(item)
						if (Number.isNaN(num)) {
							return item
						}
						else {
							this.accum(hCol, num)
							return this.formatNum(num, hCol.format)
						}
					}
					else {
						return item
					}
				}
				default: {
					return ''
				}
			}
		})

		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'data',
			lRow
			})
		return
	}

	// ..........................................................

	sep(ch: char = '-') {

		this.lRows.push({
			opcode: 'sep',
			ch
			})
		return
	}

	// ..........................................................

	fullsep(ch: char ='-') {

		this.lRows.push({
			opcode: 'fullsep',
			ch
			})
		return
	}

	// ..........................................................

	totals() {

		const lRow = this.lCols.map((hCol, colNum) => {
			const {total, format} = hCol
			if (defined(total)) {
				return this.formatNum(total, format)
			}
			else {
				return ''
			}
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'totals',
			lRow
			})
		return
	}

	// ..........................................................

	subtotals() {

		const lRow = this.lCols.map((hCol, colNum) => {
			const {subtotal, format} = hCol
			if (defined(hCol.subtotal)) {
				hCol.subtotal = 0
			}
			if (defined(subtotal)) {
				return this.formatNum(subtotal, format)
			}
			else {
				return ''
			}
		})
		this.adjustColWidths(lRow)
		this.lRows.push({
			opcode: 'subtotals',
			lRow
			})
		return
	}

	// ..........................................................

	adjustColWidths(lRow: string[]) {

		let i1 = 0;for (const str of lRow) {const colNum = i1++;
			const hCol = this.lCols[colNum]
			if (str.length > hCol.width) {
				hCol.width = str.length
			}
		}
		return
	}

	// ..........................................................

	formatNum(num: number, fmt: string): string {

		if (defined(fmt)) {
			return sprintf(fmt, num)
		}
		else {
			return num.toFixed(this.hOptions.decPlaces)
		}
	}

	// ..........................................................

	dumpInternals() {

		LOGVALUE('numCols:', this.numCols)
		LOGVALUE('lCols:', this.lCols)
		LOGVALUE('lRows:', this.lRows)
		return
	}

	// ..........................................................

	getTotalWidth(lHidden: integer[] = []) {

		const accFunc = (acc: integer, hCol: TColDesc, i: integer) => {
			if (lHidden.includes(i)) {
				return acc
			}
			else {
				return acc + 1 + hCol.width
			}
		}
		return this.lCols.reduce(accFunc, 0) - 1
	}

	// ..........................................................

	getColsToHide(
		hide: (string | integer | integer[])
		): integer[] {

		if (isArrayOfIntegers(hide)) {
			return hide
		}
		switch(typeof hide) {
			case 'string': { {
				const results=[];for (const str of hide.split(',')) {
					if (str.match(/^\d+$/)) {
						results.push(parseInt(str))
					}
					else {
						results.push(this.lLabels.indexOf(str.trim()))
					}
				};const lInts =results  // might be -1
				return lInts}
			}
			case 'number': {
				return [hide]
			}
			default: {
				return []
			}
		}
	}

	// ..........................................................
	// --- option 'lHide' should be an array of integers

	asString(hOptions={}) {

		// --- option to hide certain columns
		type opt = {
			lHide: number[]
			}
		const {lHide} = getOptions<opt>(hOptions, {
			lHide: []
			})
		DBG('lHide', lHide)
		const lHidden = this.getColsToHide(lHide)
		DBG('lHidden', lHidden)

		// --- create a filter function
		const ff = (
			(lHidden.length === 0)
			? (x:unknown) => { return true }
			: (x:unknown, i:integer) => { return !lHidden.includes(i) }
			)

		const totalWidth = this.getTotalWidth(lHidden)
		DBG('totalWidth', totalWidth)

		// --- Map each item in @lRows to a string
		const lLines = this.lRows.map((h) => {
			switch(h.opcode) {

				case 'title': {
					return alignString(h.title, totalWidth, h.align)
				}

				case 'labels': {
					// --- labels are always center aligned
					return h.lRow.map((str, colNum) => {
						const {width} = this.lCols[colNum]
						return alignString(str, width, 'center')
					}
						).filter(ff).join(' ')
				}

				case 'data':case 'totals':case 'subtotals': {
					return h.lRow.map((str, colNum) => {
						const {width, align} = this.lCols[colNum]
						return alignString(str, width, align)
					}
						).filter(ff).join(' ')
				}

				case 'sep': {
					return this.lCols.map((hCol) => {
						return h.ch.repeat(hCol.width)
					}
						).filter(ff).join(' ')
				}

				case 'fullsep': {
					return h.ch.repeat(totalWidth)
				}
			}
		})

		return toBlock(lLines.map((line) => rtrim(line)))
	}
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFx0ZXh0LXRhYmxlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXGxpYlxcdGV4dC10YWJsZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSx1QkFBc0I7QUFDdEIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUN2QyxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDckQsQ0FBQyxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDeEMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDN0MsQ0FBQyxRQUFRLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztBQUM3QixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztBQUNuQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLFVBQVUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLFdBQVcsQ0FBQztBQUN2QyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQztBQUNyQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUztBQUNqQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVM7QUFDMUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxRQUFRLENBQUMsQ0FB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SSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUEsQUFBQyxDQUFDO0FBQ2YsQUFBQSxHQUFHLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQTtBQUNuQixBQUFBLEdBQUcsSUFBSTtBQUNQLEdBQUcsQ0FBQyxDQUFBO0FBQ0osQUFBQSxFQUFFLE07Q0FBTSxDQUFBO0FBQ1IsQUFBQTtBQUNBLEFBQUEsQ0FBQyw2REFBNEQ7QUFDN0QsQUFBQTtBQUNBLEFBQUEsQyxTQUFVLENBQUMsQ0FBQyxDQUFBLENBQUE7QUFDWixBQUFBO0FBQ0EsQUFBQSxFQUFNLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQSxBQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDdEMsQUFBQSxHQUFxQixNQUFsQixDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUUsQ0FBQyxJQUFJO0FBQzdCLEFBQUEsR0FBRyxHQUFHLENBQUEsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDNUIsQUFBQSxJQUFJLElBQUksQ0FBQyxRQUFRLEMsQ0FBRSxDQUFDLEM7R0FBQyxDQUFBO0FBQ3JCLEFBQUEsR0FBRyxHQUFHLENBQUEsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUN2QixBQUFBLElBQUksTUFBTSxDQUFDLEksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDO0dBQUMsQ0FBQTtBQUN2QyxBQUFBLEdBQUcsSUFBSSxDQUFBLENBQUE7QUFDUCxBQUFBLElBQUksTUFBTSxDQUFDLEU7R0FBRSxDO0VBQUEsQ0FBQSxDQUFBO0FBQ2IsQUFBQSxFQUFFLEksQ0FBQyxlQUFlLENBQUEsQUFBQyxJQUFJLENBQUE7QUFDdkIsQUFBQSxFQUFFLEksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFBLEFBQUMsQ0FBQztBQUNmLEFBQUEsR0FBRyxNQUFNLENBQUMsQ0FB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LENBQUEsQ0FBQSxDQUFBO0FBQ2pCLEFBQUEsS0FBSyx1Q0FBc0M7QUFDM0MsQUFBQSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZDLEFBQUEsTUFBYSxNQUFQLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBRSxDQUFDLEksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDO0FBQy9CLEFBQUEsTUFBTSxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsQztLQUFDLENBQUE7QUFDOUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEM7SUFBQyxDQUFBO0FBQzVCLEFBQUE7QUFDQSxBQUFBLElBQUksSUFBSSxDQUFDLE1BQU0sQyxLQUFDLFFBQVEsQyxLQUFDLFdBQVcsQ0FBQSxDQUFBLENBQUE7QUFDcEMsQUFBQSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZDLEFBQUEsTUFBb0IsTUFBZCxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUUsQ0FBQyxJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztBQUN0QyxBQUFBLE1BQU0sTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEM7S0FBQyxDQUFBO0FBQzNDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDO0lBQUMsQ0FBQTtBQUM1QixBQUFBO0FBQ0EsQUFBQSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQSxDQUFBO0FBQ2QsQUFBQSxLQUFLLE1BQU0sQ0FBQyxJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ2hDLEFBQUEsTUFBTSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQztLQUFDLENBQUE7QUFDcEMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEM7SUFBQyxDQUFBO0FBQzVCLEFBQUE7QUFDQSxBQUFBLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQSxDQUFBLENBQUE7QUFDbEIsQUFBQSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEM7SUFBQyxDO0dBQUEsQztFQUFBLENBQUEsQ0FBQTtBQUNuQyxBQUFBO0FBQ0EsQUFBQSxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQztDQUFDLEM7QUFBQSxDQUFBO0FBQ25EIiwibmFtZXMiOltdLCJzb3VyY2VzQ29udGVudCI6WyIjIHRleHQtdGFibGUubGliLmNpdmV0XHJcblxyXG5pbXBvcnQge3NwcmludGZ9IGZyb20gXCJAc3RkL2ZtdC9wcmludGZcIlxyXG5cclxuaW1wb3J0IHtcclxuXHR1bmRlZiwgZGVmaW5lZCwgbm90ZGVmaW5lZCwgYXNzZXJ0LCBjcm9haywgbm9uRW1wdHksXHJcblx0aXNTdHJpbmcsIGlzTnVtYmVyLCBpc0ludGVnZXIsIGlzQXJyYXksXHJcblx0YXJyYXksIGFycmF5b2YsIGhhc2gsIGhhc2hvZiwgaW50ZWdlciwgY2hhcixcclxuXHRpbnRBcnJheSwgaXNBcnJheU9mSW50ZWdlcnMsXHJcblx0fSBmcm9tICdkYXRhdHlwZXMnXHJcbmltcG9ydCB7XHJcblx0Z2V0T3B0aW9ucywgd29yZHMsIHJ0cmltLCBhbGlnblN0cmluZyxcclxuXHR0b0Jsb2NrLCBUQWxpZ25tZW50LFxyXG5cdH0gZnJvbSAnbGx1dGlscydcclxuaW1wb3J0IHtPTH0gZnJvbSAndG8tbmljZSdcclxuaW1wb3J0IHtcclxuXHRMT0dWQUxVRSwgREJHLFxyXG5cdH0gZnJvbSAnbG9nZ2VyJ1xyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbnR5cGUgVENvbERlc2MgPSB7XHJcblx0d2lkdGg6IGludGVnZXJcclxuXHRmb3JtYXQ6IHN0cmluZ1xyXG5cdGFsaWduOiBUQWxpZ25tZW50XHJcblx0dG90YWw6IG51bWJlcj8gICAgICMgcnVubmluZyB0b3RhbFxyXG5cdHN1YnRvdGFsOiBudW1iZXI/ICAjIHJ1bm5pbmcgc3VidG90YWwsIHVuZGVmIG9uIHN1YnRvdGFsKClcclxuXHR9XHJcblxyXG50eXBlIHRpdGxlUmVjICAgICA9IHtvcGNvZGU6ICd0aXRsZScsIHRpdGxlOiBzdHJpbmcsIGFsaWduOiBUQWxpZ25tZW50fVxyXG50eXBlIGxhYmVsc1JlYyAgICA9IHtvcGNvZGU6ICdsYWJlbHMnLCBsUm93OiBzdHJpbmdbXX1cclxudHlwZSBkYXRhUmVjICAgICAgPSB7b3Bjb2RlOiAnZGF0YScsIGxSb3c6IHN0cmluZ1tdfVxyXG50eXBlIHNlcFJlYyAgICAgICA9IHtvcGNvZGU6ICdzZXAnLCBjaDogY2hhcn1cclxudHlwZSBmdWxsc2VwUmVjICAgPSB7b3Bjb2RlOiAnZnVsbHNlcCcsIGNoOiBjaGFyfVxyXG50eXBlIHRvdGFsc1JlYyAgICA9IHtvcGNvZGU6ICd0b3RhbHMnLCBsUm93OiBzdHJpbmdbXX1cclxudHlwZSBzdWJ0b3RhbHNSZWMgPSB7b3Bjb2RlOiAnc3VidG90YWxzJywgbFJvdzogc3RyaW5nW119XHJcblxyXG50eXBlIHJvd0Rlc2MgPSB0aXRsZVJlYyB8IGxhYmVsc1JlYyB8IGRhdGFSZWMgfCBzZXBSZWMgfCBmdWxsc2VwUmVjIHwgdG90YWxzUmVjIHwgc3VidG90YWxzUmVjXHJcblxyXG4vKipcclxuICogY2xhc3MgdXNlZCB0byBjb25zdHJ1Y3QgYSB0ZXh0IHRhYmxlIGFzIGEgc3RyaW5nXHJcbiAqXHJcbiAqIFNZTk9QU0lTOlxyXG4gKiBcdHRhYmxlIDo9IG5ldyBUZXh0VGFibGUoJ2wgciUuMmYgciUuMmYnKVxyXG4gKiBcdHRhYmxlLnRpdGxlICAgJ015IEV4cGVuc2VzJ1xyXG4gKiBcdHRhYmxlLmZ1bGxzZXAgJy0nXHJcbiAqIFx0dGFibGUubGFiZWxzICBbJycsICdKYW4nLCAnRmViJ11cclxuICogXHR0YWJsZS5zZXAoKVxyXG4gKiBcdHRhYmxlLmRhdGEgICAgWydjb2ZmZWUnLCAzMCwgNDBdXHJcbiAqIFx0dGFibGUuZGF0YSAgICBbJ2RpbmluZycsIDEzMCwgNDBdXHJcbiAqIFx0dGFibGUuc2VwICAgICAnLSdcclxuICogXHR0YWJsZS5zdWJ0b3RhbHMoKVxyXG4gKiBcdHRhYmxlLmRhdGEgICAgWydvbmUgdGltZScsIDEwLCAyMF1cclxuICogXHR0YWJsZS5kYXRhICAgIFsnb3RoZXInLCAxMDAwLCA0MF1cclxuICogXHR0YWJsZS5mdWxsc2VwICc9J1xyXG4gKiBcdHRhYmxlLnRvdGFscygpXHJcbiAqXHJcbiAqIFx0dGV4dFRhYmxlIDo9IHRhYmxlLmFzU3RyaW5nKG8naGlkZT0xJylcclxuICovXHJcblxyXG50eXBlIG9wdCA9IHtcclxuXHRkZWNQbGFjZXM6IG51bWJlclxyXG5cdHBhcnNlTnVtYmVyczogYm9vbGVhblxyXG5cdH1cclxuXHJcbmV4cG9ydCBjbGFzcyBUZXh0VGFibGVcclxuXHJcblx0aE9wdGlvbnM6IG9wdFxyXG5cdG51bUNvbHM6IGludGVnZXJcclxuXHRsTGFiZWxzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG5cdGxDb2xzOiBUQ29sRGVzY1tdID0gW11cclxuXHRsUm93czogcm93RGVzY1tdID0gW11cclxuXHJcblx0Y29uc3RydWN0b3IoXHJcblx0XHRcdGZvcm1hdFN0cjogc3RyaW5nLFxyXG5cdFx0XHRoT3B0aW9uczogaGFzaD17fVxyXG5cdFx0XHQpXHJcblxyXG5cdFx0IyAtLS0gVmFsaWQgb3B0aW9uczpcclxuXHRcdCMgICAgICAgIGRlY1BsYWNlcyAtIHVzZWQgZm9yIG51bWJlcnMgd2l0aCBubyAlIHN0eWxlIGZvcm1hdFxyXG5cdFx0IyAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogMlxyXG5cdFx0IyAgICAgICAgcGFyc2VOdW1iZXJzIC0gc3RyaW5nIGRhdGEgdGhhdCBsb29rcyBsaWtlIGEgbnVtYmVyXHJcblx0XHQjICAgICAgICAgICAgICAgICAgICAgICBpcyB0cmVhdGVkIGFzIGEgbnVtYmVyLCBkZWZhdWx0OiBmYWxzZVxyXG5cclxuXHRcdEBoT3B0aW9ucyA9IGdldE9wdGlvbnM8b3B0PiBoT3B0aW9ucywge1xyXG5cdFx0XHRkZWNQbGFjZXM6IDJcclxuXHRcdFx0cGFyc2VOdW1iZXJzOiBmYWxzZVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0Zm9yIHdvcmQgb2Ygd29yZHMoZm9ybWF0U3RyKVxyXG5cdFx0XHRpZiAobE1hdGNoZXMgOj0gd29yZC5tYXRjaCgvXihsfGN8cikoXFwlXFxTKyk/JC8pKVxyXG5cdFx0XHRcdFtfLCBhbGlnbiwgZm10XSA6PSBsTWF0Y2hlc1xyXG5cdFx0XHRcdEBsQ29scy5wdXNoIHtcclxuXHRcdFx0XHRcdHdpZHRoOiAwICAgICAjIGFkanVzdGVkIGFzIGRhdGEgaXMgYWRkZWRcclxuXHRcdFx0XHRcdGZvcm1hdDogZm10XHJcblx0XHRcdFx0XHRhbGlnbjogKGFsaWduIHx8ICdsZWZ0JykgYXMgVEFsaWdubWVudFxyXG5cdFx0XHRcdFx0dG90YWw6IHVuZGVmICAgICAjIGluY3JlbWVudGVkIGFzIGRhdGEgaXMgYWRkZWRcclxuXHRcdFx0XHRcdHN1YnRvdGFsOiB1bmRlZiAgIyBpbmNyZW1lbnRlZCBhcyBkYXRhIGlzIGFkZGVkLFxyXG5cdFx0XHRcdFx0ICAgICAgICAgICAgICAgICAjIHVuZGVmIHdoZW4gc3VidG90YWwgaXMgb3V0cHV0XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRjcm9hayBcIkJhZCBmb3JtYXQgc3RyaW5nOiAje09MKHdvcmQpfVwiXHJcblx0XHRAbnVtQ29scyA9IEBsQ29scy5sZW5ndGhcclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHRpdGxlKHRpdGxlOiBzdHJpbmcsIGFsaWduOiBUQWxpZ25tZW50PSdjZW50ZXInKVxyXG5cclxuXHRcdGFzc2VydCBub25FbXB0eSh0aXRsZSksIFwiQmFkIHRpdGxlOiAnQHt0aXRsZX0nXCJcclxuXHRcdEBsUm93cy5wdXNoIHtcclxuXHRcdFx0b3Bjb2RlOiAndGl0bGUnXHJcblx0XHRcdHRpdGxlXHJcblx0XHRcdGFsaWduXHJcblx0XHRcdH1cclxuXHRcdHJldHVyblxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHJcblx0bGFiZWxzKGxMYWJlbHM6IChzdHJpbmc/KVtdKVxyXG5cclxuXHRcdGFzc2VydCAobExhYmVscy5sZW5ndGggPT0gQG51bUNvbHMpLCBcImxMYWJlbHMgPSAje09MKGxMYWJlbHMpfVwiXHJcblx0XHRsUm93OiBzdHJpbmdbXSA6PSBsTGFiZWxzLm1hcCAoaXRlbSwgY29sTnVtKSA9PlxyXG5cdFx0XHRyZXR1cm4gaXRlbSB8fCAnJ1xyXG5cdFx0QGFkanVzdENvbFdpZHRocyBsUm93XHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ2xhYmVscydcclxuXHRcdFx0bFJvd1xyXG5cdFx0XHR9XHJcblx0XHRAbExhYmVscyA9IGxSb3dcclxuXHRcdHJldHVyblxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHJcblx0YWNjdW0oaENvbDogVENvbERlc2MsIGFtdDogbnVtYmVyKVxyXG5cclxuXHRcdGlmIGRlZmluZWQoaENvbC50b3RhbClcclxuXHRcdFx0aENvbC50b3RhbCArPSBhbXRcclxuXHRcdGVsc2VcclxuXHRcdFx0aENvbC50b3RhbCA9IGFtdFxyXG5cdFx0aWYgZGVmaW5lZChoQ29sLnN1YnRvdGFsKVxyXG5cdFx0XHRoQ29sLnN1YnRvdGFsICs9IGFtdFxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRoQ29sLnN1YnRvdGFsID0gYW10XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGRhdGEobERhdGE6IChudW1iZXIgfCBzdHJpbmcgfCB1bmRlZmluZWQpW10pXHJcblxyXG5cdFx0YXNzZXJ0IChsRGF0YS5sZW5ndGggPT0gQG51bUNvbHMpLCBcImxEYXRhID0gI3tPTChsRGF0YSl9XCJcclxuXHRcdGxSb3c6IHN0cmluZ1tdIDo9IGxEYXRhLm1hcCAoaXRlbSwgY29sTnVtKSA9PlxyXG5cdFx0XHRzd2l0Y2ggdHlwZW9mIGl0ZW1cclxuXHRcdFx0XHR3aGVuICdudW1iZXInXHJcblx0XHRcdFx0XHRoQ29sIDo9IEBsQ29sc1tjb2xOdW1dXHJcblx0XHRcdFx0XHRAYWNjdW0gaENvbCwgaXRlbVxyXG5cdFx0XHRcdFx0cmV0dXJuIEBmb3JtYXROdW0oaXRlbSwgaENvbC5mb3JtYXQpXHJcblx0XHRcdFx0d2hlbiAnc3RyaW5nJ1xyXG5cdFx0XHRcdFx0aENvbCA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRcdFx0aWYgQGhPcHRpb25zLnBhcnNlTnVtYmVycyAmJiBpdGVtLm1hdGNoKC8vL15cclxuXHRcdFx0XHRcdFx0XHRcXGQrICAgICAgICAgIyBvbmUgb3IgbW9yZSBkaWdpdHNcclxuXHRcdFx0XHRcdFx0XHQoXFwuXFxkKik/ICAgICMgb3B0aW9uYWwgZGVjaW1hbCBwYXJ0XHJcblx0XHRcdFx0XHRcdFx0KFtFZV1cXGQrKT8gICMgb3B0aW9uYWwgZXhwb25lbnRcclxuXHRcdFx0XHRcdFx0XHQkLy8vKVxyXG5cdFx0XHRcdFx0XHRudW0gOj0gcGFyc2VGbG9hdChpdGVtKVxyXG5cdFx0XHRcdFx0XHRpZiBOdW1iZXIuaXNOYU4obnVtKVxyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBpdGVtXHJcblx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRAYWNjdW0gaENvbCwgbnVtXHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIEBmb3JtYXROdW0obnVtLCBoQ29sLmZvcm1hdClcclxuXHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRyZXR1cm4gJydcclxuXHJcblx0XHRAYWRqdXN0Q29sV2lkdGhzIGxSb3dcclxuXHRcdEBsUm93cy5wdXNoIHtcclxuXHRcdFx0b3Bjb2RlOiAnZGF0YSdcclxuXHRcdFx0bFJvd1xyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHNlcChjaDogY2hhciA9ICctJylcclxuXHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ3NlcCdcclxuXHRcdFx0Y2hcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRmdWxsc2VwKGNoOiBjaGFyID0nLScpXHJcblxyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICdmdWxsc2VwJ1xyXG5cdFx0XHRjaFxyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHRvdGFscygpXHJcblxyXG5cdFx0bFJvdyA6PSBAbENvbHMubWFwIChoQ29sLCBjb2xOdW0pID0+XHJcblx0XHRcdHt0b3RhbCwgZm9ybWF0fSA6PSBoQ29sXHJcblx0XHRcdGlmIGRlZmluZWQodG90YWwpXHJcblx0XHRcdFx0cmV0dXJuIEBmb3JtYXROdW0odG90YWwsIGZvcm1hdClcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiAnJ1xyXG5cdFx0QGFkanVzdENvbFdpZHRocyBsUm93XHJcblx0XHRAbFJvd3MucHVzaCB7XHJcblx0XHRcdG9wY29kZTogJ3RvdGFscydcclxuXHRcdFx0bFJvd1xyXG5cdFx0XHR9XHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdHN1YnRvdGFscygpXHJcblxyXG5cdFx0bFJvdyA6PSBAbENvbHMubWFwIChoQ29sLCBjb2xOdW0pID0+XHJcblx0XHRcdHtzdWJ0b3RhbCwgZm9ybWF0fSA6PSBoQ29sXHJcblx0XHRcdGlmIGRlZmluZWQoaENvbC5zdWJ0b3RhbClcclxuXHRcdFx0XHRoQ29sLnN1YnRvdGFsID0gMFxyXG5cdFx0XHRpZiBkZWZpbmVkKHN1YnRvdGFsKVxyXG5cdFx0XHRcdHJldHVybiBAZm9ybWF0TnVtKHN1YnRvdGFsLCBmb3JtYXQpXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRyZXR1cm4gJydcclxuXHRcdEBhZGp1c3RDb2xXaWR0aHMgbFJvd1xyXG5cdFx0QGxSb3dzLnB1c2gge1xyXG5cdFx0XHRvcGNvZGU6ICdzdWJ0b3RhbHMnXHJcblx0XHRcdGxSb3dcclxuXHRcdFx0fVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRhZGp1c3RDb2xXaWR0aHMobFJvdzogc3RyaW5nW10pXHJcblxyXG5cdFx0Zm9yIHN0cixjb2xOdW0gb2YgbFJvd1xyXG5cdFx0XHRoQ29sIDo9IEBsQ29sc1tjb2xOdW1dXHJcblx0XHRcdGlmIChzdHIubGVuZ3RoID4gaENvbC53aWR0aClcclxuXHRcdFx0XHRoQ29sLndpZHRoID0gc3RyLmxlbmd0aFxyXG5cdFx0cmV0dXJuXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRmb3JtYXROdW0obnVtOiBudW1iZXIsIGZtdDogc3RyaW5nKTogc3RyaW5nXHJcblxyXG5cdFx0aWYgZGVmaW5lZChmbXQpXHJcblx0XHRcdHJldHVybiBzcHJpbnRmKGZtdCwgbnVtKVxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRyZXR1cm4gbnVtLnRvRml4ZWQoQGhPcHRpb25zLmRlY1BsYWNlcylcclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGR1bXBJbnRlcm5hbHMoKVxyXG5cclxuXHRcdExPR1ZBTFVFICdudW1Db2xzOicsIEBudW1Db2xzXHJcblx0XHRMT0dWQUxVRSAnbENvbHM6JywgQGxDb2xzXHJcblx0XHRMT0dWQUxVRSAnbFJvd3M6JywgQGxSb3dzXHJcblx0XHRyZXR1cm5cclxuXHJcblx0IyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblxyXG5cdGdldFRvdGFsV2lkdGgobEhpZGRlbjogaW50ZWdlcltdID0gW10pXHJcblxyXG5cdFx0YWNjRnVuYyA6PSAoYWNjOiBpbnRlZ2VyLCBoQ29sOiBUQ29sRGVzYywgaTogaW50ZWdlcikgPT5cclxuXHRcdFx0aWYgbEhpZGRlbi5pbmNsdWRlcyhpKVxyXG5cdFx0XHRcdHJldHVybiBhY2NcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiBhY2MgKyAxICsgaENvbC53aWR0aFxyXG5cdFx0cmV0dXJuIEBsQ29scy5yZWR1Y2UoYWNjRnVuYywgMCkgLSAxXHJcblxyXG5cdCMgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cclxuXHRnZXRDb2xzVG9IaWRlKFxyXG5cdFx0aGlkZTogKHN0cmluZyB8IGludGVnZXIgfCBpbnRlZ2VyW10pXHJcblx0XHQpOiBpbnRlZ2VyW11cclxuXHJcblx0XHRpZiBpc0FycmF5T2ZJbnRlZ2VycyhoaWRlKVxyXG5cdFx0XHRyZXR1cm4gaGlkZVxyXG5cdFx0c3dpdGNoIHR5cGVvZiBoaWRlXHJcblx0XHRcdHdoZW4gJ3N0cmluZydcclxuXHRcdFx0XHRsSW50cyA6PSBmb3Igc3RyIG9mIGhpZGUuc3BsaXQoJywnKVxyXG5cdFx0XHRcdFx0aWYgc3RyLm1hdGNoKC9eXFxkKyQvKVxyXG5cdFx0XHRcdFx0XHRwYXJzZUludChzdHIpXHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdEBsTGFiZWxzLmluZGV4T2Yoc3RyLnRyaW0oKSkgICMgbWlnaHQgYmUgLTFcclxuXHRcdFx0XHRyZXR1cm4gbEludHNcclxuXHRcdFx0d2hlbiAnbnVtYmVyJ1xyXG5cdFx0XHRcdHJldHVybiBbaGlkZV1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiBbXVxyXG5cclxuXHQjIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHQjIC0tLSBvcHRpb24gJ2xIaWRlJyBzaG91bGQgYmUgYW4gYXJyYXkgb2YgaW50ZWdlcnNcclxuXHJcblx0YXNTdHJpbmcoaE9wdGlvbnM9e30pXHJcblxyXG5cdFx0IyAtLS0gb3B0aW9uIHRvIGhpZGUgY2VydGFpbiBjb2x1bW5zXHJcblx0XHR0eXBlIG9wdCA9IHtcclxuXHRcdFx0bEhpZGU6IG51bWJlcltdXHJcblx0XHRcdH1cclxuXHRcdHtsSGlkZX0gOj0gZ2V0T3B0aW9uczxvcHQ+IGhPcHRpb25zLCB7XHJcblx0XHRcdGxIaWRlOiBbXVxyXG5cdFx0XHR9XHJcblx0XHREQkcgJ2xIaWRlJywgbEhpZGVcclxuXHRcdGxIaWRkZW4gOj0gQGdldENvbHNUb0hpZGUobEhpZGUpXHJcblx0XHREQkcgJ2xIaWRkZW4nLCBsSGlkZGVuXHJcblxyXG5cdFx0IyAtLS0gY3JlYXRlIGEgZmlsdGVyIGZ1bmN0aW9uXHJcblx0XHRmZiA6PSAoXHJcblx0XHRcdChsSGlkZGVuLmxlbmd0aCA9PSAwKVxyXG5cdFx0XHQ/ICh4OnVua25vd24pID0+IHJldHVybiB0cnVlXHJcblx0XHRcdDogKHg6dW5rbm93biwgaTppbnRlZ2VyKSA9PiByZXR1cm4gbm90IGxIaWRkZW4uaW5jbHVkZXMoaSlcclxuXHRcdFx0KVxyXG5cclxuXHRcdHRvdGFsV2lkdGggOj0gQGdldFRvdGFsV2lkdGgobEhpZGRlbilcclxuXHRcdERCRyAndG90YWxXaWR0aCcsIHRvdGFsV2lkdGhcclxuXHJcblx0XHQjIC0tLSBNYXAgZWFjaCBpdGVtIGluIEBsUm93cyB0byBhIHN0cmluZ1xyXG5cdFx0bExpbmVzIDo9IEBsUm93cy5tYXAgKGgpID0+XHJcblx0XHRcdHN3aXRjaCBoLm9wY29kZVxyXG5cclxuXHRcdFx0XHR3aGVuICd0aXRsZSdcclxuXHRcdFx0XHRcdHJldHVybiBhbGlnblN0cmluZyhoLnRpdGxlLCB0b3RhbFdpZHRoLCBoLmFsaWduKVxyXG5cclxuXHRcdFx0XHR3aGVuICdsYWJlbHMnXHJcblx0XHRcdFx0XHQjIC0tLSBsYWJlbHMgYXJlIGFsd2F5cyBjZW50ZXIgYWxpZ25lZFxyXG5cdFx0XHRcdFx0cmV0dXJuIGgubFJvdy5tYXAoKHN0ciwgY29sTnVtKSA9PlxyXG5cdFx0XHRcdFx0XHR7d2lkdGh9IDo9IEBsQ29sc1tjb2xOdW1dXHJcblx0XHRcdFx0XHRcdHJldHVybiBhbGlnblN0cmluZyhzdHIsIHdpZHRoLCAnY2VudGVyJylcclxuXHRcdFx0XHRcdFx0KS5maWx0ZXIoZmYpLmpvaW4oJyAnKVxyXG5cclxuXHRcdFx0XHR3aGVuICdkYXRhJywndG90YWxzJywnc3VidG90YWxzJ1xyXG5cdFx0XHRcdFx0cmV0dXJuIGgubFJvdy5tYXAoKHN0ciwgY29sTnVtKSA9PlxyXG5cdFx0XHRcdFx0XHR7d2lkdGgsIGFsaWdufSA6PSBAbENvbHNbY29sTnVtXVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gYWxpZ25TdHJpbmcoc3RyLCB3aWR0aCwgYWxpZ24pXHJcblx0XHRcdFx0XHRcdCkuZmlsdGVyKGZmKS5qb2luKCcgJylcclxuXHJcblx0XHRcdFx0d2hlbiAnc2VwJ1xyXG5cdFx0XHRcdFx0cmV0dXJuIEBsQ29scy5tYXAoKGhDb2wpID0+XHJcblx0XHRcdFx0XHRcdHJldHVybiBoLmNoLnJlcGVhdChoQ29sLndpZHRoKVxyXG5cdFx0XHRcdFx0XHQpLmZpbHRlcihmZikuam9pbignICcpXHJcblxyXG5cdFx0XHRcdHdoZW4gJ2Z1bGxzZXAnXHJcblx0XHRcdFx0XHRyZXR1cm4gaC5jaC5yZXBlYXQodG90YWxXaWR0aClcclxuXHJcblx0XHRyZXR1cm4gdG9CbG9jayhsTGluZXMubWFwKChsaW5lKSA9PiBydHJpbShsaW5lKSkpXHJcbiJdfQ==