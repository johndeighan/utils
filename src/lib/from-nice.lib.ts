"use strict";
// from-nice.lib.civet

import {sep, centered} from 'base-utils'
import {
	undef, defined, notdefined, assert, croak, hash, hashof,
	isArray, isFunction, isBoolean, isString, isNonPrimitive,
	isClass, isArrayOfStrings, isEmpty, nonEmpty,
	className, functionName, symbolName,
	classDef, functionDef, regexpDef,
	} from 'datatypes'
import {
	getOptions, escapeStr, unescapeStr,
	keys, toBlock, o, rtrim, Fetcher,
	} from 'llutils'
import {OL} from 'to-nice'
import {indented} from 'indent'
import {toNice} from 'to-nice'
import {
	TPLLToken, tkEOF, tkIndent, tkUndent,
	TTokenGenerator, allTokensInBlock,
	} from 'pll'

// ---------------------------------------------------------------------------

export const niceSplitter: TTokenGenerator = function*(
		str: string
		) {
	let ref;let ref1;if ((ref = str.match(/^-(.*)$/))) {let lMatches = ref;
		const tail = lMatches[1].trim()
		if (tail) {
			yield {
				kind: 'list-item',
				str,
				value: getPrimitive(tail)
				}
		}
		else {
			yield {
				kind: 'list-head',
				name: str,
				str: ''
				}
		}
	}
	else if ((ref1 = str.match(/^([A-Za-z][A-Za-z0-9_]*):(.*)$/))) {let lMatches = ref1;
		const name = lMatches[1]
		const tail = lMatches[2].trim()
		if (tail) {
			yield {
				kind: 'hash-item',
				str,
				name,
				value: getPrimitive(tail)
				}
		}
		else {
			yield {
				kind: 'hash-head',
				name,
				str
				}
		}
	}
	else {
		yield {
			kind: 'primitive',
			str,
			value: getPrimitive(str)
			}
	}
}

// ---------------------------------------------------------------------------

export const allNiceTokens = function*(
		block: string,
		): Generator<TPLLToken, void, void> {

	for (const h of allTokensInBlock(block, niceSplitter)) {
		yield h
	}
	return
}

// ---------------------------------------------------------------------------

export const fromNice = (
		str: string,
		): unknown => {

	// --- Create a Fetcher, then use
	//     recursive descent parsing

	const fetcher = new Fetcher<TPLLToken>(allNiceTokens(str), tkEOF)

	const parseObj = (): unknown => {
		const {kind, str} = fetcher.peek()
		if(kind === 'list-item' || kind === 'list-head') {
				return parseList()}
else if(kind === 'hash-item' || kind === 'hash-head') {
				return parseHash()}
else if(kind === 'eof') {
				return undef}
else  {
				fetcher.skip()
				if (defined(str)) {
					return getPrimitive(str)
				}
			}
	}

	const parseList = (): unknown[] => {
		const lItems: unknown[] = []
		let {kind} = fetcher.peek()
		while (['list-item', 'list-head'].includes(kind)) {
			if (kind === 'list-head') {
				lItems.push(parseListNest())
			}
			else {
				lItems.push(fetcher.get().value)
			}
			kind = fetcher.peek().kind
		}
		return lItems
	}

	const parseListNest = (): unknown[] => {
		fetcher.get({kind: 'list-head', str: ''})
		fetcher.get({kind: 'indent', str: ''})
		const value = parseObj()
		fetcher.get({kind: 'undent', str: ''})
		return [value]
	}

	const parseHash = (): hash => {
		const hItems: hash = {}
		let {kind, name} = fetcher.peek()
		if (kind === 'hash-head') {
			fetcher.skip()
			fetcher.get({kind: 'indent', str: ''})
			const value = parseObj()
			if (defined(name)) {
				hItems[name] = value
			}
			fetcher.get({kind: 'undent', str: ''})
		}
		else {
			while (kind === 'hash-item') {
				const {name, value} = fetcher.get()
				if (defined(name)) {
					hItems[name] = value
				};
				({kind} = fetcher.peek())
			}
		}
		return hItems
	}

	debugger
	return parseObj()
}

// ---------------------------------------------------------------------------

export const getPrimitive = (
		str: string,
		): unknown => {

	str = str.trim()
	let ref2;if ((ref2 = str.match(/^\.(.*)\.$/))) {const lMatches = ref2;
		const s = lMatches[1].trim()
		if(s === 'undef') { return undef}
else if(s === 'null') { return null}
else if(s === 'true') { return true}
else if(s === 'false') { return false}
else if(s === 'NaN') { return NaN}
else if(s === 'infinity') { return Infinity}
else if(s === 'neginfinity') { return -Infinity}
else if(s === 'symbol') { return Symbol()}
else if(s === '[]') { return []}
else if(s === '{}') { return {}}
else if(typeof s === 'string' && /^symbol\s+(.+)$/.test(s)) {
				const lMatches = s.match(/^symbol\s+(.+)$/)
				if (defined(lMatches)) {
					const name = lMatches[1]
					return Symbol(name)
				}
				else {
					return Symbol()
				}}
else if(typeof s === 'string' && /^regexp\s+(.+)$/.test(s)) {
				const lMatches = s.match(/^regexp\s+(.+)$/)
				if (defined(lMatches)) {
					const name = lMatches[1]
					return new RegExp(name)
				}
				else {
					return new RegExp('^$')
				}}
else  {
				croak("Not Implemented")
			}
	}
	else if (str.match(/^\d+$/)) {
		return parseInt(str, 10)
	}
	else if (str.match(/^\d+\.\d*$/)) {
		return parseFloat(str)
	}
	else {
		return unescapeStr(str, o`purpose=C`)
	}
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFxmcm9tLW5pY2UubGliLmNpdmV0LnRzeCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFxmcm9tLW5pY2UubGliLmNpdmV0Il0sIm1hcHBpbmdzIjoiO0FBQUEsc0JBQXFCO0FBQ3JCLEFBQUE7QUFDQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZO0FBQ3hDLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3pELENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsY0FBYyxDQUFDO0FBQzFELENBQUMsT0FBTyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDOUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxVQUFVLENBQUM7QUFDckMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUM7QUFDbEMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVc7QUFDbkIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxXQUFXLENBQUM7QUFDcEMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDbEMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVM7QUFDakIsQUFBQSxBQUFBLE1B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QUFBLENBQUEsQ0FBQTtBQUNoQyxBQUFBLEVBQUUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLEM7Q0FBQyxDQUFBO0FBQ3hCLEFBQUEsQ0FBQyxJQUFJLENBQUEsQ0FBQTtBQUNMLEFBQUEsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEMsV0FBWSxDO0NBQUMsQztBQUFBLENBQUE7QUFDdkMiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgZnJvbS1uaWNlLmxpYi5jaXZldFxyXG5cclxuaW1wb3J0IHtzZXAsIGNlbnRlcmVkfSBmcm9tICdiYXNlLXV0aWxzJ1xyXG5pbXBvcnQge1xyXG5cdHVuZGVmLCBkZWZpbmVkLCBub3RkZWZpbmVkLCBhc3NlcnQsIGNyb2FrLCBoYXNoLCBoYXNob2YsXHJcblx0aXNBcnJheSwgaXNGdW5jdGlvbiwgaXNCb29sZWFuLCBpc1N0cmluZywgaXNOb25QcmltaXRpdmUsXHJcblx0aXNDbGFzcywgaXNBcnJheU9mU3RyaW5ncywgaXNFbXB0eSwgbm9uRW1wdHksXHJcblx0Y2xhc3NOYW1lLCBmdW5jdGlvbk5hbWUsIHN5bWJvbE5hbWUsXHJcblx0Y2xhc3NEZWYsIGZ1bmN0aW9uRGVmLCByZWdleHBEZWYsXHJcblx0fSBmcm9tICdkYXRhdHlwZXMnXHJcbmltcG9ydCB7XHJcblx0Z2V0T3B0aW9ucywgZXNjYXBlU3RyLCB1bmVzY2FwZVN0cixcclxuXHRrZXlzLCB0b0Jsb2NrLCBvLCBydHJpbSwgRmV0Y2hlcixcclxuXHR9IGZyb20gJ2xsdXRpbHMnXHJcbmltcG9ydCB7T0x9IGZyb20gJ3RvLW5pY2UnXHJcbmltcG9ydCB7aW5kZW50ZWR9IGZyb20gJ2luZGVudCdcclxuaW1wb3J0IHt0b05pY2V9IGZyb20gJ3RvLW5pY2UnXHJcbmltcG9ydCB7XHJcblx0VFBMTFRva2VuLCB0a0VPRiwgdGtJbmRlbnQsIHRrVW5kZW50LFxyXG5cdFRUb2tlbkdlbmVyYXRvciwgYWxsVG9rZW5zSW5CbG9jayxcclxuXHR9IGZyb20gJ3BsbCdcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgbmljZVNwbGl0dGVyOiBUVG9rZW5HZW5lcmF0b3IgOj0gKFxyXG5cdFx0c3RyOiBzdHJpbmdcclxuXHRcdCkgLT5cclxuXHRpZiBsZXQgbE1hdGNoZXMgPSBzdHIubWF0Y2goLy8vXlxyXG5cdFx0XHQtXHJcblx0XHRcdCguKilcclxuXHRcdFx0JC8vLylcclxuXHRcdHRhaWwgOj0gbE1hdGNoZXNbMV0udHJpbSgpXHJcblx0XHRpZiB0YWlsXHJcblx0XHRcdHlpZWxkIHtcclxuXHRcdFx0XHRraW5kOiAnbGlzdC1pdGVtJ1xyXG5cdFx0XHRcdHN0clxyXG5cdFx0XHRcdHZhbHVlOiBnZXRQcmltaXRpdmUodGFpbClcclxuXHRcdFx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHRcdHlpZWxkIHtcclxuXHRcdFx0XHRraW5kOiAnbGlzdC1oZWFkJ1xyXG5cdFx0XHRcdG5hbWU6IHN0clxyXG5cdFx0XHRcdHN0cjogJydcclxuXHRcdFx0XHR9XHJcblx0ZWxzZSBpZiBsZXQgbE1hdGNoZXMgPSBzdHIubWF0Y2goLy8vXlxyXG5cdFx0XHQoW0EtWmEtel1bQS1aYS16MC05X10qKVxyXG5cdFx0XHQ6XHJcblx0XHRcdCguKilcclxuXHRcdFx0JC8vLylcclxuXHRcdG5hbWUgOj0gbE1hdGNoZXNbMV1cclxuXHRcdHRhaWwgOj0gbE1hdGNoZXNbMl0udHJpbSgpXHJcblx0XHRpZiB0YWlsXHJcblx0XHRcdHlpZWxkIHtcclxuXHRcdFx0XHRraW5kOiAnaGFzaC1pdGVtJ1xyXG5cdFx0XHRcdHN0clxyXG5cdFx0XHRcdG5hbWVcclxuXHRcdFx0XHR2YWx1ZTogZ2V0UHJpbWl0aXZlKHRhaWwpXHJcblx0XHRcdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0XHR5aWVsZCB7XHJcblx0XHRcdFx0a2luZDogJ2hhc2gtaGVhZCdcclxuXHRcdFx0XHRuYW1lXHJcblx0XHRcdFx0c3RyXHJcblx0XHRcdFx0fVxyXG5cdGVsc2VcclxuXHRcdHlpZWxkIHtcclxuXHRcdFx0a2luZDogJ3ByaW1pdGl2ZSdcclxuXHRcdFx0c3RyXHJcblx0XHRcdHZhbHVlOiBnZXRQcmltaXRpdmUoc3RyKVxyXG5cdFx0XHR9XHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGFsbE5pY2VUb2tlbnMgOj0gKFxyXG5cdFx0YmxvY2s6IHN0cmluZyxcclxuXHRcdCk6IEdlbmVyYXRvcjxUUExMVG9rZW4sIHZvaWQsIHZvaWQ+IC0+XHJcblxyXG5cdGZvciBoIG9mIGFsbFRva2Vuc0luQmxvY2soYmxvY2ssIG5pY2VTcGxpdHRlcilcclxuXHRcdHlpZWxkIGhcclxuXHRyZXR1cm5cclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgZnJvbU5pY2UgOj0gKFxyXG5cdFx0c3RyOiBzdHJpbmcsXHJcblx0XHQpOiB1bmtub3duID0+XHJcblxyXG5cdCMgLS0tIENyZWF0ZSBhIEZldGNoZXIsIHRoZW4gdXNlXHJcblx0IyAgICAgcmVjdXJzaXZlIGRlc2NlbnQgcGFyc2luZ1xyXG5cclxuXHRmZXRjaGVyIDo9IG5ldyBGZXRjaGVyPFRQTExUb2tlbj4oYWxsTmljZVRva2VucyhzdHIpLCB0a0VPRilcclxuXHJcblx0cGFyc2VPYmogOj0gKCk6IHVua25vd24gPT5cclxuXHRcdHtraW5kLCBzdHJ9IDo9IGZldGNoZXIucGVlaygpXHJcblx0XHRzd2l0Y2gga2luZFxyXG5cdFx0XHQnbGlzdC1pdGVtJywgJ2xpc3QtaGVhZCdcclxuXHRcdFx0XHRyZXR1cm4gcGFyc2VMaXN0KClcclxuXHRcdFx0J2hhc2gtaXRlbScsICdoYXNoLWhlYWQnXHJcblx0XHRcdFx0cmV0dXJuIHBhcnNlSGFzaCgpXHJcblx0XHRcdCdlb2YnXHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRmZXRjaGVyLnNraXAoKVxyXG5cdFx0XHRcdGlmIGRlZmluZWQoc3RyKVxyXG5cdFx0XHRcdFx0cmV0dXJuIGdldFByaW1pdGl2ZShzdHIpXHJcblxyXG5cdHBhcnNlTGlzdCA6PSAoKTogdW5rbm93bltdID0+XHJcblx0XHRsSXRlbXM6IHVua25vd25bXSA6PSBbXVxyXG5cdFx0bGV0IHtraW5kfSA9IGZldGNoZXIucGVlaygpXHJcblx0XHR3aGlsZSBbJ2xpc3QtaXRlbScsICdsaXN0LWhlYWQnXS5pbmNsdWRlcyBraW5kXHJcblx0XHRcdGlmIChraW5kID09ICdsaXN0LWhlYWQnKVxyXG5cdFx0XHRcdGxJdGVtcy5wdXNoIHBhcnNlTGlzdE5lc3QoKVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0bEl0ZW1zLnB1c2ggZmV0Y2hlci5nZXQoKS52YWx1ZVxyXG5cdFx0XHRraW5kID0gZmV0Y2hlci5wZWVrKCkua2luZFxyXG5cdFx0cmV0dXJuIGxJdGVtc1xyXG5cclxuXHRwYXJzZUxpc3ROZXN0IDo9ICgpOiB1bmtub3duW10gPT5cclxuXHRcdGZldGNoZXIuZ2V0KHtraW5kOiAnbGlzdC1oZWFkJywgc3RyOiAnJ30pXHJcblx0XHRmZXRjaGVyLmdldCh7a2luZDogJ2luZGVudCcsIHN0cjogJyd9KVxyXG5cdFx0dmFsdWUgOj0gcGFyc2VPYmooKVxyXG5cdFx0ZmV0Y2hlci5nZXQoe2tpbmQ6ICd1bmRlbnQnLCBzdHI6ICcnfSlcclxuXHRcdHJldHVybiBbdmFsdWVdXHJcblxyXG5cdHBhcnNlSGFzaCA6PSAoKTogaGFzaCA9PlxyXG5cdFx0aEl0ZW1zOiBoYXNoIDo9IHt9XHJcblx0XHRsZXQge2tpbmQsIG5hbWV9ID0gZmV0Y2hlci5wZWVrKClcclxuXHRcdGlmIChraW5kID09ICdoYXNoLWhlYWQnKVxyXG5cdFx0XHRmZXRjaGVyLnNraXAoKVxyXG5cdFx0XHRmZXRjaGVyLmdldCh7a2luZDogJ2luZGVudCcsIHN0cjogJyd9KVxyXG5cdFx0XHR2YWx1ZSA6PSBwYXJzZU9iaigpXHJcblx0XHRcdGlmIGRlZmluZWQobmFtZSlcclxuXHRcdFx0XHRoSXRlbXNbbmFtZV0gPSB2YWx1ZVxyXG5cdFx0XHRmZXRjaGVyLmdldCh7a2luZDogJ3VuZGVudCcsIHN0cjogJyd9KVxyXG5cdFx0ZWxzZVxyXG5cdFx0XHR3aGlsZSAoa2luZCA9PSAnaGFzaC1pdGVtJylcclxuXHRcdFx0XHR7bmFtZSwgdmFsdWV9IDo9IGZldGNoZXIuZ2V0KClcclxuXHRcdFx0XHRpZiBkZWZpbmVkKG5hbWUpXHJcblx0XHRcdFx0XHRoSXRlbXNbbmFtZV0gPSB2YWx1ZVxyXG5cdFx0XHRcdHtraW5kfSA9IGZldGNoZXIucGVlaygpXHJcblx0XHRyZXR1cm4gaEl0ZW1zXHJcblxyXG5cdGRlYnVnZ2VyXHJcblx0cmV0dXJuIHBhcnNlT2JqKClcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgZ2V0UHJpbWl0aXZlIDo9IChcclxuXHRcdHN0cjogc3RyaW5nLFxyXG5cdFx0KTogdW5rbm93biA9PlxyXG5cclxuXHRzdHIgPSBzdHIudHJpbSgpXHJcblx0aWYgbE1hdGNoZXMgOj0gc3RyLm1hdGNoKC9eXFwuKC4qKVxcLiQvKVxyXG5cdFx0cyA6PSBsTWF0Y2hlc1sxXS50cmltKClcclxuXHRcdHN3aXRjaCBzXHJcblx0XHRcdCd1bmRlZicgICAgICAgdGhlbiByZXR1cm4gdW5kZWZcclxuXHRcdFx0J251bGwnICAgICAgICB0aGVuIHJldHVybiBudWxsXHJcblx0XHRcdCd0cnVlJyAgICAgICAgdGhlbiByZXR1cm4gdHJ1ZVxyXG5cdFx0XHQnZmFsc2UnICAgICAgIHRoZW4gcmV0dXJuIGZhbHNlXHJcblx0XHRcdCdOYU4nICAgICAgICAgdGhlbiByZXR1cm4gTmFOXHJcblx0XHRcdCdpbmZpbml0eScgICAgdGhlbiByZXR1cm4gSW5maW5pdHlcclxuXHRcdFx0J25lZ2luZmluaXR5JyB0aGVuIHJldHVybiAtSW5maW5pdHlcclxuXHRcdFx0J3N5bWJvbCcgICAgICB0aGVuIHJldHVybiBTeW1ib2woKVxyXG5cdFx0XHQnW10nICAgICAgICAgIHRoZW4gcmV0dXJuIFtdXHJcblx0XHRcdCd7fScgICAgICAgICAgdGhlbiByZXR1cm4ge31cclxuXHRcdFx0L15zeW1ib2xcXHMrKC4rKSQvXHJcblx0XHRcdFx0bE1hdGNoZXMgOj0gcy5tYXRjaCgvXnN5bWJvbFxccysoLispJC8pXHJcblx0XHRcdFx0aWYgZGVmaW5lZChsTWF0Y2hlcylcclxuXHRcdFx0XHRcdG5hbWUgOj0gbE1hdGNoZXNbMV1cclxuXHRcdFx0XHRcdHJldHVybiBTeW1ib2wobmFtZSlcclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRyZXR1cm4gU3ltYm9sKClcclxuXHRcdFx0L15yZWdleHBcXHMrKC4rKSQvXHJcblx0XHRcdFx0bE1hdGNoZXMgOj0gcy5tYXRjaCgvXnJlZ2V4cFxccysoLispJC8pXHJcblx0XHRcdFx0aWYgZGVmaW5lZChsTWF0Y2hlcylcclxuXHRcdFx0XHRcdG5hbWUgOj0gbE1hdGNoZXNbMV1cclxuXHRcdFx0XHRcdHJldHVybiBuZXcgUmVnRXhwKG5hbWUpXHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0cmV0dXJuIG5ldyBSZWdFeHAoJ14kJylcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdGNyb2FrIFwiTm90IEltcGxlbWVudGVkXCJcclxuXHRlbHNlIGlmIHN0ci5tYXRjaCgvXlxcZCskLylcclxuXHRcdHJldHVybiBwYXJzZUludChzdHIsIDEwKVxyXG5cdGVsc2UgaWYgc3RyLm1hdGNoKC9eXFxkK1xcLlxcZCokLylcclxuXHRcdHJldHVybiBwYXJzZUZsb2F0KHN0cilcclxuXHRlbHNlXHJcblx0XHRyZXR1cm4gdW5lc2NhcGVTdHIoc3RyLCBvJ3B1cnBvc2U9QycpXHJcbiJdfQ==