"use strict";
// datatypes.civet

/**
 * @module datatypes - TypeScript datatype checking
 */

/**
 * An alias for TypeScript type 'object' with string keys
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,hash)
 */

export interface hash {
	[key: string | symbol]: any
}

/**
 * An array containing anything
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,array)
 */

export type array = any[]

/**
 * A function that takes no parameters and returns nothing
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,voidFunc)
 */

export type voidFunc = () => void

/**
 * specifying options for function getOptions()
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,optionspec)
 */

export type optionspec = hash | string

// ---------------------------------------------------------------------------

/**
 * An alias for JavaScript's `undefined`
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,undef)
 */

export const undef = undefined

// ---------------------------------------------------------------------------

/**
 * returns true if the provided value is defined
 * (i.e. not null or undefined), else returns false
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,defined)
 */

export const defined = (x: any): boolean => {

	return (x !== undef) && (x !== null)
}

// ---------------------------------------------------------------------------

/**
 * Returns true if all the values provided are not defined
 * (i.e. either null or undefined), else returns false
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,notdefined)
 */

export const notdefined = (x: any): x is undefined => {

	return (x === undefined) || (x === null)
}

// ---------------------------------------------------------------------------

/**
 * returns true if (typeof item == 'string') or item instanceof String
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isString)
 */

export const isString = (x: any): x is string => {

	return (typeof x === 'string') || (x instanceof String)
}

// ---------------------------------------------------------------------------

/**
 * Test if something is a non-empty string,
 * i.e. isn't all whitespace
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isNonEmptyString)
 */

export const isNonEmptyString = (x: any): boolean => {

	// --- must contain non-whitespace character
	return isString(x) && defined(x.match(/\S/))
}

// ---------------------------------------------------------------------------

/**
 * Test if something is a boolean
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isBoolean)
 */

export const isBoolean = (x: any): x is boolean => {

	return (typeof x === 'boolean') || (x instanceof Boolean)
}

// ---------------------------------------------------------------------------

/**
 * Test if something is a number
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isNumber)
 */

export const isNumber = (x: any): x is number => {

	const type = typeof x
	return (type === 'bigint') || (type === 'number') || (x instanceof Number)
}

// ---------------------------------------------------------------------------

/**
 * Type integer
 */

export type integer = number

/**
 * Test if something is an integer
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isInteger)
 */

export const isInteger = (x: any): x is integer => {

	return isNumber(x) && Number.isInteger(x.valueOf())
}

// ---------------------------------------------------------------------------

/**
 * Test if something is an array
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isArray)
 */

export const isArray = (x: any): x is array => {

	return Array.isArray(x)
}

// ---------------------------------------------------------------------------

/**
 * Test if something is an array of strings
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isArrayOfStrings)
 */

export const isArrayOfStrings = (x: any): boolean => {

	if (!Array.isArray(x)) {
		return false
	}
	for (const item of x) {
		if (!isString(item)) {
			return false
		}
	}
	return true
}

// ---------------------------------------------------------------------------

/**
 * Type regexp - a regular expression
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,regexp)
 */

type regexp = object

/**
 * Test if something is a regular expression
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isRegExp)
 */

export const isRegExp = (item: any): item is regexp => {

	return (item instanceof RegExp)
}

// ---------------------------------------------------------------------------

/**
 * Test if something is an object
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isObject)
 */

export const isObject = (item: any): item is object => {

	return (typeof item === 'object')
}

// ---------------------------------------------------------------------------

/**
 * Test if something is a hash
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isHash)
 */

export const isHash = (item: any): item is hash => {

	return isObject(item) && !(isArray(item) || isRegExp(item))
}

// ---------------------------------------------------------------------------

/**
 * returns true if any of these is true:
 * 	- x is null or undef
 * 	- x is a string consisting of only whitespace
 * 	- x is an array of length 0
 * 	- x is a hash that has no keys
 * else returns false
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,isEmpty)
 */

export const isEmpty = (x: any): boolean => {

	if ((x === undef) || (x === null)) {
		return true
	}
	if (isString(x)) {
		return (x.match(/^\s*$/) !== null)
	}
	if (isArray(x)) {
		return (x.length === 0)
	}
	if (isHash(x)) {
		return (Object.keys(x).length === 0)
	}
	else {
		return false
	}
}

// ---------------------------------------------------------------------------

/**
 * returns not isEmpty(x)
 * [unit tests](../test/datatypes.test.civet#:~:text=DBG,nonEmpty)
 */

export const nonEmpty = (x: any): boolean => {

	return !isEmpty(x)
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9kYXRhdHlwZXMuY2l2ZXQudHN4Iiwic291cmNlcyI6WyJzcmMvbGliL2RhdGF0eXBlcy5jaXZldCJdLCJtYXBwaW5ncyI6IjtBQUFBLGtCQUFpQjtBQUNqQixBQUFBO0FBQ0EsQUFBQTtBQUNBO0FBQ0EsR0FBRztBQUNILEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQSxDQUFBO0FBQ3JCLEFBQUEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHO0FBQUcsQ0FBQTtBQUM1QixBQUFBO0FBQ0EsQUFBQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDekIsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJO0FBQ2pDLEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU07QUFDdEMsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBTSxNQUFMLEtBQUssQ0FBQyxDQUFFLENBQUMsU0FBUztBQUN6QixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVEsTUFBUCxPQUFPLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDdEMsQUFBQTtBQUNBLEFBQUEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFFLENBQUMsSUFBSSxDO0FBQUMsQ0FBQTtBQUNuQyxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVcsTUFBVixVQUFVLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNoRCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUUsQ0FBQyxJQUFJLEM7QUFBQyxDQUFBO0FBQ3ZDLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVMsTUFBUixRQUFRLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUMzQyxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDO0FBQUMsQ0FBQTtBQUN2RCxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQWlCLE1BQWhCLGdCQUFnQixDQUFDLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQy9DLEFBQUE7QUFDQSxBQUFBLENBQUMsNENBQTJDO0FBQzVDLEFBQUEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQztBQUFDLENBQUE7QUFDN0MsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBVSxNQUFULFNBQVMsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQzdDLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxPQUFPLEM7QUFBQyxDQUFBO0FBQ3pELEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVMsTUFBUixRQUFRLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUMzQyxBQUFBO0FBQ0EsQUFBQSxDQUFLLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNqQixBQUFBLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDO0FBQUMsQ0FBQTtBQUN6RSxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNO0FBQzVCLEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBVSxNQUFULFNBQVMsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQzdDLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQztBQUFDLENBQUE7QUFDcEQsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBUSxNQUFQLE9BQU8sQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3pDLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDO0FBQUMsQ0FBQTtBQUN4QixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFpQixNQUFoQixnQkFBZ0IsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUMvQyxBQUFBO0FBQ0EsQUFBQSxDQUFDLEdBQUcsQ0FBQSxDQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQ3hCLEFBQUEsRUFBRSxNQUFNLENBQUMsSztDQUFLLENBQUE7QUFDZCxBQUFBLENBQUMsR0FBRyxDQUFDLENBQUEsTUFBQSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDZCxBQUFBLEVBQUUsR0FBRyxDQUFBLENBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUN2QixBQUFBLEdBQUcsTUFBTSxDQUFDLEs7RUFBSyxDO0NBQUEsQ0FBQTtBQUNmLEFBQUEsQ0FBQyxNQUFNLENBQUMsSTtBQUFJLENBQUE7QUFDWixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEFBQUE7QUFDQSxBQUFBLEFBQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTTtBQUNwQixBQUFBO0FBQ0EsQUFBQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVMsTUFBUixRQUFRLENBQUMsQ0FBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNqRCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDO0FBQUMsQ0FBQTtBQUNoQyxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFTLE1BQVIsUUFBUSxDQUFDLENBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDakQsQUFBQTtBQUNBLEFBQUEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUUsQ0FBQyxRQUFRLEM7QUFBQyxDQUFBO0FBQ2pDLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQU8sTUFBTixNQUFNLENBQUMsQ0FBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUM3QyxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQztBQUFDLENBQUE7QUFDL0QsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVEsTUFBUCxPQUFPLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDdEMsQUFBQTtBQUNBLEFBQUEsQ0FBQyxHQUFHLENBQUEsQ0FBQyxDQUFDLENBQUMsR0FBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFFLENBQUMsSUFBSSxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQy9CLEFBQUEsRUFBRSxNQUFNLENBQUMsSTtDQUFJLENBQUE7QUFDYixBQUFBLENBQUMsR0FBRyxDQUFBLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDZixBQUFBLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFFLENBQUMsSUFBSSxDO0NBQUMsQ0FBQTtBQUNuQyxBQUFBLENBQUMsR0FBRyxDQUFBLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDZCxBQUFBLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFFLENBQUMsQ0FBQyxDO0NBQUMsQ0FBQTtBQUN4QixBQUFBLENBQUMsR0FBRyxDQUFBLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDYixBQUFBLEVBQUUsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRSxDQUFDLENBQUMsQztDQUFDLENBQUE7QUFDckMsQUFBQSxDQUFDLElBQUksQ0FBQSxDQUFBO0FBQ0wsQUFBQSxFQUFFLE1BQU0sQ0FBQyxLO0NBQUssQztBQUFBLENBQUE7QUFDZCxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFTLE1BQVIsUUFBUSxDQUFDLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZDLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFDLENBQUksT0FBTyxDQUFDLENBQUMsQztBQUFDLENBQUE7QUFDdEIiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgZGF0YXR5cGVzLmNpdmV0XG5cbi8qKlxuICogQG1vZHVsZSBkYXRhdHlwZXMgLSBUeXBlU2NyaXB0IGRhdGF0eXBlIGNoZWNraW5nXG4gKi9cblxuLyoqXG4gKiBBbiBhbGlhcyBmb3IgVHlwZVNjcmlwdCB0eXBlICdvYmplY3QnIHdpdGggc3RyaW5nIGtleXNcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLGhhc2gpXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBoYXNoXG5cdFtrZXk6IHN0cmluZyB8IHN5bWJvbF06IGFueVxuXG4vKipcbiAqIEFuIGFycmF5IGNvbnRhaW5pbmcgYW55dGhpbmdcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLGFycmF5KVxuICovXG5cbmV4cG9ydCB0eXBlIGFycmF5ID0gYW55W11cblxuLyoqXG4gKiBBIGZ1bmN0aW9uIHRoYXQgdGFrZXMgbm8gcGFyYW1ldGVycyBhbmQgcmV0dXJucyBub3RoaW5nXG4gKiBbdW5pdCB0ZXN0c10oLi4vdGVzdC9kYXRhdHlwZXMudGVzdC5jaXZldCM6fjp0ZXh0PURCRyx2b2lkRnVuYylcbiAqL1xuXG5leHBvcnQgdHlwZSB2b2lkRnVuYyA9ICgpID0+IHZvaWRcblxuLyoqXG4gKiBzcGVjaWZ5aW5nIG9wdGlvbnMgZm9yIGZ1bmN0aW9uIGdldE9wdGlvbnMoKVxuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsb3B0aW9uc3BlYylcbiAqL1xuXG5leHBvcnQgdHlwZSBvcHRpb25zcGVjID0gaGFzaCB8IHN0cmluZ1xuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vKipcbiAqIEFuIGFsaWFzIGZvciBKYXZhU2NyaXB0J3MgYHVuZGVmaW5lZGBcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLHVuZGVmKVxuICovXG5cbmV4cG9ydCB1bmRlZiA6PSB1bmRlZmluZWRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiByZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHZhbHVlIGlzIGRlZmluZWRcbiAqIChpLmUuIG5vdCBudWxsIG9yIHVuZGVmaW5lZCksIGVsc2UgcmV0dXJucyBmYWxzZVxuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsZGVmaW5lZClcbiAqL1xuXG5leHBvcnQgZGVmaW5lZCA6PSAoeDogYW55KTogYm9vbGVhbiA9PlxuXG5cdHJldHVybiAoeCAhPSB1bmRlZikgJiYgKHggIT0gbnVsbClcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYWxsIHRoZSB2YWx1ZXMgcHJvdmlkZWQgYXJlIG5vdCBkZWZpbmVkXG4gKiAoaS5lLiBlaXRoZXIgbnVsbCBvciB1bmRlZmluZWQpLCBlbHNlIHJldHVybnMgZmFsc2VcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLG5vdGRlZmluZWQpXG4gKi9cblxuZXhwb3J0IG5vdGRlZmluZWQgOj0gKHg6IGFueSk6IHggaXMgdW5kZWZpbmVkID0+XG5cblx0cmV0dXJuICh4ID09IHVuZGVmaW5lZCkgfHwgKHggPT0gbnVsbClcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiByZXR1cm5zIHRydWUgaWYgKHR5cGVvZiBpdGVtID09ICdzdHJpbmcnKSBvciBpdGVtIGluc3RhbmNlb2YgU3RyaW5nXG4gKiBbdW5pdCB0ZXN0c10oLi4vdGVzdC9kYXRhdHlwZXMudGVzdC5jaXZldCM6fjp0ZXh0PURCRyxpc1N0cmluZylcbiAqL1xuXG5leHBvcnQgaXNTdHJpbmcgOj0gKHg6IGFueSk6IHggaXMgc3RyaW5nID0+XG5cblx0cmV0dXJuICh0eXBlb2YgeCA9PSAnc3RyaW5nJykgfHwgKHggaW5zdGFuY2VvZiBTdHJpbmcpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogVGVzdCBpZiBzb21ldGhpbmcgaXMgYSBub24tZW1wdHkgc3RyaW5nLFxuICogaS5lLiBpc24ndCBhbGwgd2hpdGVzcGFjZVxuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsaXNOb25FbXB0eVN0cmluZylcbiAqL1xuXG5leHBvcnQgaXNOb25FbXB0eVN0cmluZyA6PSAoeDogYW55KTogYm9vbGVhbiA9PlxuXG5cdCMgLS0tIG11c3QgY29udGFpbiBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXJcblx0cmV0dXJuIGlzU3RyaW5nKHgpICYmIGRlZmluZWQoeC5tYXRjaCgvXFxTLykpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogVGVzdCBpZiBzb21ldGhpbmcgaXMgYSBib29sZWFuXG4gKiBbdW5pdCB0ZXN0c10oLi4vdGVzdC9kYXRhdHlwZXMudGVzdC5jaXZldCM6fjp0ZXh0PURCRyxpc0Jvb2xlYW4pXG4gKi9cblxuZXhwb3J0IGlzQm9vbGVhbiA6PSAoeDogYW55KTogeCBpcyBib29sZWFuID0+XG5cblx0cmV0dXJuICh0eXBlb2YgeCA9PSAnYm9vbGVhbicpIHx8ICh4IGluc3RhbmNlb2YgQm9vbGVhbilcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiBUZXN0IGlmIHNvbWV0aGluZyBpcyBhIG51bWJlclxuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsaXNOdW1iZXIpXG4gKi9cblxuZXhwb3J0IGlzTnVtYmVyIDo9ICh4OiBhbnkpOiB4IGlzIG51bWJlciA9PlxuXG5cdHR5cGUgOj0gdHlwZW9mIHhcblx0cmV0dXJuICh0eXBlID09ICdiaWdpbnQnKSB8fCAodHlwZSA9PSAnbnVtYmVyJykgfHwgKHggaW5zdGFuY2VvZiBOdW1iZXIpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogVHlwZSBpbnRlZ2VyXG4gKi9cblxuZXhwb3J0IHR5cGUgaW50ZWdlciA9IG51bWJlclxuXG4vKipcbiAqIFRlc3QgaWYgc29tZXRoaW5nIGlzIGFuIGludGVnZXJcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLGlzSW50ZWdlcilcbiAqL1xuXG5leHBvcnQgaXNJbnRlZ2VyIDo9ICh4OiBhbnkpOiB4IGlzIGludGVnZXIgPT5cblxuXHRyZXR1cm4gaXNOdW1iZXIoeCkgJiYgTnVtYmVyLmlzSW50ZWdlcih4LnZhbHVlT2YoKSlcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiBUZXN0IGlmIHNvbWV0aGluZyBpcyBhbiBhcnJheVxuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsaXNBcnJheSlcbiAqL1xuXG5leHBvcnQgaXNBcnJheSA6PSAoeDogYW55KTogeCBpcyBhcnJheSA9PlxuXG5cdHJldHVybiBBcnJheS5pc0FycmF5KHgpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogVGVzdCBpZiBzb21ldGhpbmcgaXMgYW4gYXJyYXkgb2Ygc3RyaW5nc1xuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsaXNBcnJheU9mU3RyaW5ncylcbiAqL1xuXG5leHBvcnQgaXNBcnJheU9mU3RyaW5ncyA6PSAoeDogYW55KTogYm9vbGVhbiA9PlxuXG5cdGlmIG5vdCBBcnJheS5pc0FycmF5KHgpXG5cdFx0cmV0dXJuIGZhbHNlXG5cdGZvciBpdGVtIG9mIHhcblx0XHRpZiBub3QgaXNTdHJpbmcoaXRlbSlcblx0XHRcdHJldHVybiBmYWxzZVxuXHRyZXR1cm4gdHJ1ZVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vKipcbiAqIFR5cGUgcmVnZXhwIC0gYSByZWd1bGFyIGV4cHJlc3Npb25cbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLHJlZ2V4cClcbiAqL1xuXG50eXBlIHJlZ2V4cCA9IG9iamVjdFxuXG4vKipcbiAqIFRlc3QgaWYgc29tZXRoaW5nIGlzIGEgcmVndWxhciBleHByZXNzaW9uXG4gKiBbdW5pdCB0ZXN0c10oLi4vdGVzdC9kYXRhdHlwZXMudGVzdC5jaXZldCM6fjp0ZXh0PURCRyxpc1JlZ0V4cClcbiAqL1xuXG5leHBvcnQgaXNSZWdFeHAgOj0gKGl0ZW06IGFueSk6IGl0ZW0gaXMgcmVnZXhwID0+XG5cblx0cmV0dXJuIChpdGVtIGluc3RhbmNlb2YgUmVnRXhwKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vKipcbiAqIFRlc3QgaWYgc29tZXRoaW5nIGlzIGFuIG9iamVjdFxuICogW3VuaXQgdGVzdHNdKC4uL3Rlc3QvZGF0YXR5cGVzLnRlc3QuY2l2ZXQjOn46dGV4dD1EQkcsaXNPYmplY3QpXG4gKi9cblxuZXhwb3J0IGlzT2JqZWN0IDo9IChpdGVtOiBhbnkpOiBpdGVtIGlzIG9iamVjdCA9PlxuXG5cdHJldHVybiAodHlwZW9mIGl0ZW0gPT0gJ29iamVjdCcpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogVGVzdCBpZiBzb21ldGhpbmcgaXMgYSBoYXNoXG4gKiBbdW5pdCB0ZXN0c10oLi4vdGVzdC9kYXRhdHlwZXMudGVzdC5jaXZldCM6fjp0ZXh0PURCRyxpc0hhc2gpXG4gKi9cblxuZXhwb3J0IGlzSGFzaCA6PSAoaXRlbTogYW55KTogaXRlbSBpcyBoYXNoID0+XG5cblx0cmV0dXJuIGlzT2JqZWN0KGl0ZW0pICYmIG5vdCAoaXNBcnJheShpdGVtKSB8fCBpc1JlZ0V4cChpdGVtKSlcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiByZXR1cm5zIHRydWUgaWYgYW55IG9mIHRoZXNlIGlzIHRydWU6XG4gKiBcdC0geCBpcyBudWxsIG9yIHVuZGVmXG4gKiBcdC0geCBpcyBhIHN0cmluZyBjb25zaXN0aW5nIG9mIG9ubHkgd2hpdGVzcGFjZVxuICogXHQtIHggaXMgYW4gYXJyYXkgb2YgbGVuZ3RoIDBcbiAqIFx0LSB4IGlzIGEgaGFzaCB0aGF0IGhhcyBubyBrZXlzXG4gKiBlbHNlIHJldHVybnMgZmFsc2VcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLGlzRW1wdHkpXG4gKi9cblxuZXhwb3J0IGlzRW1wdHkgOj0gKHg6IGFueSk6IGJvb2xlYW4gPT5cblxuXHRpZiAoeCA9PSB1bmRlZikgfHwgKHggPT0gbnVsbClcblx0XHRyZXR1cm4gdHJ1ZVxuXHRpZiBpc1N0cmluZyh4KVxuXHRcdHJldHVybiAoeC5tYXRjaCgvXlxccyokLykgIT0gbnVsbClcblx0aWYgaXNBcnJheSh4KVxuXHRcdHJldHVybiAoeC5sZW5ndGggPT0gMClcblx0aWYgaXNIYXNoKHgpXG5cdFx0cmV0dXJuIChPYmplY3Qua2V5cyh4KS5sZW5ndGggPT0gMClcblx0ZWxzZVxuXHRcdHJldHVybiBmYWxzZVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vKipcbiAqIHJldHVybnMgbm90IGlzRW1wdHkoeClcbiAqIFt1bml0IHRlc3RzXSguLi90ZXN0L2RhdGF0eXBlcy50ZXN0LmNpdmV0Izp+OnRleHQ9REJHLG5vbkVtcHR5KVxuICovXG5cbmV4cG9ydCBub25FbXB0eSA6PSAoeDogYW55KTogYm9vbGVhbiA9PlxuXG5cdHJldHVybiBub3QgaXNFbXB0eSh4KVxuIl19