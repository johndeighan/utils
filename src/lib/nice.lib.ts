"use strict";
// nice.civet

import {
	undef, defined, notdefined, assert, hash,
	isArray, isFunction, isBoolean, isString,
	jsType, className, functionName, symbolName,
	nonEmpty, functionDef, regexpDef,
	} from './datatypes.lib.ts'
import {
	getOptions, escapeStr, unescapeStr,
	keys, toBlock, o, OL, croak, rtrim, Fetcher,
	} from './llutils.lib.ts'
import {
	indented,
	} from './indent.lib.ts'
import {
	TPLLToken, tkEOF, tkIndent, tkUndent,
	TTokenGenerator, allTokensInBlock,
	} from './pll.lib.ts'

type TCompareFunc = (a: string, b: string) => number

// ---------------------------------------------------------------------------

const getCompareFunc = (lSortKeys: string[]): TCompareFunc => {

	// --- Convert to a function
	const h: hash = {}
	let i1 = 0;for (const key of lSortKeys) {const i = i1++;
		h[key] = i+1
	}

	return function(a: string, b: string): number {
		const aVal = h[a]
		const bVal = h[b]

		if (defined(aVal)) {
			if (defined(bVal)) {
				// --- compare numerically
				return (aVal < bVal) ? -1 : (aVal > bVal) ? 1 : 0
			}
			else {
				return -1
			}
		}
		else {
			if (defined(bVal)) {
				return 1
			}
			else {
				return (a < b) ? -1 : (a > b) ? 1 : 0
			}
		}
	}
}

// ---------------------------------------------------------------------------

export const toNice = (x: any, hOptions: hash={}): string => {

	// --- When strict, classes and function
	//     include their definitions, with escaped chars

	const {strict} = getOptions(hOptions, {
		strict: false
		})

	switch(jsType(x)) {
		case 'undef': {
			return '.undef.'
		}
		case 'null': {
			return '.null.'
		}
		case 'boolean': {
			return x ? '.true.' : '.false.'
		}
		case 'string': {
			if (needsPreEsc(x)) {
				return '\\' + escapeStr(x, o`style=C`)
			}
			else {
				return escapeStr(x, o`style=C`)
			}
		}
		case 'NaN': {
			return '.NaN.'
		}
		case 'infinity': {
			return '.infinity.'
		}
		case 'neginfinity': {
			return '.neginfinity.'
		}
		case 'number':case 'integer': {
			return x.toString()
		}
		case 'class': {
			const name = className(x)
			return name ? `.class ${name}.` : '.class.'
		}
		case 'function': {
			const name = functionName(x)
			return name ? `.function ${name}.` : ".function."
		}
		case 'symbol': {
			const name = symbolName(x)
			return name ? `.symbol ${name}.` : ".symbol."
		}
		case 'regexp': {
			const def = regexpDef(x)
			return def ? `.regexp ${def}.` : '.regexp.'
		}
		case 'array': {
			if (x.length === 0) {
				return '.[].'
			}
			const lLines = []
			for (const item of x) {
				const block = toNice(item, hOptions)
				if (shouldSplit(item)) {
					lLines.push('-')
					lLines.push(indented(block))
				}
				else {
					lLines.push(`- ${block}`)
				}
			}
			return toBlock(lLines)
		}

		case 'hash':case 'instance': {
			const {sortKeys} = getOptions(hOptions, {
				sortKeys: false    // --- can be boolean/array/function
				})

			const sortKeysFunc: TCompareFunc = (
				  isArray(sortKeys)    ? getCompareFunc(sortKeys)
				: isFunction(sortKeys) ? sortKeys
				:                        (a: string, b: string) => { return (a < b) ? -1 : (a > b) ? 1 : 0 }
				)

			const lKeys = Object.keys(x)
			if (lKeys.length === 0) {
				return '.{}.'
			}
			const lLines = []
			if (sortKeys === true) {
				lKeys.sort()
			}
			else if (sortKeys !== false) {
				lKeys.sort(sortKeysFunc)
			}
			for (const key of lKeys) {
				assert(isString(key), `key not a string: ${OL(key)}`)
				const val = x[key]
				const block = toNice(val, hOptions)
				if (shouldSplit(val)) {
					lLines.push(`${key}:`)
					lLines.push(indented(block))
				}
				else {
					lLines.push(`${key}: ${block}`)
				}
			}
			return toBlock(lLines)
		}
		default: {
			return `<Unknown object ${x}`
		}
	}
}

// ---------------------------------------------------------------------------

export const needsPreEsc = (str: string) => {

	// --- if it looks like an array item, it needs leading \
	if (str.match(/^-/)) {
		return true
	}

	// --- if it looks like a hash key, it needs leading \
	if (str.match(/^[A-Za-z][A-Za-z0-9_]*:/)) {
		return true
	}

	// --- if it looks like a number, it needs leading \
	if (str.match(/^\d+(?:\.\d*)?/)) {
		return true
	}

	// --- if it starts with a '.', it needs leading \
	if ((str.length > 0) && (str[0] === '.')) {
		return true
	}

	return false
}

// ---------------------------------------------------------------------------

const shouldSplit = (x: any): boolean => {

	return ['hash','array','class','instance'].includes(jsType(x))
}

// ---------------------------------------------------------------------------

export const niceSplitter: TTokenGenerator = function*(
		str: string
		) {
	let ref;let ref1;if ((ref = str.match(/^-(.*)$/))) {let lMatches = ref;
		const tail = lMatches[1].trim()
		if (tail) {
			yield {
				kind: 'list-item',
				str,
				value: getPrimitive(tail)
				}
		}
		else {
			yield {
				kind: 'list-head',
				name: str,
				str: ''
				}
		}
	}
	else if ((ref1 = str.match(/^([A-Za-z][A-Za-z0-9_]*):(.*)$/))) {let lMatches = ref1;
		const name = lMatches[1]
		const tail = lMatches[2].trim()
		if (tail) {
			yield {
				kind: 'hash-item',
				str,
				name,
				value: getPrimitive(tail)
				}
		}
		else {
			yield {
				kind: 'hash-head',
				name,
				str
				}
		}
	}
	else {
		yield {
			kind: 'primitive',
			str,
			value: getPrimitive(str)
			}
	}
}

// ---------------------------------------------------------------------------

export const allNiceTokens = function*(
		block: string,
		): Generator<TPLLToken, void, void> {

	for (const h of allTokensInBlock(block, niceSplitter)) {
		yield h
	}
	return
}

// ---------------------------------------------------------------------------

export const fromNice = (
		str: string,
		): any => {

	// --- Create a Fetcher, then use
	//     recursive descent parsing

	const fetcher = new Fetcher<TPLLToken>(allNiceTokens(str), tkEOF)

	const parseObj = (): any => {
		const {kind, str} = fetcher.peek()
		if(kind === 'list-item' || kind === 'list-head') {
				return parseList()}
else if(kind === 'hash-item' || kind === 'hash-head') {
				return parseHash()}
else if(kind === 'eof') {
				return undef}
else  {
				fetcher.skip()
				return getPrimitive(str)
			}
	}

	const parseList = (): any[] => {
		const lItems: any[] = []
		let {kind} = fetcher.peek()
		while (['list-item', 'list-head'].includes(kind)) {
			if (kind === 'list-head') {
				lItems.push(parseListNest())
			}
			else {
				lItems.push(fetcher.get().value)
			}
			kind = fetcher.peek().kind
		}
		return lItems
	}

	const parseListNest = (): any[] => {
		fetcher.get({kind: 'list-head', str: ''})
		fetcher.get({kind: 'indent', str: ''})
		const value = parseObj()
		fetcher.get({kind: 'undent', str: ''})
		return value
	}

	const parseHash = (): hash => {
		const hItems: hash = {}
		let {kind, name} = fetcher.peek()
		if (kind === 'hash-head') {
			fetcher.skip()
			fetcher.get({kind: 'indent', str: ''})
			const value = parseObj()
			if (defined(name)) {
				hItems[name] = value
			}
			fetcher.get({kind: 'undent', str: ''})
		}
		else {
			while (kind === 'hash-item') {
				const {name, value} = fetcher.get()
				if (defined(name)) {
					hItems[name] = value
				};
				({kind} = fetcher.peek())
			}
		}
		return hItems
	}

	debugger
	return parseObj()
}

// ---------------------------------------------------------------------------

export const getPrimitive = (
		str: string,
		): any => {

	str = str.trim()
	let ref2;if ((ref2 = str.match(/^\.(.*)\.$/))) {const lMatches = ref2;
		const s = lMatches[1].trim()
		if(s === 'undef') { return undef}
else if(s === 'null') { return null}
else if(s === 'true') { return true}
else if(s === 'false') { return false}
else if(s === 'NaN') { return NaN}
else if(s === 'infinity') { return Infinity}
else if(s === 'neginfinity') { return -Infinity}
else if(s === 'symbol') { return Symbol()}
else if(s === '[]') { return []}
else if(s === '{}') { return {}}
else if(typeof s === 'string' && /^symbol\s+(.+)$/.test(s)) {
				const lMatches = s.match(/^symbol\s+(.+)$/)
				if (defined(lMatches)) {
					const name = lMatches[1]
					return Symbol(name)
				}
				else {
					return Symbol()
				}}
else if(typeof s === 'string' && /^regexp\s+(.+)$/.test(s)) {
				const lMatches = s.match(/^regexp\s+(.+)$/)
				if (defined(lMatches)) {
					const name = lMatches[1]
					return new RegExp(name)
				}
				else {
					return new RegExp('^$')
				}}
else  {
				croak("Not Implemented")
			}
	}
	else if (str.match(/^\d+$/)) {
		return parseInt(str, 10)
	}
	else if (str.match(/^\d+\.\d*$/)) {
		return parseFloat(str)
	}
	else {
		return unescapeStr(str, o`purpose=C`)
	}
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9uaWNlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbInNyYy9saWIvbmljZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxhQUFZO0FBQ1osQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQztBQUMxQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztBQUMxQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLFVBQVUsQ0FBQztBQUM3QyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CO0FBQzVCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ3BDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzdDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxrQkFBa0I7QUFDMUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxRQUFRLENBQUM7QUFDVixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCO0FBQ3pCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsU0FBUyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQ3RDLENBQUMsZUFBZSxDQUFDLENBQUMsZ0JBQWdCLENBQUM7QUFD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QUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDM0IsQUFBQSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDO0NBQUMsQ0FBQTtBQUMxQixBQUFBLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQSxHQUFHLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUNoQyxBQUFBLEVBQUUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLEM7Q0FBQyxDQUFBO0FBQ3hCLEFBQUEsQ0FBQyxJQUFJLENBQUEsQ0FBQTtBQUNMLEFBQUEsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEMsV0FBWSxDO0NBQUMsQztBQUFBLENBQUE7QUFDdkMiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgbmljZS5jaXZldFxyXG5cclxuaW1wb3J0IHtcclxuXHR1bmRlZiwgZGVmaW5lZCwgbm90ZGVmaW5lZCwgYXNzZXJ0LCBoYXNoLFxyXG5cdGlzQXJyYXksIGlzRnVuY3Rpb24sIGlzQm9vbGVhbiwgaXNTdHJpbmcsXHJcblx0anNUeXBlLCBjbGFzc05hbWUsIGZ1bmN0aW9uTmFtZSwgc3ltYm9sTmFtZSxcclxuXHRub25FbXB0eSwgZnVuY3Rpb25EZWYsIHJlZ2V4cERlZixcclxuXHR9IGZyb20gJy4vZGF0YXR5cGVzLmxpYi50cydcclxuaW1wb3J0IHtcclxuXHRnZXRPcHRpb25zLCBlc2NhcGVTdHIsIHVuZXNjYXBlU3RyLFxyXG5cdGtleXMsIHRvQmxvY2ssIG8sIE9MLCBjcm9haywgcnRyaW0sIEZldGNoZXIsXHJcblx0fSBmcm9tICcuL2xsdXRpbHMubGliLnRzJ1xyXG5pbXBvcnQge1xyXG5cdGluZGVudGVkLFxyXG5cdH0gZnJvbSAnLi9pbmRlbnQubGliLnRzJ1xyXG5pbXBvcnQge1xyXG5cdFRQTExUb2tlbiwgdGtFT0YsIHRrSW5kZW50LCB0a1VuZGVudCxcclxuXHRUVG9rZW5HZW5lcmF0b3IsIGFsbFRva2Vuc0luQmxvY2ssXHJcblx0fSBmcm9tICcuL3BsbC5saWIudHMnXHJcblxyXG50eXBlIFRDb21wYXJlRnVuYyA9IChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gbnVtYmVyXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZ2V0Q29tcGFyZUZ1bmMgOj0gKGxTb3J0S2V5czogc3RyaW5nW10pOiBUQ29tcGFyZUZ1bmMgPT5cclxuXHJcblx0IyAtLS0gQ29udmVydCB0byBhIGZ1bmN0aW9uXHJcblx0aDogaGFzaCA6PSB7fVxyXG5cdGZvciBrZXksaSBvZiBsU29ydEtleXNcclxuXHRcdGhba2V5XSA9IGkrMVxyXG5cclxuXHRyZXR1cm4gKGE6IHN0cmluZywgYjogc3RyaW5nKTogbnVtYmVyIC0+XHJcblx0XHRhVmFsIDo9IGhbYV1cclxuXHRcdGJWYWwgOj0gaFtiXVxyXG5cclxuXHRcdGlmIGRlZmluZWQoYVZhbClcclxuXHRcdFx0aWYgZGVmaW5lZChiVmFsKVxyXG5cdFx0XHRcdCMgLS0tIGNvbXBhcmUgbnVtZXJpY2FsbHlcclxuXHRcdFx0XHRyZXR1cm4gKGFWYWwgPCBiVmFsKSA/IC0xIDogKGFWYWwgPiBiVmFsKSA/IDEgOiAwXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRyZXR1cm4gLTFcclxuXHRcdGVsc2VcclxuXHRcdFx0aWYgZGVmaW5lZChiVmFsKVxyXG5cdFx0XHRcdHJldHVybiAxXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRyZXR1cm4gKGEgPCBiKSA/IC0xIDogKGEgPiBiKSA/IDEgOiAwXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IHRvTmljZSA6PSAoeDogYW55LCBoT3B0aW9uczogaGFzaD17fSk6IHN0cmluZyA9PlxyXG5cclxuXHQjIC0tLSBXaGVuIHN0cmljdCwgY2xhc3NlcyBhbmQgZnVuY3Rpb25cclxuXHQjICAgICBpbmNsdWRlIHRoZWlyIGRlZmluaXRpb25zLCB3aXRoIGVzY2FwZWQgY2hhcnNcclxuXHJcblx0e3N0cmljdH0gOj0gZ2V0T3B0aW9ucyBoT3B0aW9ucywge1xyXG5cdFx0c3RyaWN0OiBmYWxzZVxyXG5cdFx0fVxyXG5cclxuXHRzd2l0Y2gganNUeXBlKHgpXHJcblx0XHR3aGVuICd1bmRlZidcclxuXHRcdFx0cmV0dXJuICcudW5kZWYuJ1xyXG5cdFx0d2hlbiAnbnVsbCdcclxuXHRcdFx0cmV0dXJuICcubnVsbC4nXHJcblx0XHR3aGVuICdib29sZWFuJ1xyXG5cdFx0XHRyZXR1cm4geCA/ICcudHJ1ZS4nIDogJy5mYWxzZS4nXHJcblx0XHR3aGVuICdzdHJpbmcnXHJcblx0XHRcdGlmIG5lZWRzUHJlRXNjKHgpXHJcblx0XHRcdFx0cmV0dXJuICdcXFxcJyArIGVzY2FwZVN0cih4LCBvJ3N0eWxlPUMnKVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0cmV0dXJuIGVzY2FwZVN0cih4LCBvJ3N0eWxlPUMnKVxyXG5cdFx0d2hlbiAnTmFOJ1xyXG5cdFx0XHRyZXR1cm4gJy5OYU4uJ1xyXG5cdFx0d2hlbiAnaW5maW5pdHknXHJcblx0XHRcdHJldHVybiAnLmluZmluaXR5LidcclxuXHRcdHdoZW4gJ25lZ2luZmluaXR5J1xyXG5cdFx0XHRyZXR1cm4gJy5uZWdpbmZpbml0eS4nXHJcblx0XHR3aGVuICdudW1iZXInLCdpbnRlZ2VyJ1xyXG5cdFx0XHRyZXR1cm4geC50b1N0cmluZygpXHJcblx0XHR3aGVuICdjbGFzcydcclxuXHRcdFx0bmFtZSA6PSBjbGFzc05hbWUoeClcclxuXHRcdFx0cmV0dXJuIG5hbWUgPyBcIi5jbGFzcyAje25hbWV9LlwiIDogJy5jbGFzcy4nXHJcblx0XHR3aGVuICdmdW5jdGlvbidcclxuXHRcdFx0bmFtZSA6PSBmdW5jdGlvbk5hbWUoeClcclxuXHRcdFx0cmV0dXJuIG5hbWUgPyBcIi5mdW5jdGlvbiAje25hbWV9LlwiIDogXCIuZnVuY3Rpb24uXCJcclxuXHRcdHdoZW4gJ3N5bWJvbCdcclxuXHRcdFx0bmFtZSA6PSBzeW1ib2xOYW1lKHgpXHJcblx0XHRcdHJldHVybiBuYW1lID8gXCIuc3ltYm9sICN7bmFtZX0uXCIgOiBcIi5zeW1ib2wuXCJcclxuXHRcdHdoZW4gJ3JlZ2V4cCdcclxuXHRcdFx0ZGVmIDo9IHJlZ2V4cERlZih4KVxyXG5cdFx0XHRyZXR1cm4gZGVmID8gXCIucmVnZXhwICN7ZGVmfS5cIiA6ICcucmVnZXhwLidcclxuXHRcdHdoZW4gJ2FycmF5J1xyXG5cdFx0XHRpZiAoeC5sZW5ndGggPT0gMClcclxuXHRcdFx0XHRyZXR1cm4gJy5bXS4nXHJcblx0XHRcdGxMaW5lcyA6PSBbXVxyXG5cdFx0XHRmb3IgaXRlbSBvZiB4XHJcblx0XHRcdFx0YmxvY2sgOj0gdG9OaWNlKGl0ZW0sIGhPcHRpb25zKVxyXG5cdFx0XHRcdGlmIHNob3VsZFNwbGl0KGl0ZW0pXHJcblx0XHRcdFx0XHRsTGluZXMucHVzaCAnLSdcclxuXHRcdFx0XHRcdGxMaW5lcy5wdXNoIGluZGVudGVkKGJsb2NrKVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdGxMaW5lcy5wdXNoIFwiLSAje2Jsb2NrfVwiXHJcblx0XHRcdHJldHVybiB0b0Jsb2NrKGxMaW5lcylcclxuXHJcblx0XHR3aGVuICdoYXNoJywnaW5zdGFuY2UnXHJcblx0XHRcdHtzb3J0S2V5c30gOj0gZ2V0T3B0aW9ucyBoT3B0aW9ucywge1xyXG5cdFx0XHRcdHNvcnRLZXlzOiBmYWxzZSAgICAjIC0tLSBjYW4gYmUgYm9vbGVhbi9hcnJheS9mdW5jdGlvblxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdHNvcnRLZXlzRnVuYzogVENvbXBhcmVGdW5jIDo9IChcclxuXHRcdFx0XHQgIGlzQXJyYXkoc29ydEtleXMpICAgID8gZ2V0Q29tcGFyZUZ1bmMoc29ydEtleXMpXHJcblx0XHRcdFx0OiBpc0Z1bmN0aW9uKHNvcnRLZXlzKSA/IHNvcnRLZXlzXHJcblx0XHRcdFx0OiAgICAgICAgICAgICAgICAgICAgICAgIChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gcmV0dXJuIChhIDwgYikgPyAtMSA6IChhID4gYikgPyAxIDogMFxyXG5cdFx0XHRcdClcclxuXHJcblx0XHRcdGxLZXlzIDo9IE9iamVjdC5rZXlzKHgpXHJcblx0XHRcdGlmIChsS2V5cy5sZW5ndGggPT0gMClcclxuXHRcdFx0XHRyZXR1cm4gJy57fS4nXHJcblx0XHRcdGxMaW5lcyA6PSBbXVxyXG5cdFx0XHRpZiAoc29ydEtleXMgPT0gdHJ1ZSlcclxuXHRcdFx0XHRsS2V5cy5zb3J0KClcclxuXHRcdFx0ZWxzZSBpZiAoc29ydEtleXMgIT0gZmFsc2UpXHJcblx0XHRcdFx0bEtleXMuc29ydChzb3J0S2V5c0Z1bmMpXHJcblx0XHRcdGZvciBrZXkgb2YgbEtleXNcclxuXHRcdFx0XHRhc3NlcnQgaXNTdHJpbmcoa2V5KSwgXCJrZXkgbm90IGEgc3RyaW5nOiAje09MKGtleSl9XCJcclxuXHRcdFx0XHR2YWwgOj0geFtrZXldXHJcblx0XHRcdFx0YmxvY2sgOj0gdG9OaWNlKHZhbCwgaE9wdGlvbnMpXHJcblx0XHRcdFx0aWYgc2hvdWxkU3BsaXQodmFsKVxyXG5cdFx0XHRcdFx0bExpbmVzLnB1c2ggXCIje2tleX06XCJcclxuXHRcdFx0XHRcdGxMaW5lcy5wdXNoIGluZGVudGVkKGJsb2NrKVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdGxMaW5lcy5wdXNoIFwiI3trZXl9OiAje2Jsb2NrfVwiXHJcblx0XHRcdHJldHVybiB0b0Jsb2NrKGxMaW5lcylcclxuXHRcdGVsc2VcclxuXHRcdFx0cmV0dXJuIFwiPFVua25vd24gb2JqZWN0ICN7eH1cIlxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBuZWVkc1ByZUVzYyA6PSAoc3RyOiBzdHJpbmcpID0+XHJcblxyXG5cdCMgLS0tIGlmIGl0IGxvb2tzIGxpa2UgYW4gYXJyYXkgaXRlbSwgaXQgbmVlZHMgbGVhZGluZyBcXFxyXG5cdGlmIHN0ci5tYXRjaCgvXi0vKVxyXG5cdFx0cmV0dXJuIHRydWVcclxuXHJcblx0IyAtLS0gaWYgaXQgbG9va3MgbGlrZSBhIGhhc2gga2V5LCBpdCBuZWVkcyBsZWFkaW5nIFxcXHJcblx0aWYgc3RyLm1hdGNoKC9eW0EtWmEtel1bQS1aYS16MC05X10qOi8pXHJcblx0XHRyZXR1cm4gdHJ1ZVxyXG5cclxuXHQjIC0tLSBpZiBpdCBsb29rcyBsaWtlIGEgbnVtYmVyLCBpdCBuZWVkcyBsZWFkaW5nIFxcXHJcblx0aWYgc3RyLm1hdGNoKC9eXFxkKyg/OlxcLlxcZCopPy8pXHJcblx0XHRyZXR1cm4gdHJ1ZVxyXG5cclxuXHQjIC0tLSBpZiBpdCBzdGFydHMgd2l0aCBhICcuJywgaXQgbmVlZHMgbGVhZGluZyBcXFxyXG5cdGlmIChzdHIubGVuZ3RoID4gMCkgJiYgKHN0clswXSA9PSAnLicpXHJcblx0XHRyZXR1cm4gdHJ1ZVxyXG5cclxuXHRyZXR1cm4gZmFsc2VcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5zaG91bGRTcGxpdCA6PSAoeDogYW55KTogYm9vbGVhbiA9PlxyXG5cclxuXHRyZXR1cm4gWydoYXNoJywnYXJyYXknLCdjbGFzcycsJ2luc3RhbmNlJ10uaW5jbHVkZXMoanNUeXBlKHgpKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBuaWNlU3BsaXR0ZXI6IFRUb2tlbkdlbmVyYXRvciA6PSAoXHJcblx0XHRzdHI6IHN0cmluZ1xyXG5cdFx0KSAtPlxyXG5cdGlmIGxldCBsTWF0Y2hlcyA9IHN0ci5tYXRjaCgvLy9eXHJcblx0XHRcdC1cclxuXHRcdFx0KC4qKVxyXG5cdFx0XHQkLy8vKVxyXG5cdFx0dGFpbCA6PSBsTWF0Y2hlc1sxXS50cmltKClcclxuXHRcdGlmIHRhaWxcclxuXHRcdFx0eWllbGQge1xyXG5cdFx0XHRcdGtpbmQ6ICdsaXN0LWl0ZW0nXHJcblx0XHRcdFx0c3RyXHJcblx0XHRcdFx0dmFsdWU6IGdldFByaW1pdGl2ZSh0YWlsKVxyXG5cdFx0XHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdFx0eWllbGQge1xyXG5cdFx0XHRcdGtpbmQ6ICdsaXN0LWhlYWQnXHJcblx0XHRcdFx0bmFtZTogc3RyXHJcblx0XHRcdFx0c3RyOiAnJ1xyXG5cdFx0XHRcdH1cclxuXHRlbHNlIGlmIGxldCBsTWF0Y2hlcyA9IHN0ci5tYXRjaCgvLy9eXHJcblx0XHRcdChbQS1aYS16XVtBLVphLXowLTlfXSopXHJcblx0XHRcdDpcclxuXHRcdFx0KC4qKVxyXG5cdFx0XHQkLy8vKVxyXG5cdFx0bmFtZSA6PSBsTWF0Y2hlc1sxXVxyXG5cdFx0dGFpbCA6PSBsTWF0Y2hlc1syXS50cmltKClcclxuXHRcdGlmIHRhaWxcclxuXHRcdFx0eWllbGQge1xyXG5cdFx0XHRcdGtpbmQ6ICdoYXNoLWl0ZW0nXHJcblx0XHRcdFx0c3RyXHJcblx0XHRcdFx0bmFtZVxyXG5cdFx0XHRcdHZhbHVlOiBnZXRQcmltaXRpdmUodGFpbClcclxuXHRcdFx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHRcdHlpZWxkIHtcclxuXHRcdFx0XHRraW5kOiAnaGFzaC1oZWFkJ1xyXG5cdFx0XHRcdG5hbWVcclxuXHRcdFx0XHRzdHJcclxuXHRcdFx0XHR9XHJcblx0ZWxzZVxyXG5cdFx0eWllbGQge1xyXG5cdFx0XHRraW5kOiAncHJpbWl0aXZlJ1xyXG5cdFx0XHRzdHJcclxuXHRcdFx0dmFsdWU6IGdldFByaW1pdGl2ZShzdHIpXHJcblx0XHRcdH1cclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgYWxsTmljZVRva2VucyA6PSAoXHJcblx0XHRibG9jazogc3RyaW5nLFxyXG5cdFx0KTogR2VuZXJhdG9yPFRQTExUb2tlbiwgdm9pZCwgdm9pZD4gLT5cclxuXHJcblx0Zm9yIGggb2YgYWxsVG9rZW5zSW5CbG9jayhibG9jaywgbmljZVNwbGl0dGVyKVxyXG5cdFx0eWllbGQgaFxyXG5cdHJldHVyblxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBmcm9tTmljZSA6PSAoXHJcblx0XHRzdHI6IHN0cmluZyxcclxuXHRcdCk6IGFueSA9PlxyXG5cclxuXHQjIC0tLSBDcmVhdGUgYSBGZXRjaGVyLCB0aGVuIHVzZVxyXG5cdCMgICAgIHJlY3Vyc2l2ZSBkZXNjZW50IHBhcnNpbmdcclxuXHJcblx0ZmV0Y2hlciA6PSBuZXcgRmV0Y2hlcjxUUExMVG9rZW4+KGFsbE5pY2VUb2tlbnMoc3RyKSwgdGtFT0YpXHJcblxyXG5cdHBhcnNlT2JqIDo9ICgpOiBhbnkgPT5cclxuXHRcdHtraW5kLCBzdHJ9IDo9IGZldGNoZXIucGVlaygpXHJcblx0XHRzd2l0Y2gga2luZFxyXG5cdFx0XHQnbGlzdC1pdGVtJywgJ2xpc3QtaGVhZCdcclxuXHRcdFx0XHRyZXR1cm4gcGFyc2VMaXN0KClcclxuXHRcdFx0J2hhc2gtaXRlbScsICdoYXNoLWhlYWQnXHJcblx0XHRcdFx0cmV0dXJuIHBhcnNlSGFzaCgpXHJcblx0XHRcdCdlb2YnXHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRmZXRjaGVyLnNraXAoKVxyXG5cdFx0XHRcdHJldHVybiBnZXRQcmltaXRpdmUoc3RyKVxyXG5cclxuXHRwYXJzZUxpc3QgOj0gKCk6IGFueVtdID0+XHJcblx0XHRsSXRlbXM6IGFueVtdIDo9IFtdXHJcblx0XHRsZXQge2tpbmR9ID0gZmV0Y2hlci5wZWVrKClcclxuXHRcdHdoaWxlIFsnbGlzdC1pdGVtJywgJ2xpc3QtaGVhZCddLmluY2x1ZGVzIGtpbmRcclxuXHRcdFx0aWYgKGtpbmQgPT0gJ2xpc3QtaGVhZCcpXHJcblx0XHRcdFx0bEl0ZW1zLnB1c2ggcGFyc2VMaXN0TmVzdCgpXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRsSXRlbXMucHVzaCBmZXRjaGVyLmdldCgpLnZhbHVlXHJcblx0XHRcdGtpbmQgPSBmZXRjaGVyLnBlZWsoKS5raW5kXHJcblx0XHRyZXR1cm4gbEl0ZW1zXHJcblxyXG5cdHBhcnNlTGlzdE5lc3QgOj0gKCk6IGFueVtdID0+XHJcblx0XHRmZXRjaGVyLmdldCh7a2luZDogJ2xpc3QtaGVhZCcsIHN0cjogJyd9KVxyXG5cdFx0ZmV0Y2hlci5nZXQoe2tpbmQ6ICdpbmRlbnQnLCBzdHI6ICcnfSlcclxuXHRcdHZhbHVlIDo9IHBhcnNlT2JqKClcclxuXHRcdGZldGNoZXIuZ2V0KHtraW5kOiAndW5kZW50Jywgc3RyOiAnJ30pXHJcblx0XHRyZXR1cm4gdmFsdWVcclxuXHJcblx0cGFyc2VIYXNoIDo9ICgpOiBoYXNoID0+XHJcblx0XHRoSXRlbXM6IGhhc2ggOj0ge31cclxuXHRcdGxldCB7a2luZCwgbmFtZX0gPSBmZXRjaGVyLnBlZWsoKVxyXG5cdFx0aWYgKGtpbmQgPT0gJ2hhc2gtaGVhZCcpXHJcblx0XHRcdGZldGNoZXIuc2tpcCgpXHJcblx0XHRcdGZldGNoZXIuZ2V0KHtraW5kOiAnaW5kZW50Jywgc3RyOiAnJ30pXHJcblx0XHRcdHZhbHVlIDo9IHBhcnNlT2JqKClcclxuXHRcdFx0aWYgZGVmaW5lZChuYW1lKVxyXG5cdFx0XHRcdGhJdGVtc1tuYW1lXSA9IHZhbHVlXHJcblx0XHRcdGZldGNoZXIuZ2V0KHtraW5kOiAndW5kZW50Jywgc3RyOiAnJ30pXHJcblx0XHRlbHNlXHJcblx0XHRcdHdoaWxlIChraW5kID09ICdoYXNoLWl0ZW0nKVxyXG5cdFx0XHRcdHtuYW1lLCB2YWx1ZX0gOj0gZmV0Y2hlci5nZXQoKVxyXG5cdFx0XHRcdGlmIGRlZmluZWQobmFtZSlcclxuXHRcdFx0XHRcdGhJdGVtc1tuYW1lXSA9IHZhbHVlXHJcblx0XHRcdFx0e2tpbmR9ID0gZmV0Y2hlci5wZWVrKClcclxuXHRcdHJldHVybiBoSXRlbXNcclxuXHJcblx0ZGVidWdnZXJcclxuXHRyZXR1cm4gcGFyc2VPYmooKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBnZXRQcmltaXRpdmUgOj0gKFxyXG5cdFx0c3RyOiBzdHJpbmcsXHJcblx0XHQpOiBhbnkgPT5cclxuXHJcblx0c3RyID0gc3RyLnRyaW0oKVxyXG5cdGlmIGxNYXRjaGVzIDo9IHN0ci5tYXRjaCgvXlxcLiguKilcXC4kLylcclxuXHRcdHMgOj0gbE1hdGNoZXNbMV0udHJpbSgpXHJcblx0XHRzd2l0Y2ggc1xyXG5cdFx0XHQndW5kZWYnICAgICAgIHRoZW4gcmV0dXJuIHVuZGVmXHJcblx0XHRcdCdudWxsJyAgICAgICAgdGhlbiByZXR1cm4gbnVsbFxyXG5cdFx0XHQndHJ1ZScgICAgICAgIHRoZW4gcmV0dXJuIHRydWVcclxuXHRcdFx0J2ZhbHNlJyAgICAgICB0aGVuIHJldHVybiBmYWxzZVxyXG5cdFx0XHQnTmFOJyAgICAgICAgIHRoZW4gcmV0dXJuIE5hTlxyXG5cdFx0XHQnaW5maW5pdHknICAgIHRoZW4gcmV0dXJuIEluZmluaXR5XHJcblx0XHRcdCduZWdpbmZpbml0eScgdGhlbiByZXR1cm4gLUluZmluaXR5XHJcblx0XHRcdCdzeW1ib2wnICAgICAgdGhlbiByZXR1cm4gU3ltYm9sKClcclxuXHRcdFx0J1tdJyAgICAgICAgICB0aGVuIHJldHVybiBbXVxyXG5cdFx0XHQne30nICAgICAgICAgIHRoZW4gcmV0dXJuIHt9XHJcblx0XHRcdC9ec3ltYm9sXFxzKyguKykkL1xyXG5cdFx0XHRcdGxNYXRjaGVzIDo9IHMubWF0Y2goL15zeW1ib2xcXHMrKC4rKSQvKVxyXG5cdFx0XHRcdGlmIGRlZmluZWQobE1hdGNoZXMpXHJcblx0XHRcdFx0XHRuYW1lIDo9IGxNYXRjaGVzWzFdXHJcblx0XHRcdFx0XHRyZXR1cm4gU3ltYm9sKG5hbWUpXHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0cmV0dXJuIFN5bWJvbCgpXHJcblx0XHRcdC9ecmVnZXhwXFxzKyguKykkL1xyXG5cdFx0XHRcdGxNYXRjaGVzIDo9IHMubWF0Y2goL15yZWdleHBcXHMrKC4rKSQvKVxyXG5cdFx0XHRcdGlmIGRlZmluZWQobE1hdGNoZXMpXHJcblx0XHRcdFx0XHRuYW1lIDo9IGxNYXRjaGVzWzFdXHJcblx0XHRcdFx0XHRyZXR1cm4gbmV3IFJlZ0V4cChuYW1lKVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdHJldHVybiBuZXcgUmVnRXhwKCdeJCcpXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRjcm9hayBcIk5vdCBJbXBsZW1lbnRlZFwiXHJcblx0ZWxzZSBpZiBzdHIubWF0Y2goL15cXGQrJC8pXHJcblx0XHRyZXR1cm4gcGFyc2VJbnQoc3RyLCAxMClcclxuXHRlbHNlIGlmIHN0ci5tYXRjaCgvXlxcZCtcXC5cXGQqJC8pXHJcblx0XHRyZXR1cm4gcGFyc2VGbG9hdChzdHIpXHJcblx0ZWxzZVxyXG5cdFx0cmV0dXJuIHVuZXNjYXBlU3RyKHN0ciwgbydwdXJwb3NlPUMnKVxyXG4iXX0=