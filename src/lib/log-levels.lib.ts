"use strict";
// log-levels.lib.civet

import {
	undef, defined, notdefined, assert, croak, hashof,
	} from 'datatypes'

// ---------------------------------------------------------------------------

export type TLogLevel =
	'profile' |     // log everything, with timestamp
	'debug'   |     // log everything, no timestamp
	'info'    |
	'warn'    |
	'error'   |
	'silent'  |     // log only to file
	'none'          // log nothing

const hNum: hashof<number> = {
	profile: 1,
	debug:   2,
	info:    3,
	warn:    4,
	error:   5,
	silent:  6,
	none:    7
	}

// --- stack should never be empty
const lStack: TLogLevel[] = ['info']

// ---------------------------------------------------------------------------

export const getLogLevel = (): TLogLevel => {

	if (lStack.length === 0) {
		croak("empty stack")
		return 'none'
	}
	else {
		return lStack[lStack.length - 1]
	}
}

// ---------------------------------------------------------------------------

export const isLogLevel = (x: string): x is TLogLevel => {

	return defined(hNum[x])
}

// ---------------------------------------------------------------------------

export const isInactiveLevel = (level: TLogLevel): boolean => {

	return hNum[level] < hNum[getLogLevel()]
}

// ---------------------------------------------------------------------------

export const setLogLevel = (level: TLogLevel): void => {

	assert((lStack.length > 0), "empty stack")
	lStack[lStack.length-1] = level
	return
}

// ---------------------------------------------------------------------------

export const pushLogLevel = (level: TLogLevel): void => {

	lStack.push(level)
	return
}

// ---------------------------------------------------------------------------

export const popLogLevel = (): TLogLevel => {

	const result = lStack.pop()
	if (defined(result)) {
		return result
	}
	else {
		console.error("empty logger stack")
		resetLogLevel()
		return 'none'
	}
}

// ---------------------------------------------------------------------------

export const resetLogLevel = (): void => {

	lStack.length = 0
	lStack.push('info')
	return
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFxsb2ctbGV2ZWxzLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXGxpYlxcbG9nLWxldmVscy5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSx1QkFBc0I7QUFDdEIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUNuRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztBQUNuQixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3ZCLEFBQUEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxLQUFLLGlDQUFnQztBQUNqRCxBQUFBLENBQUMsT0FBTyxHQUFHLENBQUMsS0FBSywrQkFBOEI7QUFDL0MsQUFBQSxDQUFDLE1BQU0sSUFBSSxDQUFDO0FBQ1osQUFBQSxDQUFDLE1BQU0sSUFBSSxDQUFDO0FBQ1osQUFBQSxDQUFDLE9BQU8sR0FBRyxDQUFDO0FBQ1osQUFBQSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssbUJBQWtCO0FBQ25DLEFBQUEsQ0FBQyxNQUFNLFVBQVUsY0FBYTtBQUM5QixBQUFBO0FBQ0EsQUFBQSxBQUFvQixNQUFwQixJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBRSxDQUFDLENBQUM7QUFDekIsQUFBQSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUNYLEFBQUEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUE7QUFDWCxBQUFBLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ1gsQUFB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QU0sQ0FBQTtBQUNQLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBWSxNQUFYLFdBQVcsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDdEMsQUFBQTtBQUNBLEFBQUEsQ0FBTyxNQUFOLE1BQU0sQ0FBQyxDQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZCLEFBQUEsQ0FBQyxHQUFHLENBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUNuQixBQUFBLEVBQUUsTUFBTSxDQUFDLE07Q0FBTSxDQUFBO0FBQ2YsQUFBQSxDQUFDLElBQUksQ0FBQSxDQUFBO0FBQ0wsQUFBQSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUEsQUFBQyxvQkFBb0IsQ0FBQTtBQUNwQyxBQUFBLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDakIsQUFBQSxFQUFFLE1BQU0sQ0FBQyxNO0NBQU0sQztBQUFBLENBQUE7QUFDZixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQWMsTUFBYixhQUFhLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ25DLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFDLE1BQU0sQyxDQUFFLENBQUMsQ0FBQztBQUNsQixBQUFBLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQSxBQUFDLE1BQU0sQ0FBQTtBQUNuQixBQUFBLENBQUMsTTtBQUNEIiwibmFtZXMiOltdLCJzb3VyY2VzQ29udGVudCI6WyIjIGxvZy1sZXZlbHMubGliLmNpdmV0XHJcblxyXG5pbXBvcnQge1xyXG5cdHVuZGVmLCBkZWZpbmVkLCBub3RkZWZpbmVkLCBhc3NlcnQsIGNyb2FrLCBoYXNob2YsXHJcblx0fSBmcm9tICdkYXRhdHlwZXMnXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IHR5cGUgVExvZ0xldmVsID1cclxuXHQncHJvZmlsZScgfCAgICAgIyBsb2cgZXZlcnl0aGluZywgd2l0aCB0aW1lc3RhbXBcclxuXHQnZGVidWcnICAgfCAgICAgIyBsb2cgZXZlcnl0aGluZywgbm8gdGltZXN0YW1wXHJcblx0J2luZm8nICAgIHxcclxuXHQnd2FybicgICAgfFxyXG5cdCdlcnJvcicgICB8XHJcblx0J3NpbGVudCcgIHwgICAgICMgbG9nIG9ubHkgdG8gZmlsZVxyXG5cdCdub25lJyAgICAgICAgICAjIGxvZyBub3RoaW5nXHJcblxyXG5oTnVtOiBoYXNob2Y8bnVtYmVyPiA6PSB7XHJcblx0cHJvZmlsZTogMVxyXG5cdGRlYnVnOiAgIDJcclxuXHRpbmZvOiAgICAzXHJcblx0d2FybjogICAgNFxyXG5cdGVycm9yOiAgIDVcclxuXHRzaWxlbnQ6ICA2XHJcblx0bm9uZTogICAgN1xyXG5cdH1cclxuXHJcbiMgLS0tIHN0YWNrIHNob3VsZCBuZXZlciBiZSBlbXB0eVxyXG5sU3RhY2s6IFRMb2dMZXZlbFtdIDo9IFsnaW5mbyddXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGdldExvZ0xldmVsIDo9ICgpOiBUTG9nTGV2ZWwgPT5cclxuXHJcblx0aWYgKGxTdGFjay5sZW5ndGggPT0gMClcclxuXHRcdGNyb2FrIFwiZW1wdHkgc3RhY2tcIlxyXG5cdFx0cmV0dXJuICdub25lJ1xyXG5cdGVsc2VcclxuXHRcdHJldHVybiBsU3RhY2tbbFN0YWNrLmxlbmd0aCAtIDFdXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGlzTG9nTGV2ZWwgOj0gKHg6IHN0cmluZyk6IHggaXMgVExvZ0xldmVsID0+XHJcblxyXG5cdHJldHVybiBkZWZpbmVkKGhOdW1beF0pXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXhwb3J0IGlzSW5hY3RpdmVMZXZlbCA6PSAobGV2ZWw6IFRMb2dMZXZlbCk6IGJvb2xlYW4gPT5cclxuXHJcblx0cmV0dXJuIGhOdW1bbGV2ZWxdIDwgaE51bVtnZXRMb2dMZXZlbCgpXVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBzZXRMb2dMZXZlbCA6PSAobGV2ZWw6IFRMb2dMZXZlbCk6IHZvaWQgPT5cclxuXHJcblx0YXNzZXJ0IChsU3RhY2subGVuZ3RoID4gMCksIFwiZW1wdHkgc3RhY2tcIlxyXG5cdGxTdGFja1tsU3RhY2subGVuZ3RoLTFdID0gbGV2ZWxcclxuXHRyZXR1cm5cclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5leHBvcnQgcHVzaExvZ0xldmVsIDo9IChsZXZlbDogVExvZ0xldmVsKTogdm9pZCA9PlxyXG5cclxuXHRsU3RhY2sucHVzaCBsZXZlbFxyXG5cdHJldHVyblxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBwb3BMb2dMZXZlbCA6PSAoKTogVExvZ0xldmVsID0+XHJcblxyXG5cdHJlc3VsdCA6PSBsU3RhY2sucG9wKClcclxuXHRpZiBkZWZpbmVkKHJlc3VsdClcclxuXHRcdHJldHVybiByZXN1bHRcclxuXHRlbHNlXHJcblx0XHRjb25zb2xlLmVycm9yIFwiZW1wdHkgbG9nZ2VyIHN0YWNrXCJcclxuXHRcdHJlc2V0TG9nTGV2ZWwoKVxyXG5cdFx0cmV0dXJuICdub25lJ1xyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCByZXNldExvZ0xldmVsIDo9ICgpOiB2b2lkID0+XHJcblxyXG5cdGxTdGFjay5sZW5ndGggPSAwXHJcblx0bFN0YWNrLnB1c2ggJ2luZm8nXHJcblx0cmV0dXJuIl19