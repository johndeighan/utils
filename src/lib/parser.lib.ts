"use strict";
// parser.lib.civet

import {sprintf} from "@std/fmt/printf"
import {
	undef, defined, notdefined,
	array, hash, isEmpty, nonEmpty,
	} from './datatypes.lib.ts'
import {
	getOptions, escapeStr, spaces,
	} from './llutils.lib.ts'
import {logIndent} from './log-formatter.lib.ts'
import {
	getLogLevel, setLogLevel,
	pushLogLevel, popLogLevel, DBG, INDENT, UNDENT,
	} from './logger.lib.ts'

// ---------------------------------------------------------------------------

export type TState = {
	text: string
	ignore: any[]
	lMatches: string[]
	stack?: any[]
	pos: number
	nolog?: boolean
	}

export type TRule = ($: TState) => TState

// --- Anything that can be converted to a TRule
type TLaxRule = (string | RegExp | TRule)

// ---------------------------------------------------------------------------

export const getNewState = (
		text: string,
		pos: number = 0
		): TState => {

	return {
		text,
		ignore: [],
		lMatches: [],
		pos
		}
}

// ---------------------------------------------------------------------------

const nbuf = 24

const DBGMATCH = (
		desc: string,    // Describe what we're trying to match
		$: TState,
		$next: TState
		): void => {

	if ($.nolog) {
		return
	}
	const str = escapeStr($.text.substring($.pos, $next.pos))
	const buf = spaces(nbuf - str.length - 1 - 3*logIndent)
	DBG(`[+${sprintf('%3d', $.pos)}] ${str}${buf}${desc}`)
	return
}

// ---------------------------------------------------------------------------

const DBGNOMATCH = (
		desc: string,    // Describe what we're trying to match
		$: TState
		): void => {

	if ($.nolog) {
		return
	}
	const buf = spaces(nbuf - 3*logIndent)
	DBG(`[-${sprintf('%3d', $.pos)}]${buf}${desc}`)
	return
}

// ---------------------------------------------------------------------------

const skipIgnored = ($: TState): TState => {

	if (isEmpty($.ignore)) {
		return $
	}
	else {
		$.ignore.push((x: TState): TState => { return x })
//		$.nolog = true
		const result = $.ignore.at(-1)($)
//		$.nolog = false
		$.ignore.pop()
		return result
	}
}

// ---------------------------------------------------------------------------

export const RegexMatcher = (re: RegExp): TRule => {

	return ($: TState): TState => {

		const $cur = skipIgnored($)
		const lMatches = re.exec($cur.text.substring($.pos))
		if (!lMatches) {
			DBGNOMATCH(re.toString(), $)
			return $
		}

		// --- Token is matched, add matches to state,
		//     return the next state
		const numChars = lMatches[0].length
		const $next = {
			...$cur,
			pos: $.pos + numChars,
			}
		$.lMatches = lMatches
		DBGMATCH(re.toString(), $, $next)
		return $next
	}
}

// ---------------------------------------------------------------------------

export const StringMatcher = (str: string): TRule => {

	return ($: TState): TState => {

		const $cur = skipIgnored($)
		if ($cur.text.startsWith(str, $cur.pos)) {
			const $next = {
				...$cur,
				pos: $cur.pos + str.length
				}
			DBGMATCH(`'${escapeStr(str)}'`, $, $next)
			return $next
		}
		else {
			DBGNOMATCH(`'${escapeStr(str)}'`, $)
			return $
		}
	}
}

// ---------------------------------------------------------------------------

export function getRule(rule: TLaxRule): TRule {

	if (typeof (rule) === 'function') {
		return rule
	}
	if (rule instanceof RegExp) {
		return RegexMatcher(rule)
	}
	if (typeof (rule) === 'string') {
		return StringMatcher(rule)
	}
	throw new Error('Invalid rule')
}

// ---------------------------------------------------------------------------

const unpackList = (lArgs: array): [string, TRule[]] => {

	if (typeof lArgs[0] === 'string') {
		return [lArgs[0], lArgs[1].map(getRule)]
	}
	else {
		return ['', lArgs[0].map(getRule)]
	}
}

// ---------------------------------------------------------------------------

const unpackOne = (lArgs: array): [string, TRule] => {

	if (typeof lArgs[0] === 'string') {
		return [lArgs[0], getRule(lArgs[1])]
	}
	else {
		return ['', getRule(lArgs[0])]
	}
}

// ---------------------------------------------------------------------------
// --- Match a sequence of rules left to right

export function All(...lArgs: array): TRule {

	const [name, lRules] = unpackList(lArgs)
	return ($) => {
		DBG(`${name} &`, INDENT)
		const $org = $   // save to use as return value on failure
		$ = Object.assign({}, $org)
		let i1 = 0;for (const rule of lRules) {const i = i1++;
			DBG("-----")
			const $next = rule($)
			if ($next === $) {
				DBG('FAIL', UNDENT)
				return $org
			}
			$ = $next
		}

		DBG('OK', UNDENT)
		return $
	}
}

// ---------------------------------------------------------------------------
// --- Match any of the rules, check left to right

export function Any(...lArgs: array): TRule {

	const [name, lRules] = unpackList(lArgs)
	return ($) => {
		DBG(`${name} |`, INDENT)
		let i2 = 0;for (const rule of lRules) {const i = i2++;
			DBG("-----")
			const $next = rule($)
			if ($next !== $) {
				DBG('OK', UNDENT)
				return $next
			}
		}
		DBG('FAIL', UNDENT)
		return $
	}
}

// ---------------------------------------------------------------------------
// --- Match a rule 1 or more times

export function Plus(...lArgs: array): TRule {

	const [name, rule] = unpackOne(lArgs)
	return ($) => {
		DBG(`${name} +`, INDENT)
		const $first = rule($)
		if ($first === $) {
			DBG("FAIL", UNDENT)
			return $
		}     // --- no match
		$ = $first
		while(true) {
			const $next = rule($)
			if ($next === $) {
				DBG("OK", UNDENT)
				return $next
			}
			$ = $next
		}
	}
}

// ---------------------------------------------------------------------------
// --- Match a rule optionally

export function Optional(...lArgs: array): TRule {

	const [name, rule] = unpackOne(lArgs)
	return ($) => {
		DBG(`${name} ?`, INDENT)
		const $next = rule($)
		if ($next !== $) {
			DBG("OK - matched", UNDENT)
			return $next
		}
		else {
			// --- Otherwise return a shallow copy
			//     of the state to still indicate success
			DBG("OK - not matched", UNDENT)
			return Object.assign({}, $)
		}
	}
}

// ---------------------------------------------------------------------------

export function Star(...lArgs: array): TRule {

	const [name, rule] = unpackOne(lArgs)
	return ($) => {
		DBG(`${name} *`, INDENT)
		$ = Object.assign({}, $);
		while(true) {
			const $next = rule($)
			if ($next === $) {
				DBG("OK", UNDENT)
				return $next
			}
			$ = $next
		}
	}
}

// ---------------------------------------------------------------------------

type TReducer<T> = (
	$: TState,
	$next: TState
	) => (T | undefined)

export function Node<T>(
		laxRule: TLaxRule,
		reducer: TReducer<T>
		): TRule {

	const rule = getRule(laxRule)
	return ($) => {
		const $next = rule($)
		if ($next === $) {
			return $
		}

		// --- We have a match
		const node = reducer($, $next)
		if (defined(node)) {
			if ($next.stack) {
				$next.stack.push(node)
			}
			else {
				$next.stack = [node]
			}
		}
		return $next
	}
}

// ---------------------------------------------------------------------------

export const getLineAndColumn = (text: string, pos: number) => {

	const countChars = (str: string, ch: string): number => {
		let count = 0
		let pos = -1
		while ((pos = str.indexOf(ch, pos+1)) !== -1) {
			count += 1
		}
		return count
	}


	// --- Get line number by counting number of \n chars
	//        before the current position
	//     Get column number by finding closest previous position
	//        of a \n and computing the difference

	const shortStr = text.substring(0, pos)
	return [
		countChars(shortStr, "\n") + 1,
		pos - shortStr.lastIndexOf('\n')
		]
}

// ---------------------------------------------------------------------------

export function Ignore(
		laxToIgnore: TLaxRule,
		laxRule: TLaxRule
		): TRule {

	const rule = getRule(laxRule)
	const toIgnore = getRule(laxToIgnore)
	return ($: TState) => {
		const $cur = toIgnore($)
		$.ignore.push(toIgnore)
		const $next = rule($cur)
		$.ignore.pop()
		return ($next === $cur) ? $ : toIgnore($next)
	}
}

// ---------------------------------------------------------------------------
// --- Returns a function that:
//        1. accepts a string
//        2. returns void

type TParser = (str: string) => void

export function getParser<T>(
		laxRule: TLaxRule,
		hOptions: hash = {}
		): TParser {

	const {pos, partial, reSkip} = getOptions(hOptions, {
		pos: 0,
		partial: false,
		reSkip: /^\s+/
		})
	const rule = getRule(laxRule)

	return (text: string): (T | undefined) => {
		const $ = {
			text,
			ignore: defined(reSkip) ? [RegexMatcher(reSkip)] : [],
			lMatches: [],
			pos: 0
			}
		const $next = rule($)

		if ($ === $next) {
			const [line, column] = getLineAndColumn(text, $.pos)
			throw new SyntaxError(`No match at pos ${$.pos}
Remainder: ${escapeStr(text.slice($.pos))}`)
		}
		if (!partial && ($next.pos < text.length)) {
			// --- Not all input consumed
			const [line, column] = getLineAndColumn(text, $.pos)
			throw new SyntaxError(`Stopped at pos ${$.pos}
Remainder: ${escapeStr(text.slice($.pos))}`)
		}
		return $next.stack ? $next.stack[0] : undef
	}
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9wYXJzZXIubGliLmNpdmV0LnRzeCIsInNvdXJjZXMiOlsic3JjL2xpYi9wYXJzZXIubGliLmNpdmV0Il0sIm1hcHBpbmdzIjoiO0FBQUEsbUJBQWtCO0FBQ2xCLEFBQUE7QUFDQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUI7QUFDdkMsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUM7QUFDNUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDaEMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLG9CQUFvQjtBQUM1QixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUMvQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCO0FBQzFCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsd0JBQXdCO0FBQ2hELEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsV0FBVyxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQzFCLENBQUMsWUFBWSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ2hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUI7QUFDekIsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdEIsQUFBQSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU07QUFDYixBQUFBLENBQUMsTUFBTSxDQUFDLENBQUMs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QTtBQUMxQyxBQUFBLEdBQVEsTUFBTCxLQUFLLENBQUMsQ0FBRSxDQUFDLENBQUM7QUFDYixBQUFBLElBQUksR0FBRyxJQUFJLENBQUM7QUFDWixBQUFBLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU07QUFDOUIsSUFBSSxDQUFDO0FBQ0wsQUFBQSxHQUFHLFFBQVEsQ0FBQSxBQUFDLENBQUMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQTtBQUMzQyxBQUFBLEdBQUcsTUFBTSxDQUFDLEs7RUFBSyxDQUFBO0FBQ2YsQUFBQSxFQUFFLElBQUksQ0FBQSxDQUFBO0FBQ04sQUFBQSxHQUFHLFVBQVUsQ0FBQSxBQUFDLENBQUMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUN0QyxBQUFBLEdBQUcsTUFBTSxDQUFDLEM7RUFBQyxDO0NBQUEsQztBQUFBLENBQUE7QUFDWCxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQSxDQUFBO0FBQzlDLEFBQUE7QUFDQSxBQUFBLENBQUMsR0FBRyxDQUFDLE0sQ0FBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQSxDQUFBO0FBQ2hDLEFBQUEsRUFBRSxNQUFNLENBQUMsSTtDQUFJLENBQUE7QUFDYixBQUFBLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQTtBQUM1QixBQUFBLEVBQUUsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLEM7Q0FBQyxDQUFBO0FBQzNCLEFBQUEsQ0FB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LENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLO0NBQUssQztBQUFBLENBQUE7QUFDN0MiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgcGFyc2VyLmxpYi5jaXZldFxuXG5pbXBvcnQge3NwcmludGZ9IGZyb20gXCJAc3RkL2ZtdC9wcmludGZcIlxuaW1wb3J0IHtcblx0dW5kZWYsIGRlZmluZWQsIG5vdGRlZmluZWQsXG5cdGFycmF5LCBoYXNoLCBpc0VtcHR5LCBub25FbXB0eSxcblx0fSBmcm9tICcuL2RhdGF0eXBlcy5saWIudHMnXG5pbXBvcnQge1xuXHRnZXRPcHRpb25zLCBlc2NhcGVTdHIsIHNwYWNlcyxcblx0fSBmcm9tICcuL2xsdXRpbHMubGliLnRzJ1xuaW1wb3J0IHtsb2dJbmRlbnR9IGZyb20gJy4vbG9nLWZvcm1hdHRlci5saWIudHMnXG5pbXBvcnQge1xuXHRnZXRMb2dMZXZlbCwgc2V0TG9nTGV2ZWwsXG5cdHB1c2hMb2dMZXZlbCwgcG9wTG9nTGV2ZWwsIERCRywgSU5ERU5ULCBVTkRFTlQsXG5cdH0gZnJvbSAnLi9sb2dnZXIubGliLnRzJ1xuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgdHlwZSBUU3RhdGUgPSB7XG5cdHRleHQ6IHN0cmluZ1xuXHRpZ25vcmU6IGFueVtdXG5cdGxNYXRjaGVzOiBzdHJpbmdbXVxuXHRzdGFjaz86IGFueVtdXG5cdHBvczogbnVtYmVyXG5cdG5vbG9nPzogYm9vbGVhblxuXHR9XG5cbmV4cG9ydCB0eXBlIFRSdWxlID0gKCQ6IFRTdGF0ZSkgPT4gVFN0YXRlXG5cbiMgLS0tIEFueXRoaW5nIHRoYXQgY2FuIGJlIGNvbnZlcnRlZCB0byBhIFRSdWxlXG50eXBlIFRMYXhSdWxlID0gKHN0cmluZyB8IFJlZ0V4cCB8IFRSdWxlKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgZ2V0TmV3U3RhdGUgOj0gKFxuXHRcdHRleHQ6IHN0cmluZ1xuXHRcdHBvczogbnVtYmVyID0gMFxuXHRcdCk6IFRTdGF0ZSA9PlxuXG5cdHJldHVybiB7XG5cdFx0dGV4dFxuXHRcdGlnbm9yZTogW11cblx0XHRsTWF0Y2hlczogW11cblx0XHRwb3Ncblx0XHR9XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbm5idWYgOj0gMjRcblxuREJHTUFUQ0ggOj0gKFxuXHRcdGRlc2M6IHN0cmluZyAgICAjIERlc2NyaWJlIHdoYXQgd2UncmUgdHJ5aW5nIHRvIG1hdGNoXG5cdFx0JDogVFN0YXRlXG5cdFx0JG5leHQ6IFRTdGF0ZVxuXHRcdCk6IHZvaWQgPT5cblxuXHRpZiAkLm5vbG9nXG5cdFx0cmV0dXJuXG5cdHN0ciA6PSBlc2NhcGVTdHIoJC50ZXh0LnN1YnN0cmluZygkLnBvcywgJG5leHQucG9zKSlcblx0YnVmIDo9IHNwYWNlcyhuYnVmIC0gc3RyLmxlbmd0aCAtIDEgLSAzKmxvZ0luZGVudClcblx0REJHIFwiWysje3NwcmludGYoJyUzZCcsICQucG9zKX1dICN7c3RyfSN7YnVmfSN7ZGVzY31cIlxuXHRyZXR1cm5cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuREJHTk9NQVRDSCA6PSAoXG5cdFx0ZGVzYzogc3RyaW5nICAgICMgRGVzY3JpYmUgd2hhdCB3ZSdyZSB0cnlpbmcgdG8gbWF0Y2hcblx0XHQkOiBUU3RhdGVcblx0XHQpOiB2b2lkID0+XG5cblx0aWYgJC5ub2xvZ1xuXHRcdHJldHVyblxuXHRidWYgOj0gc3BhY2VzKG5idWYgLSAzKmxvZ0luZGVudClcblx0REJHIFwiWy0je3NwcmludGYoJyUzZCcsICQucG9zKX1dI3tidWZ9I3tkZXNjfVwiXG5cdHJldHVyblxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5za2lwSWdub3JlZCA6PSAoJDogVFN0YXRlKTogVFN0YXRlID0+XG5cblx0aWYgaXNFbXB0eSgkLmlnbm9yZSlcblx0XHRyZXR1cm4gJFxuXHRlbHNlXG5cdFx0JC5pZ25vcmUucHVzaCAoeDogVFN0YXRlKTogVFN0YXRlID0+IHJldHVybiB4XG4jXHRcdCQubm9sb2cgPSB0cnVlXG5cdFx0cmVzdWx0IDo9ICQuaWdub3JlLmF0KC0xKSgkKVxuI1x0XHQkLm5vbG9nID0gZmFsc2Vcblx0XHQkLmlnbm9yZS5wb3AoKVxuXHRcdHJldHVybiByZXN1bHRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IFJlZ2V4TWF0Y2hlciA6PSAocmU6IFJlZ0V4cCk6IFRSdWxlID0+XG5cblx0cmV0dXJuICgkOiBUU3RhdGUpOiBUU3RhdGUgPT5cblxuXHRcdCRjdXIgOj0gc2tpcElnbm9yZWQoJClcblx0XHRsTWF0Y2hlcyA6PSByZS5leGVjKCRjdXIudGV4dC5zdWJzdHJpbmcoJC5wb3MpKVxuXHRcdGlmIChub3QgbE1hdGNoZXMpXG5cdFx0XHREQkdOT01BVENIIHJlLnRvU3RyaW5nKCksICRcblx0XHRcdHJldHVybiAkXG5cblx0XHQjIC0tLSBUb2tlbiBpcyBtYXRjaGVkLCBhZGQgbWF0Y2hlcyB0byBzdGF0ZSxcblx0XHQjICAgICByZXR1cm4gdGhlIG5leHQgc3RhdGVcblx0XHRudW1DaGFycyA6PSBsTWF0Y2hlc1swXS5sZW5ndGhcblx0XHQkbmV4dCA6PSB7XG5cdFx0XHQuLi4kY3VyLFxuXHRcdFx0cG9zOiAkLnBvcyArIG51bUNoYXJzLFxuXHRcdFx0fVxuXHRcdCQubE1hdGNoZXMgPSBsTWF0Y2hlc1xuXHRcdERCR01BVENIIHJlLnRvU3RyaW5nKCksICQsICRuZXh0XG5cdFx0cmV0dXJuICRuZXh0XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBTdHJpbmdNYXRjaGVyIDo9IChzdHI6IHN0cmluZyk6IFRSdWxlID0+XG5cblx0cmV0dXJuICgkOiBUU3RhdGUpOiBUU3RhdGUgPT5cblxuXHRcdCRjdXIgOj0gc2tpcElnbm9yZWQoJClcblx0XHRpZiAoJGN1ci50ZXh0LnN0YXJ0c1dpdGgoc3RyLCAkY3VyLnBvcykpXG5cdFx0XHQkbmV4dCA6PSB7XG5cdFx0XHRcdC4uLiRjdXIsXG5cdFx0XHRcdHBvczogJGN1ci5wb3MgKyBzdHIubGVuZ3RoXG5cdFx0XHRcdH1cblx0XHRcdERCR01BVENIIFwiJyN7ZXNjYXBlU3RyKHN0cil9J1wiLCAkLCAkbmV4dFxuXHRcdFx0cmV0dXJuICRuZXh0XG5cdFx0ZWxzZVxuXHRcdFx0REJHTk9NQVRDSCBcIicje2VzY2FwZVN0cihzdHIpfSdcIiwgJFxuXHRcdFx0cmV0dXJuICRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJ1bGUocnVsZTogVExheFJ1bGUpOiBUUnVsZVxuXG5cdGlmICh0eXBlb2YocnVsZSkgPT0gJ2Z1bmN0aW9uJylcblx0XHRyZXR1cm4gcnVsZVxuXHRpZiAocnVsZSBpbnN0YW5jZW9mIFJlZ0V4cClcblx0XHRyZXR1cm4gUmVnZXhNYXRjaGVyKHJ1bGUpXG5cdGlmICh0eXBlb2YocnVsZSkgPT0gJ3N0cmluZycpXG5cdFx0cmV0dXJuIFN0cmluZ01hdGNoZXIocnVsZSlcblx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJ1bGUnKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG51bnBhY2tMaXN0IDo9IChsQXJnczogYXJyYXkpOiBbc3RyaW5nLCBUUnVsZVtdXSA9PlxuXG5cdGlmICh0eXBlb2YgbEFyZ3NbMF0gPT0gJ3N0cmluZycpXG5cdFx0cmV0dXJuIFtsQXJnc1swXSwgbEFyZ3NbMV0ubWFwKGdldFJ1bGUpXVxuXHRlbHNlXG5cdFx0cmV0dXJuIFsnJywgbEFyZ3NbMF0ubWFwKGdldFJ1bGUpXVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG51bnBhY2tPbmUgOj0gKGxBcmdzOiBhcnJheSk6IFtzdHJpbmcsIFRSdWxlXSA9PlxuXG5cdGlmICh0eXBlb2YgbEFyZ3NbMF0gPT0gJ3N0cmluZycpXG5cdFx0cmV0dXJuIFtsQXJnc1swXSwgZ2V0UnVsZShsQXJnc1sxXSldXG5cdGVsc2Vcblx0XHRyZXR1cm4gWycnLCBnZXRSdWxlKGxBcmdzWzBdKV1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIE1hdGNoIGEgc2VxdWVuY2Ugb2YgcnVsZXMgbGVmdCB0byByaWdodFxuXG5leHBvcnQgZnVuY3Rpb24gQWxsKC4uLmxBcmdzOiBhcnJheSk6IFRSdWxlXG5cblx0W25hbWUsIGxSdWxlc10gOj0gdW5wYWNrTGlzdChsQXJncylcblx0cmV0dXJuICgkKSA9PlxuXHRcdERCRyBcIiN7bmFtZX0gJlwiLCBJTkRFTlRcblx0XHQkb3JnIDo9ICQgICAjIHNhdmUgdG8gdXNlIGFzIHJldHVybiB2YWx1ZSBvbiBmYWlsdXJlXG5cdFx0JCA9IE9iamVjdC5hc3NpZ24oe30sICRvcmcpXG5cdFx0Zm9yIHJ1bGUsaSBvZiBsUnVsZXNcblx0XHRcdERCRyBcIi0tLS0tXCJcblx0XHRcdCRuZXh0IDo9IHJ1bGUoJClcblx0XHRcdGlmICgkbmV4dCA9PSAkKVxuXHRcdFx0XHREQkcgJ0ZBSUwnLCBVTkRFTlRcblx0XHRcdFx0cmV0dXJuICRvcmdcblx0XHRcdCQgPSAkbmV4dFxuXG5cdFx0REJHICdPSycsIFVOREVOVFxuXHRcdHJldHVybiAkXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIC0tLSBNYXRjaCBhbnkgb2YgdGhlIHJ1bGVzLCBjaGVjayBsZWZ0IHRvIHJpZ2h0XG5cbmV4cG9ydCBmdW5jdGlvbiBBbnkoLi4ubEFyZ3M6IGFycmF5KTogVFJ1bGVcblxuXHRbbmFtZSwgbFJ1bGVzXSA6PSB1bnBhY2tMaXN0KGxBcmdzKVxuXHRyZXR1cm4gKCQpID0+XG5cdFx0REJHIFwiI3tuYW1lfSB8XCIsIElOREVOVFxuXHRcdGZvciBydWxlLGkgb2YgbFJ1bGVzXG5cdFx0XHREQkcgXCItLS0tLVwiXG5cdFx0XHQkbmV4dCA6PSBydWxlKCQpXG5cdFx0XHRpZiAoJG5leHQgIT0gJClcblx0XHRcdFx0REJHICdPSycsIFVOREVOVFxuXHRcdFx0XHRyZXR1cm4gJG5leHRcblx0XHREQkcgJ0ZBSUwnLCBVTkRFTlRcblx0XHRyZXR1cm4gJFxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAtLS0gTWF0Y2ggYSBydWxlIDEgb3IgbW9yZSB0aW1lc1xuXG5leHBvcnQgZnVuY3Rpb24gUGx1cyguLi5sQXJnczogYXJyYXkpOiBUUnVsZVxuXG5cdFtuYW1lLCBydWxlXSA6PSB1bnBhY2tPbmUobEFyZ3MpXG5cdHJldHVybiAoJCkgPT5cblx0XHREQkcgXCIje25hbWV9ICtcIiwgSU5ERU5UXG5cdFx0JGZpcnN0IDo9IHJ1bGUoJClcblx0XHRpZiAoJGZpcnN0ID09ICQpXG5cdFx0XHREQkcgXCJGQUlMXCIsIFVOREVOVFxuXHRcdFx0cmV0dXJuICQgICAgICMgLS0tIG5vIG1hdGNoXG5cdFx0JCA9ICRmaXJzdFxuXHRcdGxvb3Bcblx0XHRcdCRuZXh0IDo9IHJ1bGUoJClcblx0XHRcdGlmICgkbmV4dCA9PSAkKVxuXHRcdFx0XHREQkcgXCJPS1wiLCBVTkRFTlRcblx0XHRcdFx0cmV0dXJuICRuZXh0XG5cdFx0XHQkID0gJG5leHRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIE1hdGNoIGEgcnVsZSBvcHRpb25hbGx5XG5cbmV4cG9ydCBmdW5jdGlvbiBPcHRpb25hbCguLi5sQXJnczogYXJyYXkpOiBUUnVsZVxuXG5cdFtuYW1lLCBydWxlXSA6PSB1bnBhY2tPbmUobEFyZ3MpXG5cdHJldHVybiAoJCkgPT5cblx0XHREQkcgXCIje25hbWV9ID9cIiwgSU5ERU5UXG5cdFx0JG5leHQgOj0gcnVsZSgkKVxuXHRcdGlmICgkbmV4dCAhPSAkKVxuXHRcdFx0REJHIFwiT0sgLSBtYXRjaGVkXCIsIFVOREVOVFxuXHRcdFx0cmV0dXJuICRuZXh0XG5cdFx0ZWxzZVxuXHRcdFx0IyAtLS0gT3RoZXJ3aXNlIHJldHVybiBhIHNoYWxsb3cgY29weVxuXHRcdFx0IyAgICAgb2YgdGhlIHN0YXRlIHRvIHN0aWxsIGluZGljYXRlIHN1Y2Nlc3Ncblx0XHRcdERCRyBcIk9LIC0gbm90IG1hdGNoZWRcIiwgVU5ERU5UXG5cdFx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgJClcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGZ1bmN0aW9uIFN0YXIoLi4ubEFyZ3M6IGFycmF5KTogVFJ1bGVcblxuXHRbbmFtZSwgcnVsZV0gOj0gdW5wYWNrT25lKGxBcmdzKVxuXHRyZXR1cm4gKCQpID0+XG5cdFx0REJHIFwiI3tuYW1lfSAqXCIsIElOREVOVFxuXHRcdCQgPSBPYmplY3QuYXNzaWduKHt9LCAkKTtcblx0XHRsb29wXG5cdFx0XHQkbmV4dCA6PSBydWxlKCQpXG5cdFx0XHRpZiAoJG5leHQgPT0gJClcblx0XHRcdFx0REJHIFwiT0tcIiwgVU5ERU5UXG5cdFx0XHRcdHJldHVybiAkbmV4dFxuXHRcdFx0JCA9ICRuZXh0XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbnR5cGUgVFJlZHVjZXI8VD4gPSAoXG5cdCQ6IFRTdGF0ZVxuXHQkbmV4dDogVFN0YXRlXG5cdCkgPT4gVD9cblxuZXhwb3J0IGZ1bmN0aW9uIE5vZGU8VD4oXG5cdFx0bGF4UnVsZTogVExheFJ1bGUsXG5cdFx0cmVkdWNlcjogVFJlZHVjZXI8VD5cblx0XHQpOiBUUnVsZVxuXG5cdHJ1bGUgOj0gZ2V0UnVsZSBsYXhSdWxlXG5cdHJldHVybiAoJCkgPT5cblx0XHQkbmV4dCA6PSBydWxlKCQpXG5cdFx0aWYgKCRuZXh0ID09ICQpXG5cdFx0XHRyZXR1cm4gJFxuXG5cdFx0IyAtLS0gV2UgaGF2ZSBhIG1hdGNoXG5cdFx0bm9kZSA6PSByZWR1Y2VyKCQsICRuZXh0KVxuXHRcdGlmIGRlZmluZWQobm9kZSlcblx0XHRcdGlmICRuZXh0LnN0YWNrXG5cdFx0XHRcdCRuZXh0LnN0YWNrLnB1c2ggbm9kZVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHQkbmV4dC5zdGFjayA9IFtub2RlXVxuXHRcdHJldHVybiAkbmV4dFxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgZ2V0TGluZUFuZENvbHVtbiA6PSAodGV4dDogc3RyaW5nLCBwb3M6IG51bWJlcikgPT5cblxuXHRjb3VudENoYXJzIDo9IChzdHI6IHN0cmluZywgY2g6IHN0cmluZyk6IG51bWJlciA9PlxuXHRcdGxldCBjb3VudCA9IDBcblx0XHRsZXQgcG9zID0gLTFcblx0XHR3aGlsZSAocG9zID0gc3RyLmluZGV4T2YoY2gsIHBvcysxKSkgIT0gLTFcblx0XHRcdGNvdW50ICs9IDFcblx0XHRyZXR1cm4gY291bnRcblxuXG5cdCMgLS0tIEdldCBsaW5lIG51bWJlciBieSBjb3VudGluZyBudW1iZXIgb2YgXFxuIGNoYXJzXG5cdCMgICAgICAgIGJlZm9yZSB0aGUgY3VycmVudCBwb3NpdGlvblxuXHQjICAgICBHZXQgY29sdW1uIG51bWJlciBieSBmaW5kaW5nIGNsb3Nlc3QgcHJldmlvdXMgcG9zaXRpb25cblx0IyAgICAgICAgb2YgYSBcXG4gYW5kIGNvbXB1dGluZyB0aGUgZGlmZmVyZW5jZVxuXG5cdHNob3J0U3RyIDo9IHRleHQuc3Vic3RyaW5nKDAsIHBvcylcblx0cmV0dXJuIFtcblx0XHRjb3VudENoYXJzKHNob3J0U3RyLCBcIlxcblwiKSArIDEsXG5cdFx0cG9zIC0gc2hvcnRTdHIubGFzdEluZGV4T2YoJ1xcbicpXG5cdFx0XVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgZnVuY3Rpb24gSWdub3JlKFxuXHRcdGxheFRvSWdub3JlOiBUTGF4UnVsZSxcblx0XHRsYXhSdWxlOiBUTGF4UnVsZVxuXHRcdCk6IFRSdWxlXG5cblx0cnVsZSA6PSBnZXRSdWxlIGxheFJ1bGVcblx0dG9JZ25vcmUgOj0gZ2V0UnVsZSBsYXhUb0lnbm9yZVxuXHRyZXR1cm4gKCQ6IFRTdGF0ZSkgPT5cblx0XHQkY3VyIDo9IHRvSWdub3JlKCQpXG5cdFx0JC5pZ25vcmUucHVzaCh0b0lnbm9yZSlcblx0XHQkbmV4dCA6PSBydWxlKCRjdXIpXG5cdFx0JC5pZ25vcmUucG9wKClcblx0XHRyZXR1cm4gKCRuZXh0ID09ICRjdXIpID8gJCA6IHRvSWdub3JlKCRuZXh0KVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAtLS0gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQ6XG4jICAgICAgICAxLiBhY2NlcHRzIGEgc3RyaW5nXG4jICAgICAgICAyLiByZXR1cm5zIHZvaWRcblxudHlwZSBUUGFyc2VyID0gKHN0cjogc3RyaW5nKSA9PiB2b2lkXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJzZXI8VD4oXG5cdFx0bGF4UnVsZTogVExheFJ1bGVcblx0XHRoT3B0aW9uczogaGFzaCA9IHt9XG5cdFx0KTogVFBhcnNlclxuXG5cdHtwb3MsIHBhcnRpYWwsIHJlU2tpcH0gOj0gZ2V0T3B0aW9ucyBoT3B0aW9ucywge1xuXHRcdHBvczogMFxuXHRcdHBhcnRpYWw6IGZhbHNlXG5cdFx0cmVTa2lwOiAvXlxccysvXG5cdFx0fVxuXHRydWxlIDo9IGdldFJ1bGUgbGF4UnVsZVxuXG5cdHJldHVybiAodGV4dDogc3RyaW5nKTogVD8gPT5cblx0XHQkIDo9IHtcblx0XHRcdHRleHRcblx0XHRcdGlnbm9yZTogZGVmaW5lZChyZVNraXApID8gW1JlZ2V4TWF0Y2hlcihyZVNraXApXSA6IFtdXG5cdFx0XHRsTWF0Y2hlczogW11cblx0XHRcdHBvczogMFxuXHRcdFx0fVxuXHRcdCRuZXh0IDo9IHJ1bGUoJClcblxuXHRcdGlmICgkID09ICRuZXh0KVxuXHRcdFx0W2xpbmUsIGNvbHVtbl0gOj0gZ2V0TGluZUFuZENvbHVtbih0ZXh0LCAkLnBvcylcblx0XHRcdHRocm93IG5ldyBTeW50YXhFcnJvcihcIlwiXCJcblx0XHRcdFx0Tm8gbWF0Y2ggYXQgcG9zICN7JC5wb3N9XG5cdFx0XHRcdFJlbWFpbmRlcjogI3tlc2NhcGVTdHIodGV4dC5zbGljZSgkLnBvcykpfVxuXHRcdFx0XHRcIlwiXCIpXG5cdFx0aWYgbm90IHBhcnRpYWwgJiYgKCRuZXh0LnBvcyA8IHRleHQubGVuZ3RoKVxuXHRcdFx0IyAtLS0gTm90IGFsbCBpbnB1dCBjb25zdW1lZFxuXHRcdFx0W2xpbmUsIGNvbHVtbl0gOj0gZ2V0TGluZUFuZENvbHVtbih0ZXh0LCAkLnBvcylcblx0XHRcdHRocm93IG5ldyBTeW50YXhFcnJvcihcIlwiXCJcblx0XHRcdFx0U3RvcHBlZCBhdCBwb3MgI3skLnBvc31cblx0XHRcdFx0UmVtYWluZGVyOiAje2VzY2FwZVN0cih0ZXh0LnNsaWNlKCQucG9zKSl9XG5cdFx0XHRcdFwiXCJcIilcblx0XHRyZXR1cm4gJG5leHQuc3RhY2sgPyAkbmV4dC5zdGFja1swXSA6IHVuZGVmXG4iXX0=