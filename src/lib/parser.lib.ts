"use strict";
// parser.lib.civet

import {sprintf} from "@std/fmt/printf"

import {
	undef, defined, notdefined,
	array, hash, isEmpty, nonEmpty,
	} from './datatypes.lib.ts'
import {
	getOptions, escapeStr, spaces,
	} from './llutils.lib.ts'
import {logIndent} from './log-formatter.lib.ts'
import {
	getLogLevel, setLogLevel,
	DBG, INDENT, UNDENT,
	TFormatter, TreeLogger,
	} from './logger.lib.ts'

// ---------------------------------------------------------------------------

export type TState = {
	text: string
	pos: number

	// --- optional fields
	skipRule?: TRule
	lMatches?: string[]
	stack?: any[]
	logr?: TreeLogger<[TState,TState]>
	}

export const isFinished = ($: TState): boolean => {
	const {text, pos, skipRule} = $
	if (pos === text.length) {
		return true
	}
	else if (skipRule) {
		// --- try running skip rule
		delete $.skipRule     // prevent rule running the skip rule
		const $next = skipRule($)
		if (defined($next)) {
			return ($next.pos === $next.text.length)
		}
		else {
			return false
		}
	}
	else {
		return false
	}
}

export type TRule = ($: TState) => (TState | undefined)

// --- Anything that can be converted to a TRule
type TLaxRule = (string | RegExp | TRule)

// ---------------------------------------------------------------------------

export const getNewState = (
		text: string,
		pos: number = 0
		): TState => {

	return {
		text,
		pos
		}
}

// ---------------------------------------------------------------------------

const nbuf = 24

const DBGMATCH = (
		desc: string,    // Describe what we're trying to match
		$: TState,
		$next: TState
		): void => {

	const str = escapeStr($.text.substring($.pos, $next.pos))
	const buf = spaces(nbuf - str.length - 1 - 3*logIndent)
	DBG(`[+${sprintf('%3d', $.pos)}] ${str}${buf}${desc}`)
	return
}

// ---------------------------------------------------------------------------

const DBGNOMATCH = (
		desc: string,    // Describe what we're trying to match
		$: TState
		): void => {

	const buf = spaces(nbuf - 3*logIndent)
	DBG(`[-${sprintf('%3d', $.pos)}]${buf}${desc}`)
	return
}

// ---------------------------------------------------------------------------
// --- returns $ if no skip rule OR rule doesn't match

const skipIgnored = ($: TState): TState => {

	// --- Will always return a defined value
	const {skipRule} = $
	if (notdefined(skipRule)) {
		return $
	}
	// --- make sure skip is only tried once
	delete ($.skipRule)
	const $next = skipRule($)
	if (defined($next)) {
		$.skipRule = skipRule    // still need to restore
		return Object.assign($next, {skipRule})
	}
	else {
		return Object.assign($, {skipRule})
	}
}

// ---------------------------------------------------------------------------

export const RegexMatcher = (re: RegExp): TRule => {

	return ($: TState): (TState | undefined) => {

		const $cur = skipIgnored($)
		const lMatches = re.exec($cur.text.substring($cur.pos))
		if (defined(lMatches)) {

			// --- Token is matched, add matches to state,
			//     return the next state
			const numChars = lMatches[0].length
			const $next = {
				...$cur,
				pos: $cur.pos + numChars,
				}
			$.lMatches = lMatches
			DBGMATCH(re.toString(), $cur, $next)
			return $next
		}
		else {
			DBGNOMATCH(re.toString(), $cur)
			return undef
		}
	}
}

// ---------------------------------------------------------------------------

export const StringMatcher = (str: string): TRule => {

	return ($: TState): (TState | undefined) => {

		const $cur = skipIgnored($)
		if ($cur.text.startsWith(str, $cur.pos)) {
			const $next = {
				...$cur,
				pos: $cur.pos + str.length
				}
			DBGMATCH(`'${escapeStr(str)}'`, $cur, $next)
			return $next
		}
		else {
			DBGNOMATCH(`'${escapeStr(str)}'`, $cur)
			return undef
		}
	}
}

// ---------------------------------------------------------------------------

export function getRule(rule: TLaxRule): TRule {

	if (typeof (rule) === 'function') {
		return rule
	}
	if (rule instanceof RegExp) {
		return RegexMatcher(rule)
	}
	if (typeof (rule) === 'string') {
		return StringMatcher(rule)
	}
	throw new Error(`Invalid rule: ${rule}`)
}

// ---------------------------------------------------------------------------
// --- Match a sequence of rules left to right

export function All(lLaxRules: TLaxRule[]): TRule {

	const lRules = lLaxRules.map(getRule)
	return ($) => {
		DBG("&", INDENT)
		let i1 = 0;for (const rule of lRules) {const i = i1++;
			DBG("-----")
			const $next = rule($)
			if (notdefined($next)) {
				DBG('FAIL', UNDENT)
				return undef
			}
			$ = $next
		}

		DBG('OK', UNDENT)
		return $
	}
}

// ---------------------------------------------------------------------------
// --- Match any of the rules, check left to right

export function Any(lLaxRules: TLaxRule[]): TRule {

	const lRules = lLaxRules.map(getRule)
	return ($) => {
		DBG("|", INDENT)
		let i2 = 0;for (const rule of lRules) {const i = i2++;
			DBG("-----")
			const $next = rule($)
			if (defined($next)) {
				DBG('OK', UNDENT)
				return $next
			}
		}
		DBG('FAIL', UNDENT)
		return undef
	}
}

// ---------------------------------------------------------------------------
// --- Match a rule 1 or more times

export function Plus(laxRule: TLaxRule): TRule {

	const rule = getRule(laxRule)
	return ($) => {
		DBG("+", INDENT)
		const $first = rule($)
		if (notdefined($first)) {
			DBG("FAIL", UNDENT)
			return undef
		}
		$ = $first
		while(true) {
			const $next = rule($)
			if (notdefined($next)) {
				DBG("OK", UNDENT)
				return $next
			}
			$ = $next
		}
	}
}

// ---------------------------------------------------------------------------
// --- Match a rule optionally

export function Optional(laxRule: TLaxRule): TRule {

	const rule = getRule(laxRule)
	return ($) => {
		DBG("?", INDENT)
		const $next = rule($)
		if (defined($next)) {
			DBG("OK - matched", UNDENT)
			return $next
		}
		else {
			// --- Still succeed since it was optional
			DBG("OK - not matched", UNDENT)
			return $
		}
	}
}

// ---------------------------------------------------------------------------

export function Star(laxRule: TLaxRule): TRule {

	const rule = getRule(laxRule)
	return ($) => {
		DBG("*", INDENT)
		while(true) {
			const $next = rule($)
			if (notdefined($next)) {
				DBG("OK", UNDENT)
				return $
			}
			$ = $next
		}
	}
}

// ---------------------------------------------------------------------------

type TReducer<T> = (
	$: TState,
	$next: TState
	) => (T | undefined)

export function Node<T>(
		laxRule: TLaxRule,
		reducer: TReducer<T>
		): TRule {

	const rule = getRule(laxRule)
	return ($) => {
		const $next = rule($)
		if (notdefined($next)) {
			return $
		}

		// --- We have a match
		const node = reducer($, $next)
		if (defined(node)) {
			if ($next.stack) {
				$next.stack.push(node)
			}
			else {
				$next.stack = [node]
			}
		}
		return $next
	}
}

// ---------------------------------------------------------------------------

export const getLineAndColumn = (text: string, pos: number) => {

	const countChars = (str: string, ch: string): number => {
		let count = 0
		let pos = -1
		while ((pos = str.indexOf(ch, pos+1)) !== -1) {
			count += 1
		}
		return count
	}


	// --- Get line number by counting number of \n chars
	//        before the current position
	//     Get column number by finding closest previous position
	//        of a \n and computing the difference

	const shortStr = text.substring(0, pos)
	return [
		countChars(shortStr, "\n") + 1,
		pos - shortStr.lastIndexOf('\n')
		]
}

// ---------------------------------------------------------------------------
// --- Returns a function that:
//        1. accepts a string
//        2. returns given type

type TParser<T> = (str: string) => (T | undefined)

export function getParser<T>(
		laxRule: TLaxRule,
		hOptions: hash = {}
		): TParser<T> {

	const {pos, partial, reSkip} = getOptions(hOptions, {
		pos: 0,
		partial: false,
		reSkip: /^\s+/
		})
	const rule = getRule(laxRule)

	return (text: string): (T | undefined) => {
		DBG(`parse ${escapeStr(text)}`)
		const skipRule = defined(reSkip) ? RegexMatcher(reSkip) : undef
		debugger
		const $ = {
			text,
			pos: 0,
			skipRule
			}

		const $next = rule($)

		if (defined($next) && (isFinished($next) || partial)) {
			return $next.stack ? $next.stack[0] : undef
		}
		else {
			const [line, column] = getLineAndColumn(text, $.pos)
			throw new SyntaxError(`No match at pos ${$.pos}
Remainder: ${escapeStr(text.slice($.pos))}`)
		}
	}
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9wYXJzZXIubGliLmNpdmV0LnRzeCIsInNvdXJjZXMiOlsic3JjL2xpYi9wYXJzZXIubGliLmNpdmV0Il0sIm1hcHBpbmdzIjoiO0FBQUEsbUJBQWtCO0FBQ2xCLEFBQUE7QUFDQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUI7QUFDdkMsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDO0FBQzVCLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQ2hDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0I7QUFDNUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLENBQUM7QUFDL0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQjtBQUMxQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QjtBQUNoRCxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsQ0FBQztBQUMxQixDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUNyQixDQUFDLFVBQVUsQ0FBQyxDQUFDLFVBQVUsQ0FBQztBQUN4QixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCO0FBQ3pCLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3RCLEFBQUEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNO0FBQ2IsQUFBQSxDQUFD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VyxDQUFDLENBQUcsZ0JBQ1IsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQzVCLFdBQWUsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxBQUMxQyxDQUFHLEM7RUFBQyxDO0NBQUEsQztBQUFBLENBQUE7QUFDUiIsIm5hbWVzIjpbXSwic291cmNlc0NvbnRlbnQiOlsiIyBwYXJzZXIubGliLmNpdmV0XG5cbmltcG9ydCB7c3ByaW50Zn0gZnJvbSBcIkBzdGQvZm10L3ByaW50ZlwiXG5cbmltcG9ydCB7XG5cdHVuZGVmLCBkZWZpbmVkLCBub3RkZWZpbmVkLFxuXHRhcnJheSwgaGFzaCwgaXNFbXB0eSwgbm9uRW1wdHksXG5cdH0gZnJvbSAnLi9kYXRhdHlwZXMubGliLnRzJ1xuaW1wb3J0IHtcblx0Z2V0T3B0aW9ucywgZXNjYXBlU3RyLCBzcGFjZXMsXG5cdH0gZnJvbSAnLi9sbHV0aWxzLmxpYi50cydcbmltcG9ydCB7bG9nSW5kZW50fSBmcm9tICcuL2xvZy1mb3JtYXR0ZXIubGliLnRzJ1xuaW1wb3J0IHtcblx0Z2V0TG9nTGV2ZWwsIHNldExvZ0xldmVsLFxuXHREQkcsIElOREVOVCwgVU5ERU5ULFxuXHRURm9ybWF0dGVyLCBUcmVlTG9nZ2VyLFxuXHR9IGZyb20gJy4vbG9nZ2VyLmxpYi50cydcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IHR5cGUgVFN0YXRlID0ge1xuXHR0ZXh0OiBzdHJpbmdcblx0cG9zOiBudW1iZXJcblxuXHQjIC0tLSBvcHRpb25hbCBmaWVsZHNcblx0c2tpcFJ1bGU/OiBUUnVsZVxuXHRsTWF0Y2hlcz86IHN0cmluZ1tdXG5cdHN0YWNrPzogYW55W11cblx0bG9ncj86IFRyZWVMb2dnZXI8W1RTdGF0ZSxUU3RhdGVdPlxuXHR9XG5cbmV4cG9ydCBpc0ZpbmlzaGVkIDo9ICgkOiBUU3RhdGUpOiBib29sZWFuID0+XG5cdHt0ZXh0LCBwb3MsIHNraXBSdWxlfSA6PSAkXG5cdGlmIChwb3MgPT0gdGV4dC5sZW5ndGgpXG5cdFx0cmV0dXJuIHRydWVcblx0ZWxzZSBpZiAoc2tpcFJ1bGUpXG5cdFx0IyAtLS0gdHJ5IHJ1bm5pbmcgc2tpcCBydWxlXG5cdFx0ZGVsZXRlICQuc2tpcFJ1bGUgICAgICMgcHJldmVudCBydWxlIHJ1bm5pbmcgdGhlIHNraXAgcnVsZVxuXHRcdCRuZXh0IDo9IHNraXBSdWxlKCQpXG5cdFx0aWYgZGVmaW5lZCgkbmV4dClcblx0XHRcdHJldHVybiAoJG5leHQucG9zID09ICRuZXh0LnRleHQubGVuZ3RoKVxuXHRcdGVsc2Vcblx0XHRcdHJldHVybiBmYWxzZVxuXHRlbHNlXG5cdFx0cmV0dXJuIGZhbHNlXG5cbmV4cG9ydCB0eXBlIFRSdWxlID0gKCQ6IFRTdGF0ZSkgPT4gVFN0YXRlP1xuXG4jIC0tLSBBbnl0aGluZyB0aGF0IGNhbiBiZSBjb252ZXJ0ZWQgdG8gYSBUUnVsZVxudHlwZSBUTGF4UnVsZSA9IChzdHJpbmcgfCBSZWdFeHAgfCBUUnVsZSlcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGdldE5ld1N0YXRlIDo9IChcblx0XHR0ZXh0OiBzdHJpbmdcblx0XHRwb3M6IG51bWJlciA9IDBcblx0XHQpOiBUU3RhdGUgPT5cblxuXHRyZXR1cm4ge1xuXHRcdHRleHRcblx0XHRwb3Ncblx0XHR9XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbm5idWYgOj0gMjRcblxuREJHTUFUQ0ggOj0gKFxuXHRcdGRlc2M6IHN0cmluZyAgICAjIERlc2NyaWJlIHdoYXQgd2UncmUgdHJ5aW5nIHRvIG1hdGNoXG5cdFx0JDogVFN0YXRlXG5cdFx0JG5leHQ6IFRTdGF0ZVxuXHRcdCk6IHZvaWQgPT5cblxuXHRzdHIgOj0gZXNjYXBlU3RyKCQudGV4dC5zdWJzdHJpbmcoJC5wb3MsICRuZXh0LnBvcykpXG5cdGJ1ZiA6PSBzcGFjZXMobmJ1ZiAtIHN0ci5sZW5ndGggLSAxIC0gMypsb2dJbmRlbnQpXG5cdERCRyBcIlsrI3tzcHJpbnRmKCclM2QnLCAkLnBvcyl9XSAje3N0cn0je2J1Zn0je2Rlc2N9XCJcblx0cmV0dXJuXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbkRCR05PTUFUQ0ggOj0gKFxuXHRcdGRlc2M6IHN0cmluZyAgICAjIERlc2NyaWJlIHdoYXQgd2UncmUgdHJ5aW5nIHRvIG1hdGNoXG5cdFx0JDogVFN0YXRlXG5cdFx0KTogdm9pZCA9PlxuXG5cdGJ1ZiA6PSBzcGFjZXMobmJ1ZiAtIDMqbG9nSW5kZW50KVxuXHREQkcgXCJbLSN7c3ByaW50ZignJTNkJywgJC5wb3MpfV0je2J1Zn0je2Rlc2N9XCJcblx0cmV0dXJuXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIC0tLSByZXR1cm5zICQgaWYgbm8gc2tpcCBydWxlIE9SIHJ1bGUgZG9lc24ndCBtYXRjaFxuXG5za2lwSWdub3JlZCA6PSAoJDogVFN0YXRlKTogVFN0YXRlID0+XG5cblx0IyAtLS0gV2lsbCBhbHdheXMgcmV0dXJuIGEgZGVmaW5lZCB2YWx1ZVxuXHR7c2tpcFJ1bGV9IDo9ICRcblx0aWYgbm90ZGVmaW5lZChza2lwUnVsZSlcblx0XHRyZXR1cm4gJFxuXHQjIC0tLSBtYWtlIHN1cmUgc2tpcCBpcyBvbmx5IHRyaWVkIG9uY2Vcblx0ZGVsZXRlKCQuc2tpcFJ1bGUpXG5cdCRuZXh0IDo9IHNraXBSdWxlKCQpXG5cdGlmIGRlZmluZWQoJG5leHQpXG5cdFx0JC5za2lwUnVsZSA9IHNraXBSdWxlICAgICMgc3RpbGwgbmVlZCB0byByZXN0b3JlXG5cdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24gJG5leHQsIHtza2lwUnVsZX1cblx0ZWxzZVxuXHRcdHJldHVybiBPYmplY3QuYXNzaWduICQsIHtza2lwUnVsZX1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IFJlZ2V4TWF0Y2hlciA6PSAocmU6IFJlZ0V4cCk6IFRSdWxlID0+XG5cblx0cmV0dXJuICgkOiBUU3RhdGUpOiBUU3RhdGU/ID0+XG5cblx0XHQkY3VyIDo9IHNraXBJZ25vcmVkKCQpXG5cdFx0bE1hdGNoZXMgOj0gcmUuZXhlYygkY3VyLnRleHQuc3Vic3RyaW5nKCRjdXIucG9zKSlcblx0XHRpZiBkZWZpbmVkKGxNYXRjaGVzKVxuXG5cdFx0XHQjIC0tLSBUb2tlbiBpcyBtYXRjaGVkLCBhZGQgbWF0Y2hlcyB0byBzdGF0ZSxcblx0XHRcdCMgICAgIHJldHVybiB0aGUgbmV4dCBzdGF0ZVxuXHRcdFx0bnVtQ2hhcnMgOj0gbE1hdGNoZXNbMF0ubGVuZ3RoXG5cdFx0XHQkbmV4dCA6PSB7XG5cdFx0XHRcdC4uLiRjdXIsXG5cdFx0XHRcdHBvczogJGN1ci5wb3MgKyBudW1DaGFycyxcblx0XHRcdFx0fVxuXHRcdFx0JC5sTWF0Y2hlcyA9IGxNYXRjaGVzXG5cdFx0XHREQkdNQVRDSCByZS50b1N0cmluZygpLCAkY3VyLCAkbmV4dFxuXHRcdFx0cmV0dXJuICRuZXh0XG5cdFx0ZWxzZVxuXHRcdFx0REJHTk9NQVRDSCByZS50b1N0cmluZygpLCAkY3VyXG5cdFx0XHRyZXR1cm4gdW5kZWZcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IFN0cmluZ01hdGNoZXIgOj0gKHN0cjogc3RyaW5nKTogVFJ1bGUgPT5cblxuXHRyZXR1cm4gKCQ6IFRTdGF0ZSk6IFRTdGF0ZT8gPT5cblxuXHRcdCRjdXIgOj0gc2tpcElnbm9yZWQoJClcblx0XHRpZiAoJGN1ci50ZXh0LnN0YXJ0c1dpdGgoc3RyLCAkY3VyLnBvcykpXG5cdFx0XHQkbmV4dCA6PSB7XG5cdFx0XHRcdC4uLiRjdXIsXG5cdFx0XHRcdHBvczogJGN1ci5wb3MgKyBzdHIubGVuZ3RoXG5cdFx0XHRcdH1cblx0XHRcdERCR01BVENIIFwiJyN7ZXNjYXBlU3RyKHN0cil9J1wiLCAkY3VyLCAkbmV4dFxuXHRcdFx0cmV0dXJuICRuZXh0XG5cdFx0ZWxzZVxuXHRcdFx0REJHTk9NQVRDSCBcIicje2VzY2FwZVN0cihzdHIpfSdcIiwgJGN1clxuXHRcdFx0cmV0dXJuIHVuZGVmXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSdWxlKHJ1bGU6IFRMYXhSdWxlKTogVFJ1bGVcblxuXHRpZiAodHlwZW9mKHJ1bGUpID09ICdmdW5jdGlvbicpXG5cdFx0cmV0dXJuIHJ1bGVcblx0aWYgKHJ1bGUgaW5zdGFuY2VvZiBSZWdFeHApXG5cdFx0cmV0dXJuIFJlZ2V4TWF0Y2hlcihydWxlKVxuXHRpZiAodHlwZW9mKHJ1bGUpID09ICdzdHJpbmcnKVxuXHRcdHJldHVybiBTdHJpbmdNYXRjaGVyKHJ1bGUpXG5cdHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcnVsZTogI3tydWxlfVwiKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAtLS0gTWF0Y2ggYSBzZXF1ZW5jZSBvZiBydWxlcyBsZWZ0IHRvIHJpZ2h0XG5cbmV4cG9ydCBmdW5jdGlvbiBBbGwobExheFJ1bGVzOiBUTGF4UnVsZVtdKTogVFJ1bGVcblxuXHRsUnVsZXMgOj0gbExheFJ1bGVzLm1hcChnZXRSdWxlKVxuXHRyZXR1cm4gKCQpID0+XG5cdFx0REJHIFwiJlwiLCBJTkRFTlRcblx0XHRmb3IgcnVsZSxpIG9mIGxSdWxlc1xuXHRcdFx0REJHIFwiLS0tLS1cIlxuXHRcdFx0JG5leHQgOj0gcnVsZSgkKVxuXHRcdFx0aWYgbm90ZGVmaW5lZCgkbmV4dClcblx0XHRcdFx0REJHICdGQUlMJywgVU5ERU5UXG5cdFx0XHRcdHJldHVybiB1bmRlZlxuXHRcdFx0JCA9ICRuZXh0XG5cblx0XHREQkcgJ09LJywgVU5ERU5UXG5cdFx0cmV0dXJuICRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIE1hdGNoIGFueSBvZiB0aGUgcnVsZXMsIGNoZWNrIGxlZnQgdG8gcmlnaHRcblxuZXhwb3J0IGZ1bmN0aW9uIEFueShsTGF4UnVsZXM6IFRMYXhSdWxlW10pOiBUUnVsZVxuXG5cdGxSdWxlcyA6PSBsTGF4UnVsZXMubWFwKGdldFJ1bGUpXG5cdHJldHVybiAoJCkgPT5cblx0XHREQkcgXCJ8XCIsIElOREVOVFxuXHRcdGZvciBydWxlLGkgb2YgbFJ1bGVzXG5cdFx0XHREQkcgXCItLS0tLVwiXG5cdFx0XHQkbmV4dCA6PSBydWxlKCQpXG5cdFx0XHRpZiBkZWZpbmVkKCRuZXh0KVxuXHRcdFx0XHREQkcgJ09LJywgVU5ERU5UXG5cdFx0XHRcdHJldHVybiAkbmV4dFxuXHRcdERCRyAnRkFJTCcsIFVOREVOVFxuXHRcdHJldHVybiB1bmRlZlxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAtLS0gTWF0Y2ggYSBydWxlIDEgb3IgbW9yZSB0aW1lc1xuXG5leHBvcnQgZnVuY3Rpb24gUGx1cyhsYXhSdWxlOiBUTGF4UnVsZSk6IFRSdWxlXG5cblx0cnVsZSA6PSBnZXRSdWxlKGxheFJ1bGUpXG5cdHJldHVybiAoJCkgPT5cblx0XHREQkcgXCIrXCIsIElOREVOVFxuXHRcdCRmaXJzdCA6PSBydWxlKCQpXG5cdFx0aWYgbm90ZGVmaW5lZCgkZmlyc3QpXG5cdFx0XHREQkcgXCJGQUlMXCIsIFVOREVOVFxuXHRcdFx0cmV0dXJuIHVuZGVmXG5cdFx0JCA9ICRmaXJzdFxuXHRcdGxvb3Bcblx0XHRcdCRuZXh0IDo9IHJ1bGUoJClcblx0XHRcdGlmIG5vdGRlZmluZWQoJG5leHQpXG5cdFx0XHRcdERCRyBcIk9LXCIsIFVOREVOVFxuXHRcdFx0XHRyZXR1cm4gJG5leHRcblx0XHRcdCQgPSAkbmV4dFxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAtLS0gTWF0Y2ggYSBydWxlIG9wdGlvbmFsbHlcblxuZXhwb3J0IGZ1bmN0aW9uIE9wdGlvbmFsKGxheFJ1bGU6IFRMYXhSdWxlKTogVFJ1bGVcblxuXHRydWxlIDo9IGdldFJ1bGUobGF4UnVsZSlcblx0cmV0dXJuICgkKSA9PlxuXHRcdERCRyBcIj9cIiwgSU5ERU5UXG5cdFx0JG5leHQgOj0gcnVsZSgkKVxuXHRcdGlmIGRlZmluZWQoJG5leHQpXG5cdFx0XHREQkcgXCJPSyAtIG1hdGNoZWRcIiwgVU5ERU5UXG5cdFx0XHRyZXR1cm4gJG5leHRcblx0XHRlbHNlXG5cdFx0XHQjIC0tLSBTdGlsbCBzdWNjZWVkIHNpbmNlIGl0IHdhcyBvcHRpb25hbFxuXHRcdFx0REJHIFwiT0sgLSBub3QgbWF0Y2hlZFwiLCBVTkRFTlRcblx0XHRcdHJldHVybiAkXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBmdW5jdGlvbiBTdGFyKGxheFJ1bGU6IFRMYXhSdWxlKTogVFJ1bGVcblxuXHRydWxlIDo9IGdldFJ1bGUobGF4UnVsZSlcblx0cmV0dXJuICgkKSA9PlxuXHRcdERCRyBcIipcIiwgSU5ERU5UXG5cdFx0bG9vcFxuXHRcdFx0JG5leHQgOj0gcnVsZSgkKVxuXHRcdFx0aWYgbm90ZGVmaW5lZCgkbmV4dClcblx0XHRcdFx0REJHIFwiT0tcIiwgVU5ERU5UXG5cdFx0XHRcdHJldHVybiAkXG5cdFx0XHQkID0gJG5leHRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxudHlwZSBUUmVkdWNlcjxUPiA9IChcblx0JDogVFN0YXRlXG5cdCRuZXh0OiBUU3RhdGVcblx0KSA9PiBUP1xuXG5leHBvcnQgZnVuY3Rpb24gTm9kZTxUPihcblx0XHRsYXhSdWxlOiBUTGF4UnVsZSxcblx0XHRyZWR1Y2VyOiBUUmVkdWNlcjxUPlxuXHRcdCk6IFRSdWxlXG5cblx0cnVsZSA6PSBnZXRSdWxlIGxheFJ1bGVcblx0cmV0dXJuICgkKSA9PlxuXHRcdCRuZXh0IDo9IHJ1bGUoJClcblx0XHRpZiBub3RkZWZpbmVkKCRuZXh0KVxuXHRcdFx0cmV0dXJuICRcblxuXHRcdCMgLS0tIFdlIGhhdmUgYSBtYXRjaFxuXHRcdG5vZGUgOj0gcmVkdWNlcigkLCAkbmV4dClcblx0XHRpZiBkZWZpbmVkKG5vZGUpXG5cdFx0XHRpZiAkbmV4dC5zdGFja1xuXHRcdFx0XHQkbmV4dC5zdGFjay5wdXNoIG5vZGVcblx0XHRcdGVsc2Vcblx0XHRcdFx0JG5leHQuc3RhY2sgPSBbbm9kZV1cblx0XHRyZXR1cm4gJG5leHRcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGdldExpbmVBbmRDb2x1bW4gOj0gKHRleHQ6IHN0cmluZywgcG9zOiBudW1iZXIpID0+XG5cblx0Y291bnRDaGFycyA6PSAoc3RyOiBzdHJpbmcsIGNoOiBzdHJpbmcpOiBudW1iZXIgPT5cblx0XHRsZXQgY291bnQgPSAwXG5cdFx0bGV0IHBvcyA9IC0xXG5cdFx0d2hpbGUgKHBvcyA9IHN0ci5pbmRleE9mKGNoLCBwb3MrMSkpICE9IC0xXG5cdFx0XHRjb3VudCArPSAxXG5cdFx0cmV0dXJuIGNvdW50XG5cblxuXHQjIC0tLSBHZXQgbGluZSBudW1iZXIgYnkgY291bnRpbmcgbnVtYmVyIG9mIFxcbiBjaGFyc1xuXHQjICAgICAgICBiZWZvcmUgdGhlIGN1cnJlbnQgcG9zaXRpb25cblx0IyAgICAgR2V0IGNvbHVtbiBudW1iZXIgYnkgZmluZGluZyBjbG9zZXN0IHByZXZpb3VzIHBvc2l0aW9uXG5cdCMgICAgICAgIG9mIGEgXFxuIGFuZCBjb21wdXRpbmcgdGhlIGRpZmZlcmVuY2VcblxuXHRzaG9ydFN0ciA6PSB0ZXh0LnN1YnN0cmluZygwLCBwb3MpXG5cdHJldHVybiBbXG5cdFx0Y291bnRDaGFycyhzaG9ydFN0ciwgXCJcXG5cIikgKyAxLFxuXHRcdHBvcyAtIHNob3J0U3RyLmxhc3RJbmRleE9mKCdcXG4nKVxuXHRcdF1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0OlxuIyAgICAgICAgMS4gYWNjZXB0cyBhIHN0cmluZ1xuIyAgICAgICAgMi4gcmV0dXJucyBnaXZlbiB0eXBlXG5cbnR5cGUgVFBhcnNlcjxUPiA9IChzdHI6IHN0cmluZykgPT4gVD9cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBhcnNlcjxUPihcblx0XHRsYXhSdWxlOiBUTGF4UnVsZVxuXHRcdGhPcHRpb25zOiBoYXNoID0ge31cblx0XHQpOiBUUGFyc2VyPFQ+XG5cblx0e3BvcywgcGFydGlhbCwgcmVTa2lwfSA6PSBnZXRPcHRpb25zIGhPcHRpb25zLCB7XG5cdFx0cG9zOiAwXG5cdFx0cGFydGlhbDogZmFsc2Vcblx0XHRyZVNraXA6IC9eXFxzKy9cblx0XHR9XG5cdHJ1bGUgOj0gZ2V0UnVsZSBsYXhSdWxlXG5cblx0cmV0dXJuICh0ZXh0OiBzdHJpbmcpOiBUPyA9PlxuXHRcdERCRyBcInBhcnNlICN7ZXNjYXBlU3RyKHRleHQpfVwiXG5cdFx0c2tpcFJ1bGUgOj0gZGVmaW5lZChyZVNraXApID8gUmVnZXhNYXRjaGVyKHJlU2tpcCkgOiB1bmRlZlxuXHRcdGRlYnVnZ2VyXG5cdFx0JCA6PSB7XG5cdFx0XHR0ZXh0XG5cdFx0XHRwb3M6IDBcblx0XHRcdHNraXBSdWxlXG5cdFx0XHR9XG5cblx0XHQkbmV4dCA6PSBydWxlKCQpXG5cblx0XHRpZiBkZWZpbmVkKCRuZXh0KSAmJiAoaXNGaW5pc2hlZCgkbmV4dCkgfHwgcGFydGlhbClcblx0XHRcdHJldHVybiAkbmV4dC5zdGFjayA/ICRuZXh0LnN0YWNrWzBdIDogdW5kZWZcblx0XHRlbHNlXG5cdFx0XHRbbGluZSwgY29sdW1uXSA6PSBnZXRMaW5lQW5kQ29sdW1uKHRleHQsICQucG9zKVxuXHRcdFx0dGhyb3cgbmV3IFN5bnRheEVycm9yKFwiXCJcIlxuXHRcdFx0XHRObyBtYXRjaCBhdCBwb3MgI3skLnBvc31cblx0XHRcdFx0UmVtYWluZGVyOiAje2VzY2FwZVN0cih0ZXh0LnNsaWNlKCQucG9zKSl9XG5cdFx0XHRcdFwiXCJcIilcbiJdfQ==