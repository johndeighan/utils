"use strict";
// logger.lib.civet

import {
	existsSync,
	} from '@std/fs'
import {LogLevels} from "@std/log/levels"
import {
	ConsoleHandler, FileHandler, setup, getLogger, LogRecord,
	} from '@std/log'

import {
	getPrefix,
	} from './unicode.lib.ts'
import {
	undef, defined, notdefined, hash, isString, nonEmpty,
	} from './datatypes.lib.ts'
import {
	spaces, o, sinceLoadStr, getOptions, OL, ML, pass, croak,
	} from './llutils.lib.ts'
import {
	TLogLevel, isLogLevel, getLogLevel, setLogLevel,
	pushLogLevel, popLogLevel, resetLogLevel,
	isInactiveLevel,
	} from './log-levels.lib.ts'
import {
	getFormatter, indentLog, undentLog,
	getConsoleLog, clearConsoleLog, logIndent,
	} from './log-formatter.lib.ts'

export {
	getLogLevel, isLogLevel, setLogLevel,
	pushLogLevel, popLogLevel,
	indentLog, undentLog,
	clearConsoleLog, getConsoleLog,
	}
export type {TLogLevel}

// ---------------------------------------------------------------------------

const mainModule: string = new URL(Deno.mainModule).pathname.slice(1)

const logFileName = (() => {
	const lMatches = mainModule.match(/[A-Za-z0-9_\-\.]+$/)
	if (defined(lMatches)) {
		const label = lMatches[0].replaceAll('.', '_')
		const time = new Date().toISOString().replaceAll(':','-')
		return `logs/${label} ${time}.log`
	}
	else {
		return "logs/dummy.log"
	}
}
	)()

// ---------------------------------------------------------------------------

export const getLog = (from: string): string => {

	switch(from) {
		case 'console': {
			return getConsoleLog()
		}
		case 'file': {
			if (existsSync(logFileName)) {
				const data = Deno.readFileSync(logFileName)
				const decoder = new TextDecoder("utf-8")
				return decoder.decode(data)
			}
			else {
				return ''
			}
		}
		default: {
			croak(`getLog(): invalid from = ${from}`)
			return ''
		}
	}
}

// ---------------------------------------------------------------------------

export const clearLog = (which: string): void => {

	switch(which) {
		case 'console': {
			clearConsoleLog();break;
		}
		case 'file': {
			const encoder = new TextEncoder();
			const str = encoder.encode('')
			Deno.writeFileSync(logFileName, str);break;
		}
		case 'both': {
			clearConsoleLog()
			const encoder = new TextEncoder();
			const str = encoder.encode('')
			Deno.writeFileSync(logFileName, str);break;
		}
		default: {
			pass()
		}
	}
	return
}

// ---------------------------------------------------------------------------

const hConfig: hash = {

	handlers: {

		console: new ConsoleHandler('DEBUG', {
			formatter: getFormatter('$msg', 'console')
			}),

		file: new FileHandler('DEBUG', {
			filename: logFileName,
			mode: 'a',
			formatter: getFormatter('$ll $msg', 'file')
			}),

		console_prof: new ConsoleHandler('DEBUG', {
			formatter: getFormatter('[$ts] $msg', 'console')
			}),

		file_prof: new FileHandler('DEBUG', {
			filename: logFileName,
			mode: 'a',
			formatter: getFormatter('[$ts] $ll $msg', 'file')
			}),
	},

	// --- assign handlers to loggers
	//     order from most verbose to least verbose

	loggers: {
		profile: {
			level: "DEBUG",
			num: 1,
			handlers: ["console_prof", "file_prof"]
			},
		debug: {
			level: "DEBUG",
			num: 2,
			handlers: ["console", "file"]
			},
		info: {
			level: "INFO",
			num: 3,
			handlers: ["console", "file"]
			},
		warn: {
			level: "WARN",
			num: 4,
			handlers: ["console", "file"]
			},
		error: {
			level: "ERROR",
			num: 5,
			handlers: ["console", "file"]
			},
		file: {
			level: "DEBUG",
			num: 6,
			handlers: ["file"]
			},
		silent: {
			level: "ERROR",
			num: 7,
			handlers: []
			}
		}
	}

setup(hConfig)
const hLoggers = hConfig.loggers
const hHandlers = hConfig.handlers

export const INDENT = Symbol('indent')
export const UNDENT = Symbol('undent')

// ---------------------------------------------------------------------------

const output = (level: TLogLevel, lItems: any[]): void => {

	if (isInactiveLevel(level)) {
		return
	}

	let logger = getLogger(getLogLevel())
	for (const item of lItems) {
		switch(item) {
			case INDENT: {
				indentLog();break;
			}
			case UNDENT: {
				undentLog();break;
			}
			default: {
				const str = isString(item) ? item : ML(item)
				if (nonEmpty(str)) {
					switch(level) {
						case 'debug': { logger.debug(str);break;
						}
						case 'info': {  logger.info(str);break;
						}
						case 'warn': {  logger.warn(str);break;
						}
						case 'error': { logger.error(str);break;
						}
						default: { pass() }
					}
				}
			}
		}
	}

	return
}

// ---------------------------------------------------------------------------

export const DBG  = (...lItems: any[]): void => {
	output('debug', lItems)
	return
}

export const LOG  = (...lItems: any[]): void => {
	output('info', lItems)
	return
}

export const WARN = (...lItems: any[]): void => {
	output('warn', lItems)
	return
}

export const ERR  = (...lItems: any[]): void => {
	output('error', lItems)
	return
}

export const LOGVALUE = (label: string, value: any): void => {
	if (isInactiveLevel('info')) {
		return
	}
	LOG(`${label} = ${ML(value)}`)
	return
}

export const DBGVALUE = (label: string, value: any): void => {
	if (isInactiveLevel('debug')) {
		return
	}
	DBG(`${label} = ${ML(value)}`)
	return
}

// ---------------------------------------------------------------------------

export const removeLogFile = (): void => {

	Deno.removeSync(logFileName)
	return
}

// ---------------------------------------------------------------------------

export type TFormatter<T> = (desc: string, item: (T | undefined)) => string

export class TreeLogger<T> {

	// --- data fields
	indentLevel: number = 0
	logLevel: TLogLevel = 'debug'
	formatter: TFormatter<T>

	// --- methods
	constructor(
			formatter1 = (desc: string, item: (T | undefined)) => desc,
			logLevel: string = 'debug'
			) {
		this.formatter = formatter1;
		if (isLogLevel(logLevel)) {
			this.logLevel = logLevel
		}
	}

	start(desc: string, item: (T | undefined)=undef): void {
		const str = this.formatter(desc, item)
		const pre = getPrefix(this.indentLevel, 'plain')
		output(this.logLevel, [pre + str])
		this.indentLevel += 1
		return
	}

	log(desc: string, item: (T | undefined)=undef): void {
		const str = this.formatter(desc, item)
		const pre = getPrefix(this.indentLevel, 'plain')
		output(this.logLevel,  [pre + str])
		return
	}

	succeed(desc: string, item: (T | undefined)=undef): void {
		const str = this.formatter(desc, item)
		const pre = getPrefix(this.indentLevel, 'withArrow')
		output(this.logLevel,  [pre + str])
		this.indentLevel -= 1
		return
	}

	fail(desc: string, item: (T | undefined)=undef): void {
		const str = this.formatter(desc, item)
		const pre = getPrefix(this.indentLevel, 'withArrow')
		output(this.logLevel,  [pre + str])
		this.indentLevel -= 1
		return
	}
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9sb2dnZXIubGliLmNpdmV0LnRzeCIsInNvdXJjZXMiOlsic3JjL2xpYi9sb2dnZXIubGliLmNpdmV0Il0sIm1hcHBpbmdzIjoiO0FBQUEsbUJBQWtCO0FBQ2xCLEFBQUE7QUFDQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxVQUFVLENBQUM7QUFDWixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUztBQUNqQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUN6QyxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUMxRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVTtBQUNsQixBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxTQUFTLENBQUM7QUFDWCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCO0FBQzFCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQ3RELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0I7QUFDNUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUM7QUFDMUQsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQjtBQUMxQixBQUFBLEFBQUEsTUFBTSxDQUFDLENB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QTtBQUNBLEFBQUEsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztBQUN0QyxBQUFBLENBQUMsR0FBRyxDQUFDLENBQUEsTUFBQSxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQSxDQUFBLENBQUE7QUFDbkIsQUFBQSxFQUFFLE1BQU0sQ0FBQSxBQUFDLElBQUksQ0FBQSxDQUFBLENBQUE7QUFDYixBQUFBLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQSxDQUFBLENBQUE7QUFDZCxBQUFBLElBQUksU0FBUyxDQUFDLENBQUMsTztHQUFBLENBQUE7QUFDZixBQUFBLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQSxDQUFBLENBQUE7QUFDZCxBQUFBLElBQUksU0FBUyxDQUFDLENBQUMsTztHQUFBLENBQUE7QUFDZixBQUFBLEdBQUcsT0FBSSxDQUFBLENBQUEsQ0FBQTtBQUNQLEFBQUEsSUFBTyxNQUFILEdBQUcsQ0FBQyxDQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUM7QUFDM0MsQUFBQSxJQUFJLEdBQUcsQ0FBQSxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQ3BCLEFBQUEsS0FBSyxNQUFNLENBQUEsQUFBQyxLQUFLLENBQUEsQ0FBQSxDQUFBO0FBQ2pCLEFBQUEsTUFBTSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUEsQ0FBQSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUEsQUFBQyxHQUFHLENBQUEsTztNQUFBLENBQUE7QUFDcEMsQUFBQSxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQSxDQUFBLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQSxBQUFDLEdBQUcsQ0FBQSxPO01BQUEsQ0FBQTtBQUNuQyxBQUFBLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFBLENBQUEsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFBLEFBQUMsR0FBRyxDQUFBLE87TUFBQSxDQUFBO0FBQ25DLEFBQUEsTUFBTSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUEsQ0FBQSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUEsQUFBQyxHQUFHLENBQUEsTztNQUFBLENBQUE7QUFDcEMsQUFBQSxNQUFNLE9BQUksQ0FBQSxDQUFBLENBQUEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFBLEM7S0FBQSxDO0lBQUEsQztHQUFBLEM7RUFBQSxDO0NBQUEsQ0FBQTtBQUNqQixBQUFBO0FBQ0EsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFLLE1BQUosR0FBRyxFQUFFLENBQUUsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQzFDLEFBQUEsQ0FBQyxNQUFNLENBQUEsQUFBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUE7QUFDdkIsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUssTUFBSixHQUFHLEVBQUUsQ0FBRSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDMUMsQUFBQSxDQUFDLE1BQU0sQ0FBQSxBQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQTtBQUN0QixBQUFBLENBQUMsTTtBQUFNLENBQUE7QUFDUCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBSyxNQUFKLElBQUksQ0FBQyxDQUFFLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUMxQyxBQUFBLENBQUMsTUFBTSxDQUFBLEFBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFBO0FBQ3RCLEFBQUEsQ0FBQyxNO0FBQU0sQ0FBQTtBQUNQLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFLLE1BQUosR0FBRyxFQUFFLENBQUUsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQzFDLEFBQUEsQ0FBQyxNQUFNLENBQUEsQUFBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUE7QUFDdkIsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVMsTUFBUixRQUFRLENBQUMsQ0FBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDdkQsQUFBQSxDQUFDLEdBQUcsQ0FBQSxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQzNCLEFBQUEsRUFBRSxNO0NBQU0sQ0FBQTtBQUNSLEFBQUEsQ0FBQyxHQUFHLENBQUEsQUFBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzlCLEFBQUEsQ0FBQyxNO0FBQU0sQ0FBQTtBQUNQLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFTLE1BQVIsUUFBUSxDQUFDLENBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZELEFBQUEsQ0FBQyxHQUFHLENBQUEsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUM1QixBQUFBLEVBQUUsTTtDQUFN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QUEsRUFBSyxNQUFILEdBQUcsQ0FBQyxDQUFFLENBQUMsSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDL0IsQUFBQSxFQUFLLE1BQUgsR0FBRyxDQUFDLENBQUUsQ0FBQyxTQUFTLENBQUMsSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsQ0FBQztBQUM3QyxBQUFBLEVBQUUsTUFBTSxDQUFBLEFBQUMsSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUNoQyxBQUFBLEVBQUUsSSxDQUFDLFdBQVcsQyxFQUFHLENBQUMsQ0FBQztBQUNuQixBQUFBLEVBQUUsTTtDQUFNLEM7QUFBQSxDQUFBO0FBQ1IiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgbG9nZ2VyLmxpYi5jaXZldFxuXG5pbXBvcnQge1xuXHRleGlzdHNTeW5jLFxuXHR9IGZyb20gJ0BzdGQvZnMnXG5pbXBvcnQge0xvZ0xldmVsc30gZnJvbSBcIkBzdGQvbG9nL2xldmVsc1wiXG5pbXBvcnQge1xuXHRDb25zb2xlSGFuZGxlciwgRmlsZUhhbmRsZXIsIHNldHVwLCBnZXRMb2dnZXIsIExvZ1JlY29yZCxcblx0fSBmcm9tICdAc3RkL2xvZydcblxuaW1wb3J0IHtcblx0Z2V0UHJlZml4LFxuXHR9IGZyb20gJy4vdW5pY29kZS5saWIudHMnXG5pbXBvcnQge1xuXHR1bmRlZiwgZGVmaW5lZCwgbm90ZGVmaW5lZCwgaGFzaCwgaXNTdHJpbmcsIG5vbkVtcHR5LFxuXHR9IGZyb20gJy4vZGF0YXR5cGVzLmxpYi50cydcbmltcG9ydCB7XG5cdHNwYWNlcywgbywgc2luY2VMb2FkU3RyLCBnZXRPcHRpb25zLCBPTCwgTUwsIHBhc3MsIGNyb2FrLFxuXHR9IGZyb20gJy4vbGx1dGlscy5saWIudHMnXG5pbXBvcnQge1xuXHRUTG9nTGV2ZWwsIGlzTG9nTGV2ZWwsIGdldExvZ0xldmVsLCBzZXRMb2dMZXZlbCxcblx0cHVzaExvZ0xldmVsLCBwb3BMb2dMZXZlbCwgcmVzZXRMb2dMZXZlbCxcblx0aXNJbmFjdGl2ZUxldmVsLFxuXHR9IGZyb20gJy4vbG9nLWxldmVscy5saWIudHMnXG5pbXBvcnQge1xuXHRnZXRGb3JtYXR0ZXIsIGluZGVudExvZywgdW5kZW50TG9nLFxuXHRnZXRDb25zb2xlTG9nLCBjbGVhckNvbnNvbGVMb2csIGxvZ0luZGVudCxcblx0fSBmcm9tICcuL2xvZy1mb3JtYXR0ZXIubGliLnRzJ1xuXG5leHBvcnQge1xuXHRnZXRMb2dMZXZlbCwgaXNMb2dMZXZlbCwgc2V0TG9nTGV2ZWwsXG5cdHB1c2hMb2dMZXZlbCwgcG9wTG9nTGV2ZWwsXG5cdGluZGVudExvZywgdW5kZW50TG9nLFxuXHRjbGVhckNvbnNvbGVMb2csIGdldENvbnNvbGVMb2csXG5cdH1cbmV4cG9ydCB0eXBlIHtUTG9nTGV2ZWx9XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbm1haW5Nb2R1bGU6IHN0cmluZyA6PSBuZXcgVVJMKERlbm8ubWFpbk1vZHVsZSkucGF0aG5hbWUuc2xpY2UoMSlcblxubG9nRmlsZU5hbWUgOj0gKCgpID0+XG5cdGxNYXRjaGVzIDo9IG1haW5Nb2R1bGUubWF0Y2goL1tBLVphLXowLTlfXFwtXFwuXSskLylcblx0aWYgZGVmaW5lZChsTWF0Y2hlcylcblx0XHRsYWJlbCA6PSBsTWF0Y2hlc1swXS5yZXBsYWNlQWxsKCcuJywgJ18nKVxuXHRcdHRpbWUgOj0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2VBbGwoJzonLCctJylcblx0XHRyZXR1cm4gXCJsb2dzLyN7bGFiZWx9ICN7dGltZX0ubG9nXCJcblx0ZWxzZVxuXHRcdHJldHVybiBcImxvZ3MvZHVtbXkubG9nXCJcblx0KSgpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBnZXRMb2cgOj0gKGZyb206IHN0cmluZyk6IHN0cmluZyA9PlxuXG5cdHN3aXRjaCBmcm9tXG5cdFx0d2hlbiAnY29uc29sZSdcblx0XHRcdHJldHVybiBnZXRDb25zb2xlTG9nKClcblx0XHR3aGVuICdmaWxlJ1xuXHRcdFx0aWYgZXhpc3RzU3luYyhsb2dGaWxlTmFtZSlcblx0XHRcdFx0ZGF0YSA6PSBEZW5vLnJlYWRGaWxlU3luYyhsb2dGaWxlTmFtZSlcblx0XHRcdFx0ZGVjb2RlciA6PSBuZXcgVGV4dERlY29kZXIoXCJ1dGYtOFwiKVxuXHRcdFx0XHRyZXR1cm4gZGVjb2Rlci5kZWNvZGUoZGF0YSlcblx0XHRcdGVsc2Vcblx0XHRcdFx0cmV0dXJuICcnXG5cdFx0ZWxzZVxuXHRcdFx0Y3JvYWsgXCJnZXRMb2coKTogaW52YWxpZCBmcm9tID0gI3tmcm9tfVwiXG5cdFx0XHRyZXR1cm4gJydcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGNsZWFyTG9nIDo9ICh3aGljaDogc3RyaW5nKTogdm9pZCA9PlxuXG5cdHN3aXRjaCB3aGljaFxuXHRcdHdoZW4gJ2NvbnNvbGUnXG5cdFx0XHRjbGVhckNvbnNvbGVMb2coKVxuXHRcdHdoZW4gJ2ZpbGUnXG5cdFx0XHRlbmNvZGVyIDo9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdFx0c3RyIDo9IGVuY29kZXIuZW5jb2RlKCcnKVxuXHRcdFx0RGVuby53cml0ZUZpbGVTeW5jKGxvZ0ZpbGVOYW1lLCBzdHIpXG5cdFx0d2hlbiAnYm90aCdcblx0XHRcdGNsZWFyQ29uc29sZUxvZygpXG5cdFx0XHRlbmNvZGVyIDo9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdFx0c3RyIDo9IGVuY29kZXIuZW5jb2RlKCcnKVxuXHRcdFx0RGVuby53cml0ZUZpbGVTeW5jKGxvZ0ZpbGVOYW1lLCBzdHIpXG5cdFx0ZWxzZVxuXHRcdFx0cGFzcygpXG5cdHJldHVyblxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5oQ29uZmlnOiBoYXNoIDo9IHtcblxuXHRoYW5kbGVyczpcblxuXHRcdGNvbnNvbGU6IG5ldyBDb25zb2xlSGFuZGxlcignREVCVUcnLCB7XG5cdFx0XHRmb3JtYXR0ZXI6IGdldEZvcm1hdHRlcignJG1zZycsICdjb25zb2xlJylcblx0XHRcdH0pXG5cblx0XHRmaWxlOiBuZXcgRmlsZUhhbmRsZXIoJ0RFQlVHJywge1xuXHRcdFx0ZmlsZW5hbWU6IGxvZ0ZpbGVOYW1lXG5cdFx0XHRtb2RlOiAnYSdcblx0XHRcdGZvcm1hdHRlcjogZ2V0Rm9ybWF0dGVyKCckbGwgJG1zZycsICdmaWxlJylcblx0XHRcdH0pXG5cblx0XHRjb25zb2xlX3Byb2Y6IG5ldyBDb25zb2xlSGFuZGxlcignREVCVUcnLCB7XG5cdFx0XHRmb3JtYXR0ZXI6IGdldEZvcm1hdHRlcignWyR0c10gJG1zZycsICdjb25zb2xlJylcblx0XHRcdH0pXG5cblx0XHRmaWxlX3Byb2Y6IG5ldyBGaWxlSGFuZGxlcignREVCVUcnLCB7XG5cdFx0XHRmaWxlbmFtZTogbG9nRmlsZU5hbWVcblx0XHRcdG1vZGU6ICdhJ1xuXHRcdFx0Zm9ybWF0dGVyOiBnZXRGb3JtYXR0ZXIoJ1skdHNdICRsbCAkbXNnJywgJ2ZpbGUnKVxuXHRcdFx0fSlcblxuXHQjIC0tLSBhc3NpZ24gaGFuZGxlcnMgdG8gbG9nZ2Vyc1xuXHQjICAgICBvcmRlciBmcm9tIG1vc3QgdmVyYm9zZSB0byBsZWFzdCB2ZXJib3NlXG5cblx0bG9nZ2Vyczoge1xuXHRcdHByb2ZpbGU6IHtcblx0XHRcdGxldmVsOiBcIkRFQlVHXCJcblx0XHRcdG51bTogMVxuXHRcdFx0aGFuZGxlcnM6IFtcImNvbnNvbGVfcHJvZlwiLCBcImZpbGVfcHJvZlwiXVxuXHRcdFx0fVxuXHRcdGRlYnVnOiB7XG5cdFx0XHRsZXZlbDogXCJERUJVR1wiXG5cdFx0XHRudW06IDJcblx0XHRcdGhhbmRsZXJzOiBbXCJjb25zb2xlXCIsIFwiZmlsZVwiXVxuXHRcdFx0fVxuXHRcdGluZm86IHtcblx0XHRcdGxldmVsOiBcIklORk9cIlxuXHRcdFx0bnVtOiAzXG5cdFx0XHRoYW5kbGVyczogW1wiY29uc29sZVwiLCBcImZpbGVcIl1cblx0XHRcdH1cblx0XHR3YXJuOiB7XG5cdFx0XHRsZXZlbDogXCJXQVJOXCIsXG5cdFx0XHRudW06IDRcblx0XHRcdGhhbmRsZXJzOiBbXCJjb25zb2xlXCIsIFwiZmlsZVwiXVxuXHRcdFx0fVxuXHRcdGVycm9yOiB7XG5cdFx0XHRsZXZlbDogXCJFUlJPUlwiXG5cdFx0XHRudW06IDVcblx0XHRcdGhhbmRsZXJzOiBbXCJjb25zb2xlXCIsIFwiZmlsZVwiXVxuXHRcdFx0fVxuXHRcdGZpbGU6IHtcblx0XHRcdGxldmVsOiBcIkRFQlVHXCIsXG5cdFx0XHRudW06IDZcblx0XHRcdGhhbmRsZXJzOiBbXCJmaWxlXCJdXG5cdFx0XHR9XG5cdFx0c2lsZW50OiB7XG5cdFx0XHRsZXZlbDogXCJFUlJPUlwiXG5cdFx0XHRudW06IDdcblx0XHRcdGhhbmRsZXJzOiBbXVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5zZXR1cChoQ29uZmlnKVxuaExvZ2dlcnMgOj0gaENvbmZpZy5sb2dnZXJzXG5oSGFuZGxlcnMgOj0gaENvbmZpZy5oYW5kbGVyc1xuXG5leHBvcnQgSU5ERU5UIDo9IFN5bWJvbCgnaW5kZW50JylcbmV4cG9ydCBVTkRFTlQgOj0gU3ltYm9sKCd1bmRlbnQnKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5vdXRwdXQgOj0gKGxldmVsOiBUTG9nTGV2ZWwsIGxJdGVtczogYW55W10pOiB2b2lkID0+XG5cblx0aWYgaXNJbmFjdGl2ZUxldmVsKGxldmVsKVxuXHRcdHJldHVyblxuXG5cdGxldCBsb2dnZXIgPSBnZXRMb2dnZXIoZ2V0TG9nTGV2ZWwoKSlcblx0Zm9yIGl0ZW0gb2YgbEl0ZW1zXG5cdFx0c3dpdGNoIGl0ZW1cblx0XHRcdHdoZW4gSU5ERU5UXG5cdFx0XHRcdGluZGVudExvZygpXG5cdFx0XHR3aGVuIFVOREVOVFxuXHRcdFx0XHR1bmRlbnRMb2coKVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRzdHIgOj0gaXNTdHJpbmcoaXRlbSkgPyBpdGVtIDogTUwoaXRlbSlcblx0XHRcdFx0aWYgbm9uRW1wdHkoc3RyKVxuXHRcdFx0XHRcdHN3aXRjaCBsZXZlbFxuXHRcdFx0XHRcdFx0d2hlbiAnZGVidWcnOiBsb2dnZXIuZGVidWcgc3RyXG5cdFx0XHRcdFx0XHR3aGVuICdpbmZvJzogIGxvZ2dlci5pbmZvIHN0clxuXHRcdFx0XHRcdFx0d2hlbiAnd2Fybic6ICBsb2dnZXIud2FybiBzdHJcblx0XHRcdFx0XHRcdHdoZW4gJ2Vycm9yJzogbG9nZ2VyLmVycm9yIHN0clxuXHRcdFx0XHRcdFx0ZWxzZSBwYXNzKClcblxuXHRyZXR1cm5cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IERCRyAgOj0gKC4uLmxJdGVtczogYW55W10pOiB2b2lkID0+XG5cdG91dHB1dCAnZGVidWcnLCBsSXRlbXNcblx0cmV0dXJuXG5cbmV4cG9ydCBMT0cgIDo9ICguLi5sSXRlbXM6IGFueVtdKTogdm9pZCA9PlxuXHRvdXRwdXQgJ2luZm8nLCBsSXRlbXNcblx0cmV0dXJuXG5cbmV4cG9ydCBXQVJOIDo9ICguLi5sSXRlbXM6IGFueVtdKTogdm9pZCA9PlxuXHRvdXRwdXQgJ3dhcm4nLCBsSXRlbXNcblx0cmV0dXJuXG5cbmV4cG9ydCBFUlIgIDo9ICguLi5sSXRlbXM6IGFueVtdKTogdm9pZCA9PlxuXHRvdXRwdXQgJ2Vycm9yJywgbEl0ZW1zXG5cdHJldHVyblxuXG5leHBvcnQgTE9HVkFMVUUgOj0gKGxhYmVsOiBzdHJpbmcsIHZhbHVlOiBhbnkpOiB2b2lkID0+XG5cdGlmIGlzSW5hY3RpdmVMZXZlbCgnaW5mbycpXG5cdFx0cmV0dXJuXG5cdExPRyBcIiN7bGFiZWx9ID0gI3tNTCh2YWx1ZSl9XCJcblx0cmV0dXJuXG5cbmV4cG9ydCBEQkdWQUxVRSA6PSAobGFiZWw6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQgPT5cblx0aWYgaXNJbmFjdGl2ZUxldmVsKCdkZWJ1ZycpXG5cdFx0cmV0dXJuXG5cdERCRyBcIiN7bGFiZWx9ID0gI3tNTCh2YWx1ZSl9XCJcblx0cmV0dXJuXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCByZW1vdmVMb2dGaWxlIDo9ICgpOiB2b2lkID0+XG5cblx0RGVuby5yZW1vdmVTeW5jIGxvZ0ZpbGVOYW1lXG5cdHJldHVyblxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgdHlwZSBURm9ybWF0dGVyPFQ+ID0gKGRlc2M6IHN0cmluZywgaXRlbTogVD8pID0+IHN0cmluZ1xuXG5leHBvcnQgY2xhc3MgVHJlZUxvZ2dlcjxUPlxuXG5cdCMgLS0tIGRhdGEgZmllbGRzXG5cdGluZGVudExldmVsOiBudW1iZXIgPSAwXG5cdGxvZ0xldmVsOiBUTG9nTGV2ZWwgPSAnZGVidWcnXG5cdGZvcm1hdHRlcjogVEZvcm1hdHRlcjxUPlxuXG5cdCMgLS0tIG1ldGhvZHNcblx0Y29uc3RydWN0b3IoXG5cdFx0XHRAZm9ybWF0dGVyID0gKGRlc2M6IHN0cmluZywgaXRlbTogVD8pID0+IGRlc2Ncblx0XHRcdGxvZ0xldmVsOiBzdHJpbmcgPSAnZGVidWcnXG5cdFx0XHQpXG5cdFx0aWYgaXNMb2dMZXZlbChsb2dMZXZlbClcblx0XHRcdEBsb2dMZXZlbCA9IGxvZ0xldmVsXG5cblx0c3RhcnQoZGVzYzogc3RyaW5nLCBpdGVtOiBUPz11bmRlZik6IHZvaWRcblx0XHRzdHIgOj0gQGZvcm1hdHRlcihkZXNjLCBpdGVtKVxuXHRcdHByZSA6PSBnZXRQcmVmaXgoQGluZGVudExldmVsLCAncGxhaW4nKVxuXHRcdG91dHB1dCBAbG9nTGV2ZWwsIFtwcmUgKyBzdHJdXG5cdFx0QGluZGVudExldmVsICs9IDFcblx0XHRyZXR1cm5cblxuXHRsb2coZGVzYzogc3RyaW5nLCBpdGVtOiBUPz11bmRlZik6IHZvaWRcblx0XHRzdHIgOj0gQGZvcm1hdHRlcihkZXNjLCBpdGVtKVxuXHRcdHByZSA6PSBnZXRQcmVmaXgoQGluZGVudExldmVsLCAncGxhaW4nKVxuXHRcdG91dHB1dCBAbG9nTGV2ZWwsICBbcHJlICsgc3RyXVxuXHRcdHJldHVyblxuXG5cdHN1Y2NlZWQoZGVzYzogc3RyaW5nLCBpdGVtOiBUPz11bmRlZik6IHZvaWRcblx0XHRzdHIgOj0gQGZvcm1hdHRlcihkZXNjLCBpdGVtKVxuXHRcdHByZSA6PSBnZXRQcmVmaXgoQGluZGVudExldmVsLCAnd2l0aEFycm93Jylcblx0XHRvdXRwdXQgQGxvZ0xldmVsLCAgW3ByZSArIHN0cl1cblx0XHRAaW5kZW50TGV2ZWwgLT0gMVxuXHRcdHJldHVyblxuXG5cdGZhaWwoZGVzYzogc3RyaW5nLCBpdGVtOiBUPz11bmRlZik6IHZvaWRcblx0XHRzdHIgOj0gQGZvcm1hdHRlcihkZXNjLCBpdGVtKVxuXHRcdHByZSA6PSBnZXRQcmVmaXgoQGluZGVudExldmVsLCAnd2l0aEFycm93Jylcblx0XHRvdXRwdXQgQGxvZ0xldmVsLCAgW3ByZSArIHN0cl1cblx0XHRAaW5kZW50TGV2ZWwgLT0gMVxuXHRcdHJldHVyblxuIl19