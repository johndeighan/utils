"use strict";
// logger.lib.civet

import {
	existsSync,
	} from '@std/fs'
import {LogLevels} from "@std/log/levels"
import {
	ConsoleHandler, FileHandler, setup, getLogger, LogRecord,
	} from '@std/log'

import {
	undef, defined, notdefined, hash, isString,
	} from './datatypes.lib.ts'
import {
	spaces, o, sinceLoadStr, getOptions, OL, ML, pass, croak,
	} from './llutils.lib.ts'
import {
	TLogLevel, isLogLevel, getLogLevel, setLogLevel,
	pushLogLevel, popLogLevel, resetLogLevel,
	isInactiveLevel,
	} from './log-levels.lib.ts'
import {
	getFormatter, indentLog, undentLog,
	getConsoleLog, clearConsoleLog,
	} from './log-formatter.lib.ts'

export {
	getLogLevel, isLogLevel, setLogLevel, pushLogLevel, popLogLevel,
	}
export type {TLogLevel}

// ---------------------------------------------------------------------------

const mainModule: string = new URL(Deno.mainModule).pathname.slice(1)

const logFileName = (() => {
	const lMatches = mainModule.match(/[A-Za-z0-9_\-\.]+$/)
	if (defined(lMatches)) {
		const label = lMatches[0].replaceAll('.', '_')
		const time = new Date().toISOString().replaceAll(':','-')
		return `logs/${label} ${time}.log`
	}
	else {
		return "logs/dummy.log"
	}
}
	)()

// ---------------------------------------------------------------------------

export const getLog = (from: string): string => {

	switch(from) {
		case 'console': {
			return getConsoleLog()
		}
		case 'file': {
			if (existsSync(logFileName)) {
				const data = Deno.readFileSync(logFileName)
				const decoder = new TextDecoder("utf-8")
				return decoder.decode(data)
			}
			else {
				return ''
			}
		}
		default: {
			croak(`getLog(): invalid from = ${from}`)
			return ''
		}
	}
}

// ---------------------------------------------------------------------------

export const clearLog = (which: string): void => {

	switch(which) {
		case 'console': {
			clearConsoleLog();break;
		}
		case 'file': {
			const encoder = new TextEncoder();
			const str = encoder.encode('')
			Deno.writeFileSync(logFileName, str);break;
		}
		case 'both': {
			clearConsoleLog()
			const encoder = new TextEncoder();
			const str = encoder.encode('')
			Deno.writeFileSync(logFileName, str);break;
		}
		default: {
			pass()
		}
	}
	return
}

// ---------------------------------------------------------------------------

const hConfig: hash = {

	handlers: {

		console: new ConsoleHandler('DEBUG', {
			formatter: getFormatter('$msg', 'console')
			}),

		file: new FileHandler('DEBUG', {
			filename: logFileName,
			mode: 'a',
			formatter: getFormatter('$ll $msg', 'file')
			}),

		console_prof: new ConsoleHandler('DEBUG', {
			formatter: getFormatter('[$ts] $msg', 'console')
			}),

		file_prof: new FileHandler('DEBUG', {
			filename: logFileName,
			mode: 'a',
			formatter: getFormatter('[$ts] $ll $msg', 'file')
			}),
	},

	// --- assign handlers to loggers
	//     order from most verbose to least verbose

	loggers: {
		profile: {
			level: "DEBUG",
			num: 1,
			handlers: ["console_prof", "file_prof"]
			},
		debug: {
			level: "DEBUG",
			num: 2,
			handlers: ["console", "file"]
			},
		info: {
			level: "INFO",
			num: 3,
			handlers: ["console", "file"]
			},
		warn: {
			level: "WARN",
			num: 4,
			handlers: ["console", "file"]
			},
		error: {
			level: "ERROR",
			num: 5,
			handlers: ["console", "file"]
			},
		file: {
			level: "DEBUG",
			num: 6,
			handlers: ["file"]
			},
		silent: {
			level: "ERROR",
			num: 7,
			handlers: []
			}
		}
	}

setup(hConfig)
const hLoggers = hConfig.loggers
const hHandlers = hConfig.handlers

export const INDENT = Symbol('indent')
export const UNDENT = Symbol('undent')

// ---------------------------------------------------------------------------

const output = (level: TLogLevel, lItems: any[]): void => {

	if (isInactiveLevel(level)) {
		return
	}

	let logger = getLogger(getLogLevel())
	for (const item of lItems) {
		switch(item) {
			case INDENT: {
				indentLog();break;
			}
			case UNDENT: {
				undentLog();break;
			}
			default: {
				const str = isString(item) ? item : ML(item)
				switch(level) {
					case 'debug': { logger.debug(str);break;
					}
					case 'info': {  logger.info(str);break;
					}
					case 'warn': {  logger.warn(str);break;
					}
					case 'error': { logger.error(str);break;
					}
					default: { pass() }
				}
			}
		}
	}

	return
}

// ---------------------------------------------------------------------------

export const DBG  = (...lItems: any[]): void => {
	output('debug', lItems)
	return
}

export const LOG  = (...lItems: any[]): void => {
	output('info', lItems)
	return
}

export const WARN = (...lItems: any[]): void => {
	output('warn', lItems)
	return
}

export const ERR  = (...lItems: any[]): void => {
	output('error', lItems)
	return
}

export const LOGVALUE = (label: string, value: any): void => {
	if (isInactiveLevel('info')) {
		return
	}
	LOG(`${label} = ${ML(value)}`)
	return
}

export const DBGVALUE = (label: string, value: any): void => {
	if (isInactiveLevel('debug')) {
		return
	}
	DBG(`${label} = ${ML(value)}`)
	return
}

// ---------------------------------------------------------------------------

export const removeLogFile = (): void => {

	Deno.removeSync(logFileName)
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjL2xpYi9sb2dnZXIubGliLmNpdmV0LnRzeCIsInNvdXJjZXMiOlsic3JjL2xpYi9sb2dnZXIubGliLmNpdmV0Il0sIm1hcHBpbmdzIjoiO0FBQUEsbUJBQWtCO0FBQ2xCLEFBQUE7QUFDQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxVQUFVLENBQUM7QUFDWixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUztBQUNqQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUN6QyxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUMxRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVTtBQUNsQixBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDNUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLG9CQUFvQjtBQUM1QixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUMxRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCO0FBQzFCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsU0FBUyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ2pELENBQUMsWUFBWSxDQUFDLENBQUMsV0FBVyxDQUFD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QUEsQ0FBQTtBQUNiLEFBQUEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFBLENBQUEsQ0FBQTtBQUNkLEFBQUEsSUFBSSxTQUFTLENBQUMsQ0FBQyxPO0dBQUEsQ0FBQTtBQUNmLEFBQUEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFBLENBQUEsQ0FBQTtBQUNkLEFBQUEsSUFBSSxTQUFTLENBQUMsQ0FBQyxPO0dBQUEsQ0FBQTtBQUNmLEFBQUEsR0FBRyxPQUFJLENBQUEsQ0FBQSxDQUFBO0FBQ1AsQUFBQSxJQUFPLE1BQUgsR0FBRyxDQUFDLENBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQztBQUMzQyxBQUFBLElBQUksTUFBTSxDQUFBLEFBQUMsS0FBSyxDQUFBLENBQUEsQ0FBQTtBQUNoQixBQUFBLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFBLENBQUEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFBLEFBQUMsR0FBRyxDQUFBLE87S0FBQSxDQUFBO0FBQ25DLEFBQUEsS0FBSyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUEsQUFBQyxHQUFHLENBQUEsTztLQUFBLENBQUE7QUFDbEMsQUFBQSxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQSxDQUFBLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQSxBQUFDLEdBQUcsQ0FBQSxPO0tBQUEsQ0FBQTtBQUNsQyxBQUFBLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFBLENBQUEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFBLEFBQUMsR0FBRyxDQUFBLE87S0FBQSxDQUFBO0FBQ25DLEFBQUEsS0FBSyxPQUFJLENBQUEsQ0FBQSxDQUFBLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQSxDO0lBQUEsQztHQUFBLEM7RUFBQSxDO0NBQUEsQ0FBQTtBQUNoQixBQUFBO0FBQ0EsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFLLE1BQUosR0FBRyxFQUFFLENBQUUsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQzFDLEFBQUEsQ0FBQyxNQUFNLENBQUEsQUFBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUE7QUFDdkIsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUssTUFBSixHQUFHLEVBQUUsQ0FBRSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDMUMsQUFBQSxDQUFDLE1BQU0sQ0FBQSxBQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQTtBQUN0QixBQUFBLENBQUMsTTtBQUFNLENBQUE7QUFDUCxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBSyxNQUFKLElBQUksQ0FBQyxDQUFFLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUMxQyxBQUFBLENBQUMsTUFBTSxDQUFBLEFBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFBO0FBQ3RCLEFBQUEsQ0FBQyxNO0FBQU0sQ0FBQTtBQUNQLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFLLE1BQUosR0FBRyxFQUFFLENBQUUsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQzFDLEFBQUEsQ0FBQyxNQUFNLENBQUEsQUFBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUE7QUFDdkIsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVMsTUFBUixRQUFRLENBQUMsQ0FBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDdkQsQUFBQSxDQUFDLEdBQUcsQ0FBQSxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQzNCLEFBQUEsRUFBRSxNO0NBQU0sQ0FBQTtBQUNSLEFBQUEsQ0FBQyxHQUFHLENBQUEsQUFBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzlCLEFBQUEsQ0FBQyxNO0FBQU0sQ0FBQTtBQUNQLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFTLE1BQVIsUUFBUSxDQUFDLENBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZELEFBQUEsQ0FBQyxHQUFHLENBQUEsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUM1QixBQUFBLEVBQUUsTTtDQUFNLENBQUE7QUFDUixBQUFBLENBQUMsR0FBRyxDQUFBLEFBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUM5QixBQUFBLENBQUMsTTtBQUFNLENBQUE7QUFDUCxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQWMsTUFBYixhQUFhLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ25DLEFBQUE7QUFDQSxBQUFBLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQSxBQUFDLFdBQVcsQztBQUFBLENBQUE7QUFDNUIiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgbG9nZ2VyLmxpYi5jaXZldFxuXG5pbXBvcnQge1xuXHRleGlzdHNTeW5jLFxuXHR9IGZyb20gJ0BzdGQvZnMnXG5pbXBvcnQge0xvZ0xldmVsc30gZnJvbSBcIkBzdGQvbG9nL2xldmVsc1wiXG5pbXBvcnQge1xuXHRDb25zb2xlSGFuZGxlciwgRmlsZUhhbmRsZXIsIHNldHVwLCBnZXRMb2dnZXIsIExvZ1JlY29yZCxcblx0fSBmcm9tICdAc3RkL2xvZydcblxuaW1wb3J0IHtcblx0dW5kZWYsIGRlZmluZWQsIG5vdGRlZmluZWQsIGhhc2gsIGlzU3RyaW5nLFxuXHR9IGZyb20gJy4vZGF0YXR5cGVzLmxpYi50cydcbmltcG9ydCB7XG5cdHNwYWNlcywgbywgc2luY2VMb2FkU3RyLCBnZXRPcHRpb25zLCBPTCwgTUwsIHBhc3MsIGNyb2FrLFxuXHR9IGZyb20gJy4vbGx1dGlscy5saWIudHMnXG5pbXBvcnQge1xuXHRUTG9nTGV2ZWwsIGlzTG9nTGV2ZWwsIGdldExvZ0xldmVsLCBzZXRMb2dMZXZlbCxcblx0cHVzaExvZ0xldmVsLCBwb3BMb2dMZXZlbCwgcmVzZXRMb2dMZXZlbCxcblx0aXNJbmFjdGl2ZUxldmVsLFxuXHR9IGZyb20gJy4vbG9nLWxldmVscy5saWIudHMnXG5pbXBvcnQge1xuXHRnZXRGb3JtYXR0ZXIsIGluZGVudExvZywgdW5kZW50TG9nLFxuXHRnZXRDb25zb2xlTG9nLCBjbGVhckNvbnNvbGVMb2csXG5cdH0gZnJvbSAnLi9sb2ctZm9ybWF0dGVyLmxpYi50cydcblxuZXhwb3J0IHtcblx0Z2V0TG9nTGV2ZWwsIGlzTG9nTGV2ZWwsIHNldExvZ0xldmVsLCBwdXNoTG9nTGV2ZWwsIHBvcExvZ0xldmVsLFxuXHR9XG5leHBvcnQgdHlwZSB7VExvZ0xldmVsfVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5tYWluTW9kdWxlOiBzdHJpbmcgOj0gbmV3IFVSTChEZW5vLm1haW5Nb2R1bGUpLnBhdGhuYW1lLnNsaWNlKDEpXG5cbmxvZ0ZpbGVOYW1lIDo9ICgoKSA9PlxuXHRsTWF0Y2hlcyA6PSBtYWluTW9kdWxlLm1hdGNoKC9bQS1aYS16MC05X1xcLVxcLl0rJC8pXG5cdGlmIGRlZmluZWQobE1hdGNoZXMpXG5cdFx0bGFiZWwgOj0gbE1hdGNoZXNbMF0ucmVwbGFjZUFsbCgnLicsICdfJylcblx0XHR0aW1lIDo9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlQWxsKCc6JywnLScpXG5cdFx0cmV0dXJuIFwibG9ncy8je2xhYmVsfSAje3RpbWV9LmxvZ1wiXG5cdGVsc2Vcblx0XHRyZXR1cm4gXCJsb2dzL2R1bW15LmxvZ1wiXG5cdCkoKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgZ2V0TG9nIDo9IChmcm9tOiBzdHJpbmcpOiBzdHJpbmcgPT5cblxuXHRzd2l0Y2ggZnJvbVxuXHRcdHdoZW4gJ2NvbnNvbGUnXG5cdFx0XHRyZXR1cm4gZ2V0Q29uc29sZUxvZygpXG5cdFx0d2hlbiAnZmlsZSdcblx0XHRcdGlmIGV4aXN0c1N5bmMobG9nRmlsZU5hbWUpXG5cdFx0XHRcdGRhdGEgOj0gRGVuby5yZWFkRmlsZVN5bmMobG9nRmlsZU5hbWUpXG5cdFx0XHRcdGRlY29kZXIgOj0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIilcblx0XHRcdFx0cmV0dXJuIGRlY29kZXIuZGVjb2RlKGRhdGEpXG5cdFx0XHRlbHNlXG5cdFx0XHRcdHJldHVybiAnJ1xuXHRcdGVsc2Vcblx0XHRcdGNyb2FrIFwiZ2V0TG9nKCk6IGludmFsaWQgZnJvbSA9ICN7ZnJvbX1cIlxuXHRcdFx0cmV0dXJuICcnXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBjbGVhckxvZyA6PSAod2hpY2g6IHN0cmluZyk6IHZvaWQgPT5cblxuXHRzd2l0Y2ggd2hpY2hcblx0XHR3aGVuICdjb25zb2xlJ1xuXHRcdFx0Y2xlYXJDb25zb2xlTG9nKClcblx0XHR3aGVuICdmaWxlJ1xuXHRcdFx0ZW5jb2RlciA6PSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRcdHN0ciA6PSBlbmNvZGVyLmVuY29kZSgnJylcblx0XHRcdERlbm8ud3JpdGVGaWxlU3luYyhsb2dGaWxlTmFtZSwgc3RyKVxuXHRcdHdoZW4gJ2JvdGgnXG5cdFx0XHRjbGVhckNvbnNvbGVMb2coKVxuXHRcdFx0ZW5jb2RlciA6PSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRcdHN0ciA6PSBlbmNvZGVyLmVuY29kZSgnJylcblx0XHRcdERlbm8ud3JpdGVGaWxlU3luYyhsb2dGaWxlTmFtZSwgc3RyKVxuXHRcdGVsc2Vcblx0XHRcdHBhc3MoKVxuXHRyZXR1cm5cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuaENvbmZpZzogaGFzaCA6PSB7XG5cblx0aGFuZGxlcnM6XG5cblx0XHRjb25zb2xlOiBuZXcgQ29uc29sZUhhbmRsZXIoJ0RFQlVHJywge1xuXHRcdFx0Zm9ybWF0dGVyOiBnZXRGb3JtYXR0ZXIoJyRtc2cnLCAnY29uc29sZScpXG5cdFx0XHR9KVxuXG5cdFx0ZmlsZTogbmV3IEZpbGVIYW5kbGVyKCdERUJVRycsIHtcblx0XHRcdGZpbGVuYW1lOiBsb2dGaWxlTmFtZVxuXHRcdFx0bW9kZTogJ2EnXG5cdFx0XHRmb3JtYXR0ZXI6IGdldEZvcm1hdHRlcignJGxsICRtc2cnLCAnZmlsZScpXG5cdFx0XHR9KVxuXG5cdFx0Y29uc29sZV9wcm9mOiBuZXcgQ29uc29sZUhhbmRsZXIoJ0RFQlVHJywge1xuXHRcdFx0Zm9ybWF0dGVyOiBnZXRGb3JtYXR0ZXIoJ1skdHNdICRtc2cnLCAnY29uc29sZScpXG5cdFx0XHR9KVxuXG5cdFx0ZmlsZV9wcm9mOiBuZXcgRmlsZUhhbmRsZXIoJ0RFQlVHJywge1xuXHRcdFx0ZmlsZW5hbWU6IGxvZ0ZpbGVOYW1lXG5cdFx0XHRtb2RlOiAnYSdcblx0XHRcdGZvcm1hdHRlcjogZ2V0Rm9ybWF0dGVyKCdbJHRzXSAkbGwgJG1zZycsICdmaWxlJylcblx0XHRcdH0pXG5cblx0IyAtLS0gYXNzaWduIGhhbmRsZXJzIHRvIGxvZ2dlcnNcblx0IyAgICAgb3JkZXIgZnJvbSBtb3N0IHZlcmJvc2UgdG8gbGVhc3QgdmVyYm9zZVxuXG5cdGxvZ2dlcnM6IHtcblx0XHRwcm9maWxlOiB7XG5cdFx0XHRsZXZlbDogXCJERUJVR1wiXG5cdFx0XHRudW06IDFcblx0XHRcdGhhbmRsZXJzOiBbXCJjb25zb2xlX3Byb2ZcIiwgXCJmaWxlX3Byb2ZcIl1cblx0XHRcdH1cblx0XHRkZWJ1Zzoge1xuXHRcdFx0bGV2ZWw6IFwiREVCVUdcIlxuXHRcdFx0bnVtOiAyXG5cdFx0XHRoYW5kbGVyczogW1wiY29uc29sZVwiLCBcImZpbGVcIl1cblx0XHRcdH1cblx0XHRpbmZvOiB7XG5cdFx0XHRsZXZlbDogXCJJTkZPXCJcblx0XHRcdG51bTogM1xuXHRcdFx0aGFuZGxlcnM6IFtcImNvbnNvbGVcIiwgXCJmaWxlXCJdXG5cdFx0XHR9XG5cdFx0d2Fybjoge1xuXHRcdFx0bGV2ZWw6IFwiV0FSTlwiLFxuXHRcdFx0bnVtOiA0XG5cdFx0XHRoYW5kbGVyczogW1wiY29uc29sZVwiLCBcImZpbGVcIl1cblx0XHRcdH1cblx0XHRlcnJvcjoge1xuXHRcdFx0bGV2ZWw6IFwiRVJST1JcIlxuXHRcdFx0bnVtOiA1XG5cdFx0XHRoYW5kbGVyczogW1wiY29uc29sZVwiLCBcImZpbGVcIl1cblx0XHRcdH1cblx0XHRmaWxlOiB7XG5cdFx0XHRsZXZlbDogXCJERUJVR1wiLFxuXHRcdFx0bnVtOiA2XG5cdFx0XHRoYW5kbGVyczogW1wiZmlsZVwiXVxuXHRcdFx0fVxuXHRcdHNpbGVudDoge1xuXHRcdFx0bGV2ZWw6IFwiRVJST1JcIlxuXHRcdFx0bnVtOiA3XG5cdFx0XHRoYW5kbGVyczogW11cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuc2V0dXAoaENvbmZpZylcbmhMb2dnZXJzIDo9IGhDb25maWcubG9nZ2Vyc1xuaEhhbmRsZXJzIDo9IGhDb25maWcuaGFuZGxlcnNcblxuZXhwb3J0IElOREVOVCA6PSBTeW1ib2woJ2luZGVudCcpXG5leHBvcnQgVU5ERU5UIDo9IFN5bWJvbCgndW5kZW50JylcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxub3V0cHV0IDo9IChsZXZlbDogVExvZ0xldmVsLCBsSXRlbXM6IGFueVtdKTogdm9pZCA9PlxuXG5cdGlmIGlzSW5hY3RpdmVMZXZlbChsZXZlbClcblx0XHRyZXR1cm5cblxuXHRsZXQgbG9nZ2VyID0gZ2V0TG9nZ2VyKGdldExvZ0xldmVsKCkpXG5cdGZvciBpdGVtIG9mIGxJdGVtc1xuXHRcdHN3aXRjaCBpdGVtXG5cdFx0XHR3aGVuIElOREVOVFxuXHRcdFx0XHRpbmRlbnRMb2coKVxuXHRcdFx0d2hlbiBVTkRFTlRcblx0XHRcdFx0dW5kZW50TG9nKClcblx0XHRcdGVsc2Vcblx0XHRcdFx0c3RyIDo9IGlzU3RyaW5nKGl0ZW0pID8gaXRlbSA6IE1MKGl0ZW0pXG5cdFx0XHRcdHN3aXRjaCBsZXZlbFxuXHRcdFx0XHRcdHdoZW4gJ2RlYnVnJzogbG9nZ2VyLmRlYnVnIHN0clxuXHRcdFx0XHRcdHdoZW4gJ2luZm8nOiAgbG9nZ2VyLmluZm8gc3RyXG5cdFx0XHRcdFx0d2hlbiAnd2Fybic6ICBsb2dnZXIud2FybiBzdHJcblx0XHRcdFx0XHR3aGVuICdlcnJvcic6IGxvZ2dlci5lcnJvciBzdHJcblx0XHRcdFx0XHRlbHNlIHBhc3MoKVxuXG5cdHJldHVyblxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgREJHICA6PSAoLi4ubEl0ZW1zOiBhbnlbXSk6IHZvaWQgPT5cblx0b3V0cHV0ICdkZWJ1ZycsIGxJdGVtc1xuXHRyZXR1cm5cblxuZXhwb3J0IExPRyAgOj0gKC4uLmxJdGVtczogYW55W10pOiB2b2lkID0+XG5cdG91dHB1dCAnaW5mbycsIGxJdGVtc1xuXHRyZXR1cm5cblxuZXhwb3J0IFdBUk4gOj0gKC4uLmxJdGVtczogYW55W10pOiB2b2lkID0+XG5cdG91dHB1dCAnd2FybicsIGxJdGVtc1xuXHRyZXR1cm5cblxuZXhwb3J0IEVSUiAgOj0gKC4uLmxJdGVtczogYW55W10pOiB2b2lkID0+XG5cdG91dHB1dCAnZXJyb3InLCBsSXRlbXNcblx0cmV0dXJuXG5cbmV4cG9ydCBMT0dWQUxVRSA6PSAobGFiZWw6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQgPT5cblx0aWYgaXNJbmFjdGl2ZUxldmVsKCdpbmZvJylcblx0XHRyZXR1cm5cblx0TE9HIFwiI3tsYWJlbH0gPSAje01MKHZhbHVlKX1cIlxuXHRyZXR1cm5cblxuZXhwb3J0IERCR1ZBTFVFIDo9IChsYWJlbDogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCA9PlxuXHRpZiBpc0luYWN0aXZlTGV2ZWwoJ2RlYnVnJylcblx0XHRyZXR1cm5cblx0REJHIFwiI3tsYWJlbH0gPSAje01MKHZhbHVlKX1cIlxuXHRyZXR1cm5cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IHJlbW92ZUxvZ0ZpbGUgOj0gKCk6IHZvaWQgPT5cblxuXHREZW5vLnJlbW92ZVN5bmMgbG9nRmlsZU5hbWVcbiJdfQ==