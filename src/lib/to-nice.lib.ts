"use strict";
// to-nice.lib.civet

import {cyan, blue} from "@std/fmt/colors"

import {sep} from 'base-utils'
import {
	assert, croak, undef, defined, notdefined, hash, hashof,
	isString, isArray, isClass, isRegExp, isPrimitive,
	isEmpty, nonEmpty, assertIsHash, integer,
	symbolName, className, functionName, regexpDef,
	} from 'datatypes'
import {
	getOptions, escapeStr, o, toBlock, spaces, mapEachLine,
	} from 'llutils'

export type TCompareFunc = (a: string, b: string) => number

// ---------------------------------------------------------------------------

export const alphaCompare: TCompareFunc = (
		a: string,
		b: string
		): number => {

	return (a < b) ? -1 : (a > b) ? 1 : 0
}

// ---------------------------------------------------------------------------
// --- any leading digit must be preceded by a single '\'

export const toNiceString = (str: string): string => {

	// --- escape spaces and \t, \n or \r with unicode chars

	const str1 = escapeStr(str)

	// --- precede with '\' if starts with digit, '.' or '-'
	//                      or looks like a label

	const str2 = str1.match(/^[\d.-]/) ? `\\${str1}` : str1
	const str3 = str2.match(/^[^˳\s]+:/) ? `\\${str2}` : str2
	return str3
}

// ---------------------------------------------------------------------------

// --- Returns a function that:
//        compares 2 strings based on their position in lSortKeys
//        else compares alphabetically

const getCompareFunc = (
		lSortKeys: string[]
		): TCompareFunc => {

	// --- Create map of key to number
	const h: hashof<number> = {}
	let i1 = 0;for (const key of lSortKeys) {const i = i1++;
		h[key] = i+1
	}

	return function(a: string, b: string): number {
		const aVal = h[a]
		const bVal = h[b]

		if (defined(aVal)) {
			if (defined(bVal)) {
				// --- compare numerically
				return (aVal < bVal) ? -1 : (aVal > bVal) ? 1 : 0
			}
			else {
				return -1
			}
		}
		else {
			if (defined(bVal)) {
				return 1
			}
			else {
				return alphaCompare(a, b)
			}
		}
	}
}

// ---------------------------------------------------------------------------

export const rotpos = <T,>(lArray: T[], i: integer): T => {

	return lArray[i % lArray.length]
}

// ---------------------------------------------------------------------------

const indented = (block: string, oneIndent: string) => {

	return mapEachLine(block, (line) => oneIndent + line)
}

// ---------------------------------------------------------------------------

export type TPathIndex = string | number

export const buildPath = (lPath: TPathIndex[]): string => {

	let str = 'root'
	for (const item of lPath) {
		if (isString(item)) {
			str += `.${item}`
		}
		else {
			str += `[${item.toString()}]`
		}
	}
	return str
}

// ---------------------------------------------------------------------------

export type TMapFunc = (
	key: string,
	value: unknown,
	hParent: hash
	) => unknown

export const emptyMapFunc = (
		key: string,
		value: unknown,
		hParent: hash
		): unknown => {
	return undef
}

export const toNice = (
		x: unknown,
		hOptions: hash={},
		mapVisited: Map<object, string> = new Map<object, string>(),
		lPath: TPathIndex[] = []
		): string => {

	// --- When recoverable, classes and functions
	//     include their definitions,
	//     with escaped chars

	type opt = {
		compact: boolean
		recoverable: boolean
		ignoreEmptyValues: boolean
		sortKeys: boolean
		sortFunc: (TCompareFunc | undefined)
		mapFunc: TMapFunc
		lInclude: ((string[]) | undefined)
		lExclude: ((string[]) | undefined)
		lIndents: string[]
		}
	const {		compact,
			recoverable,
			ignoreEmptyValues,
			sortKeys,
			sortFunc,
			mapFunc,
			lInclude,
			lExclude,
			lIndents
		} = getOptions<opt>(hOptions, {
		compact: false,
		recoverable: false,
		ignoreEmptyValues: false,
		sortKeys: false,
		sortFunc: undef,
		mapFunc: emptyMapFunc,
		lInclude: undef,
		lExclude: undef,
		lIndents: ['   ', '❘  ']
		})

	// --- You can provide sortKeys or a sortFunc, but not both
	assert(!(sortKeys && defined(sortFunc)), "Bad options")

	switch(typeof x) {
		case 'undefined': {
			return '.undef'
		}

		case 'boolean': {
			return x ? '.true' : '.false'
		}

		case 'number': {
			return (
				  Number.isNaN(x)    ? '.NaN'
				: Number.isFinite(x) ? x.toString()
				: ((x < 0) ? '.neginf' : '.inf')
				)
		}

		case 'bigint': {
			return x.toString() + 'n'
		}

		case 'string': {
			return toNiceString(x)
		}

		case 'symbol': {
			const name = symbolName(x)
			return name ? `.symbol ${name}` : '.symbol'
		}

		case 'function': {
			if (isClass(x)) {
				return `.class ${className(x)}`
			}
			else {
				return `.function ${functionName(x)}`
			}
		}

		case 'object': {
			if (x === null) {
				return '.null'
			}

			if (isRegExp(x)) {
				return `.regexp ${escapeStr(regexpDef(x))}`
			}

			// --- Check if object was previously visited
			const prevpath = mapVisited.get(x)
			if (prevpath) {
				return `.ref ${prevpath}`
			}

			if (isArray(x)) {
				if (x.length === 0) {
					return '[]'
				}

				mapVisited.set(x, buildPath(lPath))
				const lLines = []
				let i2 = 0;for (const val of x) {const i = i2++;
					const block = toNice(
							val,
							hOptions,
							mapVisited,
							[...lPath, i]
							)
					if (compact) {
						lLines.push(block)
					}
					else if (isPrimitive(val) || block.startsWith('.') || isEmpty(val)) {
						lLines.push(`- ${block}`)
					}
					else {
						lLines.push('-')
						const oneIndent = rotpos<string>(lIndents, lPath.length)
						lLines.push(indented(block, oneIndent))
					}
				}
				if (compact) {
					return '[' + lLines.join(' ') + ']'
				}
				else {
					return toBlock(lLines)
				}
			}

			// --- It's an object
			if (x instanceof Set) {
				const results=[];for (const key of x.keys()) {
					results.push(toNice(key))
				};const lKeys =results
				return (
					  (lKeys.length === 0)
					? ".emptySet"
					: `.set ${lKeys.join(' ')}`
					)
			}

			if (x instanceof Map) {
				const results1=[];for (const [key, val] of x.entries()) {
					results1.push(`${toNice(key)}:: ${toNice(val)}`)
				};const lLines =results1
				return lLines.join('\n')
			}

			const lKeys = Object.keys(x)
			if (lKeys.length === 0) {
				return '{}'
			}

			const func: (TCompareFunc | undefined) = (
				  defined(sortFunc) ? sortFunc
				: defined(lInclude) ? getCompareFunc(lInclude)
				: sortKeys          ? alphaCompare
				:                     undef
				)

			const useKey = (key: unknown): boolean => {
				if (typeof key !== 'string') {
					return false
				}
				if (defined(lExclude) && lExclude.includes(key)) {
					return false
				}
				if (defined(lInclude) && !lInclude.includes(key)) {
					return false
				}
				return true
			}

			mapVisited.set(x, buildPath(lPath))

			assertIsHash(x)    // --- will allow us to index with any string

			const lLines = []
			for (const key of (defined(func) ? lKeys.sort(func) : lKeys).filter(useKey)) {
				const val = x[key]
				if (!ignoreEmptyValues || nonEmpty(val)) {
					const mapped = recoverable ? undef : mapFunc(key, val, x)
					const newval = mapped || val
					const block = isString(mapped) ? mapped : toNice(
							newval,
							hOptions,
							mapVisited,
							[...lPath, key]
							)
					if (
								compact
							|| (defined(newval) && isPrimitive(newval))
							|| block.startsWith('.')
							|| isEmpty(newval)
							) {
						lLines.push(`${key}: ${block}`)
					}
					else {
						lLines.push(`${key}:`)
						const oneIndent = rotpos<string>(lIndents, lPath.length)
						lLines.push(indented(block, oneIndent))
					}
				}
			}
			if (compact) {
				return '{' + lLines.join(' ') + '}'
			}
			else {
				return toBlock(lLines)
			}
		}
	}

	return `<Unknown object ${x}>`
}

// ---------------------------------------------------------------------------

export const OL = (x: unknown): string => {

	return toNice(x, {compact: true})
}

// ---------------------------------------------------------------------------

export const ML = (x: unknown): string => {

	return toNice(x, {compact: false})
}

// ---------------------------------------------------------------------------

export const DUMP = (
		x: unknown,
		label: (string | undefined) = undef,
		hOptions: hash = {}
		): void => {

	type opt = {
		width: number
		char: string
		}
	const {width, char} = getOptions<opt>(hOptions, {
		width: 64,
		char: '-'
		})

	console.log(sep(label, char, width))
	if (isString(x)) {
		if (nonEmpty(x)) {
			console.log(x)
		}
	}
	else {
		console.log(toNice(x, hOptions))
	}
	console.log(sep(undef, char, width))
	return
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvam9obmQvdXRpbHMvc3JjL2xpYi90by1uaWNlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6L1VzZXJzL2pvaG5kL3V0aWxzL3NyYy9saWIvdG8tbmljZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxvQkFBbUI7QUFDbkIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUMxQyxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZO0FBQzlCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3pELENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ25ELENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzFDLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsU0FBUyxDQUFDO0FBQ2hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXO0FBQ25CLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ3hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTO0FBQ2pCLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU07QUFDM0QsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUEyQixNQUExQixZQUFZLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBRSxDQUFDLENBQUM7QUFDdEMsQUFBQSxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztBQUNaLEFBQUEsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNO0FBQ1gsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDZCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQztBQUFDLENBQUE7QUFDdEMsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUEseURBQXdEO0FBQ3hELEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFhLE1BQVosWUFBWSxDQUFDLENBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQy9DLEFBQUE7QUFDQSxBQUFBLENBQUMsd0RBQXVEO0FBQ3hELEFBQUE7QUFDQSxBQUFBLENBQUssTUFBSixJQUFJLENBQUMsQ0FBRSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUM7QUFDdkIsQUFBQTtBQUNBLEFBQUEsQ0FBQyx3REFBdUQ7QUFDeEQsQUFBQSxDQUFDLDZDQUE0QztBQUM3QyxBQUFBO0FBQ0EsQUFBQSxDQUFLLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJO0FBQ25ELEFBQUEsQ0FBSyxNQUFKLElBQUksQ0FBQyxDQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtBQUNyRCxBQUFBLENBQUMsTUFBTSxDQUFDLEk7QUFBSSxDQUFBO0FBQ1osQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLCtCQUE4QjtBQUM5QixBQUFBLGlFQUFnRTtBQUNoRSxBQUFBLHNDQUFxQztBQUNyQyxBQUFBO0FBQ0EsQUFBQSxBQUFjLE1BQWQsY0FBYyxDQUFDLENBQUUsQ0FBQyxDQUFDO0FBQ25CLEFBQUEsRUFBRSxTQUFTLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNyQixFQUFFLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNwQixBQUFBO0FBQ0EsQUFBQSxDQUFDLGtDQUFpQztBQUNsQyxBQUFBLENBQWtCLE1BQWpCLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3hCLEFBQUEsQyxJLEUsSSxDQUFDLEdBQUcsQ0FBQyxDQUFBLE1BQUEsR0FBSyxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUEsQ0FBQSxDQUFkLE1BQUEsQyxHLEUsRSxDQUFjO0FBQ3ZCLEFBQUEsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDO0NBQUMsQ0FBQTtBQUNkLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFnQyxRQUEvQixDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBUyxDQUFBLENBQUE7QUFDekMsQUFBQSxFQUFNLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2QsQUFBQSxFQUFNLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2QsQUFBQTtBQUNBLEFBQUEsRUFBRSxHQUFHLENBQUEsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUNsQixBQUFBLEdBQUcsR0FBRyxDQUFBLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDbkIsQUFBQSxJQUFJLDBCQUF5QjtBQUM3QixBQUFBLElBQUksTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDO0dBQUMsQ0FBQTtBQUNyRCxBQUFBLEdBQUcsSUFBSSxDQUFBLENBQUE7QUFDUCxBQUFBLElBQUksTUFBTSxDQUFDLENBQUMsQztHQUFDLEM7RUFBQSxDQUFBO0FBQ2IsQUFBQSxFQUFFLElBQUksQ0FBQSxDQUFBO0FBQ04sQUFBQSxHQUFHLEdBQUcsQ0FBQSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQ25CLEFBQUEsSUFBSSxNQUFNLENBQUMsQztHQUFDLENBQUE7QUFDWixBQUFBLEdBQUcsSUFBSSxDQUFBLENBQUE7QUFDUCxBQUFBLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEM7R0FBQyxDO0VBQUEsQztDQUFBLEM7QUFBQSxDQUFBO0FBQzdCLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBTyxNQUFOLE1BQU0sQ0FBQyxDQUFFLENBQUMsQ0FBQyxDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNuRCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDO0FBQUMsQ0FBQTtBQUNqQyxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBUSxNQUFSLFFBQVEsQ0FBQyxDQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNqRCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLEM7QUFBQyxDQUFBO0FBQ3RELEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU07QUFDeEMsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVUsTUFBVCxTQUFTLENBQUMsQ0FBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3BELEFBQUE7QUFDQSxBQUFBLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTTtBQUNqQixBQUFBLENBQUMsR0FBRyxDQUFDLENBQUEsTUFBQSxJQUFJLENBQUMsRUFBRSxDQUFDLEtB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TUFBTSxDQUFBLEFBQUMsR0FBRyxDLEM7SUFBQSxDLENBRE4sTUFBTCxLQUFLLENBQUMsQyxPQUNLO0FBQ2YsQUFBQSxJQUFJLE1BQU0sQ0FBQyxDQUFDO0FBQ1osQUFBQSxPQUFPLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzFCLEFBQUEsS0FBSyxDQUFDLENBQUMsV0FBVztBQUNsQixBQUFBLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNoQyxLQUFLLEM7R0FBQyxDQUFBO0FBQ04sQUFBQTtBQUNBLEFBQUEsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQSxDQUFBO0FBQ3hCLEFBQUEsSSxLLEMsUSxHLENBQWMsR0FBRyxDQUFDLENBQUEsTUFBQSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDM0MsQUFBQSxLLFEsTUFBSyxDQUFDLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQyxDO0lBQUMsQyxDQUQ1QixNQUFOLE1BQU0sQ0FBQyxDLFFBQzJCO0FBQ3RDLEFBQUEsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEM7R0FBQyxDQUFBO0FBQzVCLEFBQUE7QUFDQSxBQUFBLEdBQVEsTUFBTCxLQUFLLENBQUMsQ0FBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQzFCLEFBQUEsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQTtBQUN6QixBQUFBLElBQUksTUFBTSxDQUFDLEk7R0FBSSxDQUFBO0FBQ2YsQUFBQTtBQUNBLEFBQUEsR0FBc0IsTUFBbkIsSUFBSSxDLEMsQ0FBQyxBQUFDLFksWSxDQUFhLENBQUMsQ0FBRSxDQUFDLENBQUM7QUFDM0IsQUFBQSxNQUFNLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUTtBQUNsQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUM7QUFDbEQsSUFBSSxDQUFDLENBQUMsUUFBUSxVQUFVLENBQUMsQ0FBQyxZQUFZO0FBQ3RDLElBQUksQ0FBQyxxQkFBcUIsS0FBSztBQUMvQixJQUFJLENBQUM7QUFDTCxBQUFBO0FBQ0EsQUFBQSxHQUFTLE1BQU4sTUFBTSxDQUFDLENBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3ZDLEFBQUEsSUFBSSxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFFLENBQUMsUUFBUSxDQUFDLENBQUEsQ0FBQTtBQUMvQixBQUFBLEtBQUssTUFBTSxDQUFDLEs7SUFBSyxDQUFBO0FBQ2pCLEFBQUEsSUFBSSxHQUFHLENBQUEsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUNsRCxBQUFBLEtBQUssTUFBTSxDQUFDLEs7SUFBSyxDQUFBO0FBQ2pCLEFBQUEsSUFBSSxHQUFHLENBQUEsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQ3RELEFBQUEsS0FBSyxNQUFNLENBQUMsSztJQUFLLENBQUE7QUFDakIsQUFBQSxJQUFJLE1BQU0sQ0FBQyxJO0dBQUksQ0FBQTtBQUNmLEFBQUE7QUFDQSxBQUFBLEdBQUcsVUFBVSxDQUFDLEdBQUcsQ0FBQSxBQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNyQyxBQUFBO0FBQ0EsQUFBQSxHQUFHLFlBQVksQ0FBQSxBQUFDLENBQUMsQ0FBQSxJQUFJLDZDQUE0QztBQUNqRSxBQUFBO0FBQ0EsQUFBQSxHQUFTLE1BQU4sTUFBTSxDQUFDLENBQUUsQ0FBQyxDQUFDLENBQUM7QUFDZixBQUFBLEdBQUcsR0FBRyxDQUFDLENBQUEsTUFBQSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQSxDQUFBO0FBQ3ZFLEFBQUEsSUFBTyxNQUFILEdBQUcsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNqQixBQUFBLElBQUksR0FBRyxDQUFBLENBQUksaUJBQWlCLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQSxDQUFBLENBQUE7QUFDN0MsQUFBQSxLQUFXLE1BQU4sTUFBTSxDQUFDLENBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN6RCxBQUFBLEtBQVcsTUFBTixNQUFNLENBQUMsQ0FBRSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsR0FBRztBQUM1QixBQUFBLEtBQVUsTUFBTCxLQUFLLENBQUMsQ0FBRSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7QUFDakQsQUFBQSxPQUFPLE1BQU0sQ0FBQztBQUNkLEFBQUEsT0FBTyxRQUFRLENBQUM7QUFDaEIsQUFBQSxPQUFPLFVBQVUsQ0FBQztBQUNsQixBQUFBLE9BQU8sQ0FBTSxHQUFMLEtBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUN0QixPQUFPLENBQUM7QUFDUixBQUFBLEtBQUssR0FBRyxDQUFDO0FBQ1QsQUFBQSxRQUFRLE9BQU87QUFDZixBQUFBLE9BQU8sRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDbEQsQUFBQSxPQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQztBQUMvQixBQUFBLE9BQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDekIsT0FBTyxDQUFDLENBQUEsQ0FBQTtBQUNSLEFBQUEsTUFBTSxNQUFNLENBQUMsSUFBSSxDQUFBLEFBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUMsQztLQUFBLENBQUE7QUFDcEMsQUFBQSxLQUFLLElBQUksQ0FBQSxDQUFBO0FBQ1QsQUFBQSxNQUFNLE1BQU0sQ0FBQyxJQUFJLENBQUEsQUFBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzNCLEFBQUEsTUFBZSxNQUFULFNBQVMsQ0FBQyxDQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7QUFDekQsQUFBQSxNQUFNLE1BQU0sQ0FBQyxJQUFJLENBQUEsQUFBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUyxDQUFDLEM7S0FBQSxDO0lBQUEsQztHQUFBLENBQUE7QUFDNUMsQUFBQSxHQUFHLEdBQUcsQ0FBQSxPQUFPLENBQUEsQ0FBQSxDQUFBO0FBQ2IsQUFBQSxJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEc7R0FBRyxDQUFBO0FBQ3ZDLEFBQUEsR0FBRyxJQUFJLENBQUEsQ0FBQTtBQUNQLEFBQUEsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQztHQUFDLEM7RUFBQSxDO0NBQUEsQ0FBQTtBQUMxQixBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxDQUFDLEM7QUFBQyxDQUFBO0FBQy9CLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBRyxNQUFGLEVBQUUsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNwQyxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUEsQUFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxDO0FBQUEsQ0FBQTtBQUNqQyxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUcsTUFBRixFQUFFLENBQUMsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDcEMsQUFBQTtBQUNBLEFBQUEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFBLEFBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsQztBQUFBLENBQUE7QUFDbEMsQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLEFBQUEsTUFBTSxDQUFLLE1BQUosSUFBSSxDQUFDLENBQUUsQ0FBQyxDQUFDO0FBQ2hCLEFBQUEsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUE7QUFDWixBQUFBLEVBQUUsS0FBSyxDLEMsQ0FBQyxBQUFDLE0sWSxDQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQTtBQUN4QixBQUFBLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDckIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDWixBQUFBO0FBQ0EsQUFBQSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDYixBQUFBLEVBQUUsS0FBSyxDQUFDLENBQUMsTUFBTTtBQUNmLEFBQUEsRUFBRSxJQUFJLENBQUMsQ0FBQyxNQUFNO0FBQ2QsRUFBRSxDQUFDO0FBQ0gsQUFBQSxDQUFjLE1BQWIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFFLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFBLEFBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUM3QyxBQUFBLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFBO0FBQ1gsQUFBQSxFQUFFLElBQUksQ0FBQyxDQUFDLEdBQUc7QUFDWCxFQUFFLENBQUMsQ0FBQTtBQUNILEFBQUE7QUFDQSxBQUFBLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQSxBQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNwQyxBQUFBLENBQUMsR0FBRyxDQUFBLFFBQVEsQ0FBQSxBQUFDLENBQUMsQ0FBQSxDQUFBLENBQUEsQ0FBQTtBQUNkLEFBQUEsRUFBRSxHQUFHLENBQUEsUUFBUSxDQUFBLEFBQUMsQ0FBQyxDQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ2YsQUFBQSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUEsQUFBQyxDQUFDLEM7RUFBQSxDO0NBQUEsQ0FBQTtBQUNoQixBQUFBLENBQUMsSUFBSSxDQUFBLENBQUE7QUFDTCxBQUFBLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQSxBQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQztDQUFBLENBQUE7QUFDakMsQUFBQSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUEsQUFBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDcEMsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgdG8tbmljZS5saWIuY2l2ZXRcblxuaW1wb3J0IHtjeWFuLCBibHVlfSBmcm9tIFwiQHN0ZC9mbXQvY29sb3JzXCJcblxuaW1wb3J0IHtzZXB9IGZyb20gJ2Jhc2UtdXRpbHMnXG5pbXBvcnQge1xuXHRhc3NlcnQsIGNyb2FrLCB1bmRlZiwgZGVmaW5lZCwgbm90ZGVmaW5lZCwgaGFzaCwgaGFzaG9mLFxuXHRpc1N0cmluZywgaXNBcnJheSwgaXNDbGFzcywgaXNSZWdFeHAsIGlzUHJpbWl0aXZlLFxuXHRpc0VtcHR5LCBub25FbXB0eSwgYXNzZXJ0SXNIYXNoLCBpbnRlZ2VyLFxuXHRzeW1ib2xOYW1lLCBjbGFzc05hbWUsIGZ1bmN0aW9uTmFtZSwgcmVnZXhwRGVmLFxuXHR9IGZyb20gJ2RhdGF0eXBlcydcbmltcG9ydCB7XG5cdGdldE9wdGlvbnMsIGVzY2FwZVN0ciwgbywgdG9CbG9jaywgc3BhY2VzLCBtYXBFYWNoTGluZSxcblx0fSBmcm9tICdsbHV0aWxzJ1xuXG5leHBvcnQgdHlwZSBUQ29tcGFyZUZ1bmMgPSAoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IG51bWJlclxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgYWxwaGFDb21wYXJlOiBUQ29tcGFyZUZ1bmMgOj0gKFxuXHRcdGE6IHN0cmluZyxcblx0XHRiOiBzdHJpbmdcblx0XHQpOiBudW1iZXIgPT5cblxuXHRyZXR1cm4gKGEgPCBiKSA/IC0xIDogKGEgPiBiKSA/IDEgOiAwXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIC0tLSBhbnkgbGVhZGluZyBkaWdpdCBtdXN0IGJlIHByZWNlZGVkIGJ5IGEgc2luZ2xlICdcXCdcblxuZXhwb3J0IHRvTmljZVN0cmluZyA6PSAoc3RyOiBzdHJpbmcpOiBzdHJpbmcgPT5cblxuXHQjIC0tLSBlc2NhcGUgc3BhY2VzIGFuZCBcXHQsIFxcbiBvciBcXHIgd2l0aCB1bmljb2RlIGNoYXJzXG5cblx0c3RyMSA6PSBlc2NhcGVTdHIoc3RyKVxuXG5cdCMgLS0tIHByZWNlZGUgd2l0aCAnXFwnIGlmIHN0YXJ0cyB3aXRoIGRpZ2l0LCAnLicgb3IgJy0nXG5cdCMgICAgICAgICAgICAgICAgICAgICAgb3IgbG9va3MgbGlrZSBhIGxhYmVsXG5cblx0c3RyMiA6PSBzdHIxLm1hdGNoKC9eW1xcZC4tXS8pID8gXCJcXFxcI3tzdHIxfVwiIDogc3RyMVxuXHRzdHIzIDo9IHN0cjIubWF0Y2goL15bXsuzXFxzXSs6LykgPyBcIlxcXFwje3N0cjJ9XCIgOiBzdHIyXG5cdHJldHVybiBzdHIzXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiMgLS0tIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0OlxuIyAgICAgICAgY29tcGFyZXMgMiBzdHJpbmdzIGJhc2VkIG9uIHRoZWlyIHBvc2l0aW9uIGluIGxTb3J0S2V5c1xuIyAgICAgICAgZWxzZSBjb21wYXJlcyBhbHBoYWJldGljYWxseVxuXG5nZXRDb21wYXJlRnVuYyA6PSAoXG5cdFx0bFNvcnRLZXlzOiBzdHJpbmdbXVxuXHRcdCk6IFRDb21wYXJlRnVuYyA9PlxuXG5cdCMgLS0tIENyZWF0ZSBtYXAgb2Yga2V5IHRvIG51bWJlclxuXHRoOiBoYXNob2Y8bnVtYmVyPiA6PSB7fVxuXHRmb3Iga2V5LGkgb2YgbFNvcnRLZXlzXG5cdFx0aFtrZXldID0gaSsxXG5cblx0cmV0dXJuIChhOiBzdHJpbmcsIGI6IHN0cmluZyk6IG51bWJlciAtPlxuXHRcdGFWYWwgOj0gaFthXVxuXHRcdGJWYWwgOj0gaFtiXVxuXG5cdFx0aWYgZGVmaW5lZChhVmFsKVxuXHRcdFx0aWYgZGVmaW5lZChiVmFsKVxuXHRcdFx0XHQjIC0tLSBjb21wYXJlIG51bWVyaWNhbGx5XG5cdFx0XHRcdHJldHVybiAoYVZhbCA8IGJWYWwpID8gLTEgOiAoYVZhbCA+IGJWYWwpID8gMSA6IDBcblx0XHRcdGVsc2Vcblx0XHRcdFx0cmV0dXJuIC0xXG5cdFx0ZWxzZVxuXHRcdFx0aWYgZGVmaW5lZChiVmFsKVxuXHRcdFx0XHRyZXR1cm4gMVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gYWxwaGFDb21wYXJlKGEsIGIpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCByb3Rwb3MgOj0gPFQ+KGxBcnJheTogVFtdLCBpOiBpbnRlZ2VyKTogVCA9PlxuXG5cdHJldHVybiBsQXJyYXlbaSAlIGxBcnJheS5sZW5ndGhdXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmluZGVudGVkIDo9IChibG9jazogc3RyaW5nLCBvbmVJbmRlbnQ6IHN0cmluZykgPT5cblxuXHRyZXR1cm4gbWFwRWFjaExpbmUoYmxvY2ssIChsaW5lKSA9PiBvbmVJbmRlbnQgKyBsaW5lKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgdHlwZSBUUGF0aEluZGV4ID0gc3RyaW5nIHwgbnVtYmVyXG5cbmV4cG9ydCBidWlsZFBhdGggOj0gKGxQYXRoOiBUUGF0aEluZGV4W10pOiBzdHJpbmcgPT5cblxuXHRsZXQgc3RyID0gJ3Jvb3QnXG5cdGZvciBpdGVtIG9mIGxQYXRoXG5cdFx0aWYgaXNTdHJpbmcoaXRlbSlcblx0XHRcdHN0ciArPSBcIi4je2l0ZW19XCJcblx0XHRlbHNlXG5cdFx0XHRzdHIgKz0gXCJbI3tpdGVtLnRvU3RyaW5nKCl9XVwiXG5cdHJldHVybiBzdHJcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IHR5cGUgVE1hcEZ1bmMgPSAoXG5cdGtleTogc3RyaW5nXG5cdHZhbHVlOiB1bmtub3duXG5cdGhQYXJlbnQ6IGhhc2hcblx0KSA9PiB1bmtub3duXG5cbmV4cG9ydCBlbXB0eU1hcEZ1bmMgOj0gKFxuXHRcdGtleTogc3RyaW5nXG5cdFx0dmFsdWU6IHVua25vd25cblx0XHRoUGFyZW50OiBoYXNoXG5cdFx0KTogdW5rbm93biA9PlxuXHRyZXR1cm4gdW5kZWZcblxuZXhwb3J0IHRvTmljZSA6PSAoXG5cdFx0eDogdW5rbm93bixcblx0XHRoT3B0aW9uczogaGFzaD17fVxuXHRcdG1hcFZpc2l0ZWQ6IE1hcDxvYmplY3QsIHN0cmluZz4gPSBuZXcgTWFwPG9iamVjdCwgc3RyaW5nPigpXG5cdFx0bFBhdGg6IFRQYXRoSW5kZXhbXSA9IFtdXG5cdFx0KTogc3RyaW5nID0+XG5cblx0IyAtLS0gV2hlbiByZWNvdmVyYWJsZSwgY2xhc3NlcyBhbmQgZnVuY3Rpb25zXG5cdCMgICAgIGluY2x1ZGUgdGhlaXIgZGVmaW5pdGlvbnMsXG5cdCMgICAgIHdpdGggZXNjYXBlZCBjaGFyc1xuXG5cdHR5cGUgb3B0ID0ge1xuXHRcdGNvbXBhY3Q6IGJvb2xlYW5cblx0XHRyZWNvdmVyYWJsZTogYm9vbGVhblxuXHRcdGlnbm9yZUVtcHR5VmFsdWVzOiBib29sZWFuXG5cdFx0c29ydEtleXM6IGJvb2xlYW5cblx0XHRzb3J0RnVuYzogVENvbXBhcmVGdW5jP1xuXHRcdG1hcEZ1bmM6IFRNYXBGdW5jXG5cdFx0bEluY2x1ZGU6IHN0cmluZ1tdP1xuXHRcdGxFeGNsdWRlOiBzdHJpbmdbXT9cblx0XHRsSW5kZW50czogc3RyaW5nW11cblx0XHR9XG5cdHtcdFx0Y29tcGFjdFxuXHRcdFx0cmVjb3ZlcmFibGVcblx0XHRcdGlnbm9yZUVtcHR5VmFsdWVzXG5cdFx0XHRzb3J0S2V5c1xuXHRcdFx0c29ydEZ1bmNcblx0XHRcdG1hcEZ1bmNcblx0XHRcdGxJbmNsdWRlXG5cdFx0XHRsRXhjbHVkZVxuXHRcdFx0bEluZGVudHNcblx0XHR9IDo9IGdldE9wdGlvbnM8b3B0PiBoT3B0aW9ucywge1xuXHRcdGNvbXBhY3Q6IGZhbHNlXG5cdFx0cmVjb3ZlcmFibGU6IGZhbHNlXG5cdFx0aWdub3JlRW1wdHlWYWx1ZXM6IGZhbHNlXG5cdFx0c29ydEtleXM6IGZhbHNlXG5cdFx0c29ydEZ1bmM6IHVuZGVmXG5cdFx0bWFwRnVuYzogZW1wdHlNYXBGdW5jXG5cdFx0bEluY2x1ZGU6IHVuZGVmXG5cdFx0bEV4Y2x1ZGU6IHVuZGVmXG5cdFx0bEluZGVudHM6IFsnICAgJywgJ+KdmCAgJ11cblx0XHR9XG5cblx0IyAtLS0gWW91IGNhbiBwcm92aWRlIHNvcnRLZXlzIG9yIGEgc29ydEZ1bmMsIGJ1dCBub3QgYm90aFxuXHRhc3NlcnQgbm90IChzb3J0S2V5cyAmJiBkZWZpbmVkKHNvcnRGdW5jKSksIFwiQmFkIG9wdGlvbnNcIlxuXG5cdHN3aXRjaCB0eXBlb2YgeFxuXHRcdHdoZW4gJ3VuZGVmaW5lZCdcblx0XHRcdHJldHVybiAnLnVuZGVmJ1xuXG5cdFx0d2hlbiAnYm9vbGVhbidcblx0XHRcdHJldHVybiB4ID8gJy50cnVlJyA6ICcuZmFsc2UnXG5cblx0XHR3aGVuICdudW1iZXInXG5cdFx0XHRyZXR1cm4gKFxuXHRcdFx0XHQgIE51bWJlci5pc05hTih4KSAgICA/ICcuTmFOJ1xuXHRcdFx0XHQ6IE51bWJlci5pc0Zpbml0ZSh4KSA/IHgudG9TdHJpbmcoKVxuXHRcdFx0XHQ6ICgoeCA8IDApID8gJy5uZWdpbmYnIDogJy5pbmYnKVxuXHRcdFx0XHQpXG5cblx0XHR3aGVuICdiaWdpbnQnXG5cdFx0XHRyZXR1cm4geC50b1N0cmluZygpICsgJ24nXG5cblx0XHR3aGVuICdzdHJpbmcnXG5cdFx0XHRyZXR1cm4gdG9OaWNlU3RyaW5nKHgpXG5cblx0XHR3aGVuICdzeW1ib2wnXG5cdFx0XHRuYW1lIDo9IHN5bWJvbE5hbWUoeClcblx0XHRcdHJldHVybiBuYW1lID8gXCIuc3ltYm9sICN7bmFtZX1cIiA6ICcuc3ltYm9sJ1xuXG5cdFx0d2hlbiAnZnVuY3Rpb24nXG5cdFx0XHRpZiBpc0NsYXNzKHgpXG5cdFx0XHRcdHJldHVybiBcIi5jbGFzcyAje2NsYXNzTmFtZSh4KX1cIlxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gXCIuZnVuY3Rpb24gI3tmdW5jdGlvbk5hbWUoeCl9XCJcblxuXHRcdHdoZW4gJ29iamVjdCdcblx0XHRcdGlmICh4ID09IG51bGwpXG5cdFx0XHRcdHJldHVybiAnLm51bGwnXG5cblx0XHRcdGlmIGlzUmVnRXhwKHgpXG5cdFx0XHRcdHJldHVybiBcIi5yZWdleHAgI3tlc2NhcGVTdHIocmVnZXhwRGVmKHgpKX1cIlxuXG5cdFx0XHQjIC0tLSBDaGVjayBpZiBvYmplY3Qgd2FzIHByZXZpb3VzbHkgdmlzaXRlZFxuXHRcdFx0cHJldnBhdGggOj0gbWFwVmlzaXRlZC5nZXQgeFxuXHRcdFx0aWYgcHJldnBhdGhcblx0XHRcdFx0cmV0dXJuIFwiLnJlZiAje3ByZXZwYXRofVwiXG5cblx0XHRcdGlmIGlzQXJyYXkoeClcblx0XHRcdFx0aWYgKHgubGVuZ3RoID09IDApXG5cdFx0XHRcdFx0cmV0dXJuICdbXSdcblxuXHRcdFx0XHRtYXBWaXNpdGVkLnNldCB4LCBidWlsZFBhdGgobFBhdGgpXG5cdFx0XHRcdGxMaW5lcyA6PSBbXVxuXHRcdFx0XHRmb3IgdmFsLGkgb2YgeFxuXHRcdFx0XHRcdGJsb2NrIDo9IHRvTmljZShcblx0XHRcdFx0XHRcdFx0dmFsLFxuXHRcdFx0XHRcdFx0XHRoT3B0aW9ucyxcblx0XHRcdFx0XHRcdFx0bWFwVmlzaXRlZCxcblx0XHRcdFx0XHRcdFx0W2xQYXRoLi4uLCBpXVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0aWYgY29tcGFjdFxuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggYmxvY2tcblx0XHRcdFx0XHRlbHNlIGlmIGlzUHJpbWl0aXZlKHZhbCkgfHwgYmxvY2suc3RhcnRzV2l0aCgnLicpIHx8IGlzRW1wdHkodmFsKVxuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggXCItICN7YmxvY2t9XCJcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCAnLSdcblx0XHRcdFx0XHRcdG9uZUluZGVudCA6PSByb3Rwb3M8c3RyaW5nPihsSW5kZW50cywgbFBhdGgubGVuZ3RoKVxuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggaW5kZW50ZWQoYmxvY2ssIG9uZUluZGVudClcblx0XHRcdFx0aWYgY29tcGFjdFxuXHRcdFx0XHRcdHJldHVybiAnWycgKyBsTGluZXMuam9pbignICcpICsgJ10nXG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRyZXR1cm4gdG9CbG9jayhsTGluZXMpXG5cblx0XHRcdCMgLS0tIEl0J3MgYW4gb2JqZWN0XG5cdFx0XHRpZiAoeCBpbnN0YW5jZW9mIFNldClcblx0XHRcdFx0bEtleXMgOj0gZm9yIGtleSBvZiB4LmtleXMoKVxuXHRcdFx0XHRcdHRvTmljZSBrZXlcblx0XHRcdFx0cmV0dXJuIChcblx0XHRcdFx0XHQgIChsS2V5cy5sZW5ndGggPT0gMClcblx0XHRcdFx0XHQ/IFwiLmVtcHR5U2V0XCJcblx0XHRcdFx0XHQ6IFwiLnNldCAje2xLZXlzLmpvaW4oJyAnKX1cIlxuXHRcdFx0XHRcdClcblxuXHRcdFx0aWYgKHggaW5zdGFuY2VvZiBNYXApXG5cdFx0XHRcdGxMaW5lcyA6PSBmb3IgW2tleSwgdmFsXSBvZiB4LmVudHJpZXMoKVxuXHRcdFx0XHRcdFwiI3t0b05pY2Uoa2V5KX06OiAje3RvTmljZSh2YWwpfVwiXG5cdFx0XHRcdHJldHVybiBsTGluZXMuam9pbignXFxuJylcblxuXHRcdFx0bEtleXMgOj0gT2JqZWN0LmtleXMoeClcblx0XHRcdGlmIChsS2V5cy5sZW5ndGggPT0gMClcblx0XHRcdFx0cmV0dXJuICd7fSdcblxuXHRcdFx0ZnVuYzogVENvbXBhcmVGdW5jPyA6PSAoXG5cdFx0XHRcdCAgZGVmaW5lZChzb3J0RnVuYykgPyBzb3J0RnVuY1xuXHRcdFx0XHQ6IGRlZmluZWQobEluY2x1ZGUpID8gZ2V0Q29tcGFyZUZ1bmMobEluY2x1ZGUpXG5cdFx0XHRcdDogc29ydEtleXMgICAgICAgICAgPyBhbHBoYUNvbXBhcmVcblx0XHRcdFx0OiAgICAgICAgICAgICAgICAgICAgIHVuZGVmXG5cdFx0XHRcdClcblxuXHRcdFx0dXNlS2V5IDo9IChrZXk6IHVua25vd24pOiBib29sZWFuID0+XG5cdFx0XHRcdGlmICh0eXBlb2Yga2V5ICE9ICdzdHJpbmcnKVxuXHRcdFx0XHRcdHJldHVybiBmYWxzZVxuXHRcdFx0XHRpZiBkZWZpbmVkKGxFeGNsdWRlKSAmJiBsRXhjbHVkZS5pbmNsdWRlcyhrZXkpXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdGlmIGRlZmluZWQobEluY2x1ZGUpICYmIG5vdCBsSW5jbHVkZS5pbmNsdWRlcyhrZXkpXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdHJldHVybiB0cnVlXG5cblx0XHRcdG1hcFZpc2l0ZWQuc2V0IHgsIGJ1aWxkUGF0aChsUGF0aClcblxuXHRcdFx0YXNzZXJ0SXNIYXNoIHggICAgIyAtLS0gd2lsbCBhbGxvdyB1cyB0byBpbmRleCB3aXRoIGFueSBzdHJpbmdcblxuXHRcdFx0bExpbmVzIDo9IFtdXG5cdFx0XHRmb3Iga2V5IG9mIChkZWZpbmVkKGZ1bmMpID8gbEtleXMuc29ydChmdW5jKSA6IGxLZXlzKS5maWx0ZXIodXNlS2V5KVxuXHRcdFx0XHR2YWwgOj0geFtrZXldXG5cdFx0XHRcdGlmIG5vdCBpZ25vcmVFbXB0eVZhbHVlcyB8fCBub25FbXB0eSh2YWwpXG5cdFx0XHRcdFx0bWFwcGVkIDo9IHJlY292ZXJhYmxlID8gdW5kZWYgOiBtYXBGdW5jKGtleSwgdmFsLCB4KVxuXHRcdFx0XHRcdG5ld3ZhbCA6PSBtYXBwZWQgfHwgdmFsXG5cdFx0XHRcdFx0YmxvY2sgOj0gaXNTdHJpbmcobWFwcGVkKSA/IG1hcHBlZCA6IHRvTmljZShcblx0XHRcdFx0XHRcdFx0bmV3dmFsLFxuXHRcdFx0XHRcdFx0XHRoT3B0aW9ucyxcblx0XHRcdFx0XHRcdFx0bWFwVmlzaXRlZCxcblx0XHRcdFx0XHRcdFx0W2xQYXRoLi4uLCBrZXldXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRcdFx0Y29tcGFjdFxuXHRcdFx0XHRcdFx0XHR8fCAoZGVmaW5lZChuZXd2YWwpICYmIGlzUHJpbWl0aXZlKG5ld3ZhbCkpXG5cdFx0XHRcdFx0XHRcdHx8IGJsb2NrLnN0YXJ0c1dpdGgoJy4nKVxuXHRcdFx0XHRcdFx0XHR8fCBpc0VtcHR5KG5ld3ZhbClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggXCIje2tleX06ICN7YmxvY2t9XCJcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBcIiN7a2V5fTpcIlxuXHRcdFx0XHRcdFx0b25lSW5kZW50IDo9IHJvdHBvczxzdHJpbmc+KGxJbmRlbnRzLCBsUGF0aC5sZW5ndGgpXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBpbmRlbnRlZChibG9jaywgb25lSW5kZW50KVxuXHRcdFx0aWYgY29tcGFjdFxuXHRcdFx0XHRyZXR1cm4gJ3snICsgbExpbmVzLmpvaW4oJyAnKSArICd9J1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gdG9CbG9jayhsTGluZXMpXG5cblx0cmV0dXJuIFwiPFVua25vd24gb2JqZWN0ICN7eH0+XCJcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IE9MIDo9ICh4OiB1bmtub3duKTogc3RyaW5nID0+XG5cblx0cmV0dXJuIHRvTmljZSB4LCB7Y29tcGFjdDogdHJ1ZX1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IE1MIDo9ICh4OiB1bmtub3duKTogc3RyaW5nID0+XG5cblx0cmV0dXJuIHRvTmljZSB4LCB7Y29tcGFjdDogZmFsc2V9XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBEVU1QIDo9IChcblx0XHR4OiB1bmtub3duXG5cdFx0bGFiZWw6IHN0cmluZz8gPSB1bmRlZlxuXHRcdGhPcHRpb25zOiBoYXNoID0ge31cblx0XHQpOiB2b2lkID0+XG5cblx0dHlwZSBvcHQgPSB7XG5cdFx0d2lkdGg6IG51bWJlclxuXHRcdGNoYXI6IHN0cmluZ1xuXHRcdH1cblx0e3dpZHRoLCBjaGFyfSA6PSBnZXRPcHRpb25zPG9wdD4gaE9wdGlvbnMsIHtcblx0XHR3aWR0aDogNjRcblx0XHRjaGFyOiAnLSdcblx0XHR9XG5cblx0Y29uc29sZS5sb2cgc2VwKGxhYmVsLCBjaGFyLCB3aWR0aClcblx0aWYgaXNTdHJpbmcgeFxuXHRcdGlmIG5vbkVtcHR5IHhcblx0XHRcdGNvbnNvbGUubG9nIHhcblx0ZWxzZVxuXHRcdGNvbnNvbGUubG9nIHRvTmljZSh4LCBoT3B0aW9ucylcblx0Y29uc29sZS5sb2cgc2VwKHVuZGVmLCBjaGFyLCB3aWR0aClcblx0cmV0dXJuXG4iXX0=