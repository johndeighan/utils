"use strict";
// to-nice.lib.civet

import {cyan, blue} from "@std/fmt/colors"

import {sep} from 'base-utils'
import {
	assert, croak, undef, defined, notdefined, hash, hashof,
	isString, isArray, isClass, isRegExp, isPrimitive,
	isEmpty, nonEmpty, assertIsHash, integer,
	symbolName, className, functionName, regexpDef,
	} from 'datatypes'
import {
	getOptions, escapeStr, o, toBlock, spaces, mapEachLine,
	} from 'llutils'

export type TCompareFunc = (a: string, b: string) => number

// ---------------------------------------------------------------------------

export const alphaCompare: TCompareFunc = (
		a: string,
		b: string
		): number => {

	return (a < b) ? -1 : (a > b) ? 1 : 0
}

// ---------------------------------------------------------------------------
// --- any leading digit must be preceded by a single '\'

export const toNiceString = (str: string): string => {

	// --- escape spaces and \t, \n or \r with unicode chars

	const str1 = escapeStr(str)

	// --- precede with '\' if starts with digit, '.' or '-'
	//                      or looks like a label

	const str2 = str1.match(/^[\d.-]/) ? `\\${str1}` : str1
	const str3 = str2.match(/^[^˳\s]+:/) ? `\\${str2}` : str2
	return str3
}

// ---------------------------------------------------------------------------

// --- Returns a function that:
//        compares 2 strings based on their position in lSortKeys
//        else compares alphabetically

const getCompareFunc = (
		lSortKeys: string[]
		): TCompareFunc => {

	// --- Create map of key to number
	const h: hashof<number> = {}
	let i1 = 0;for (const key of lSortKeys) {const i = i1++;
		h[key] = i+1
	}

	return function(a: string, b: string): number {
		const aVal = h[a]
		const bVal = h[b]

		if (defined(aVal)) {
			if (defined(bVal)) {
				// --- compare numerically
				return (aVal < bVal) ? -1 : (aVal > bVal) ? 1 : 0
			}
			else {
				return -1
			}
		}
		else {
			if (defined(bVal)) {
				return 1
			}
			else {
				return alphaCompare(a, b)
			}
		}
	}
}

// ---------------------------------------------------------------------------

export const rotpos = <T,>(lArray: T[], i: integer): T => {

	return lArray[i % lArray.length]
}

// ---------------------------------------------------------------------------

const indented = (block: string, oneIndent: string) => {

	return mapEachLine(block, (line) => oneIndent + line)
}

// ---------------------------------------------------------------------------

export type TPathIndex = string | number

export const buildPath = (lPath: TPathIndex[]): string => {

	let str = 'root'
	for (const item of lPath) {
		if (isString(item)) {
			str += `.${item}`
		}
		else {
			str += `[${item.toString()}]`
		}
	}
	return str
}

// ---------------------------------------------------------------------------

export type TMapFunc = (
	key: string,
	value: unknown,
	hParent: hash
	) => unknown

export const emptyMapFunc = (
		key: string,
		value: unknown,
		hParent: hash
		): unknown => {
	return undef
}

export const toNice = (
		x: unknown,
		hOptions: hash={},
		mapVisited: Map<object, string> = new Map<object, string>(),
		lPath: TPathIndex[] = []
		): string => {

	// --- When recoverable, classes and functions
	//     include their definitions,
	//     with escaped chars

	type opt = {
		compact: boolean
		recoverable: boolean
		ignoreEmptyValues: boolean
		sortKeys: boolean
		sortFunc: (TCompareFunc | undefined)
		mapFunc: TMapFunc
		lInclude: ((string[]) | undefined)
		lExclude: ((string[]) | undefined)
		lIndents: string[]
		}
	const {		compact,
			recoverable,
			ignoreEmptyValues,
			sortKeys,
			sortFunc,
			mapFunc,
			lInclude,
			lExclude,
			lIndents
		} = getOptions<opt>(hOptions, {
		compact: false,
		recoverable: false,
		ignoreEmptyValues: false,
		sortKeys: false,
		sortFunc: undef,
		mapFunc: emptyMapFunc,
		lInclude: undef,
		lExclude: undef,
		lIndents: ['   ', '❘  ']
		})

	// --- You can provide sortKeys or a sortFunc, but not both
	assert(!(sortKeys && defined(sortFunc)), "Bad options")

	switch(typeof x) {
		case 'undefined': {
			return '.undef'
		}

		case 'boolean': {
			return x ? '.true' : '.false'
		}

		case 'number': {
			return (
				  Number.isNaN(x)    ? '.NaN'
				: Number.isFinite(x) ? x.toString()
				: ((x < 0) ? '.neginf' : '.inf')
				)
		}

		case 'bigint': {
			return x.toString() + 'n'
		}

		case 'string': {
			return toNiceString(x)
		}

		case 'symbol': {
			const name = symbolName(x)
			return name ? `.symbol ${name}` : '.symbol'
		}

		case 'function': {
			if (isClass(x)) {
				return `.class ${className(x)}`
			}
			else {
				return `.function ${functionName(x)}`
			}
		}

		case 'object': {
			if (x === null) {
				return '.null'
			}

			if (isRegExp(x)) {
				return `.regexp ${escapeStr(regexpDef(x))}`
			}

			// --- Check if object was previously visited
			const prevpath = mapVisited.get(x)
			if (prevpath) {
				return `.ref ${prevpath}`
			}

			if (isArray(x)) {
				if (x.length === 0) {
					return '[]'
				}

				mapVisited.set(x, buildPath(lPath))
				const lLines = []
				let i2 = 0;for (const val of x) {const i = i2++;
					const block = toNice(
							val,
							hOptions,
							mapVisited,
							[...lPath, i]
							)
					if (compact) {
						lLines.push(block)
					}
					else if (isPrimitive(val) || block.startsWith('.') || isEmpty(val)) {
						lLines.push(`- ${block}`)
					}
					else {
						lLines.push('-')
						const oneIndent = rotpos<string>(lIndents, lPath.length)
						lLines.push(indented(block, oneIndent))
					}
				}
				if (compact) {
					return '[' + lLines.join(' ') + ']'
				}
				else {
					return toBlock(lLines)
				}
			}

			const lKeys = Object.keys(x)
			if (lKeys.length === 0) {
				return '{}'
			}

			const func: (TCompareFunc | undefined) = (
				  defined(sortFunc) ? sortFunc
				: defined(lInclude) ? getCompareFunc(lInclude)
				: sortKeys          ? alphaCompare
				:                     undef
				)

			const useKey = (key: unknown): boolean => {
				if (typeof key !== 'string') {
					return false
				}
				if (defined(lExclude) && lExclude.includes(key)) {
					return false
				}
				if (defined(lInclude) && !lInclude.includes(key)) {
					return false
				}
				return true
			}

			mapVisited.set(x, buildPath(lPath))

			assertIsHash(x)    // --- will allow us to index with any string

			const lLines = []
			for (const key of (defined(func) ? lKeys.sort(func) : lKeys).filter(useKey)) {
				const val = x[key]
				if (!ignoreEmptyValues || nonEmpty(val)) {
					const mapped = recoverable ? undef : mapFunc(key, val, x)
					const newval = mapped || val
					const block = isString(mapped) ? mapped : toNice(
							newval,
							hOptions,
							mapVisited,
							[...lPath, key]
							)
					if (
								compact
							|| (defined(newval) && isPrimitive(newval))
							|| block.startsWith('.')
							|| isEmpty(newval)
							) {
						lLines.push(`${key}: ${block}`)
					}
					else {
						lLines.push(`${key}:`)
						const oneIndent = rotpos<string>(lIndents, lPath.length)
						lLines.push(indented(block, oneIndent))
					}
				}
			}
			if (compact) {
				return '{' + lLines.join(' ') + '}'
			}
			else {
				return toBlock(lLines)
			}
		}
	}

	return `<Unknown object ${x}>`
}

// ---------------------------------------------------------------------------

export const OL = (x: unknown): string => {

	return toNice(x, {compact: true})
}

// ---------------------------------------------------------------------------

export const ML = (x: unknown): string => {

	return toNice(x, {compact: false})
}

// ---------------------------------------------------------------------------

export const DUMP = (
		x: unknown,
		label: (string | undefined) = undef,
		hOptions: hash = {}
		): void => {

	type opt = {
		width: number
		char: string
		}
	const {width, char} = getOptions<opt>(hOptions, {
		width: 64,
		char: '-'
		})

	console.log(sep(label, char, width))
	if (isString(x)) {
		if (nonEmpty(x)) {
			console.log(x)
		}
	}
	else {
		console.log(toNice(x, hOptions))
	}
	console.log(sep(undef, char, width))
	return
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFx0by1uaWNlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXGxpYlxcdG8tbmljZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxvQkFBbUI7QUFDbkIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUMxQyxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZO0FBQzlCLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3pELENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ25ELENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzFDLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsU0FBUyxDQUFDO0FBQ2hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXO0FBQ25CLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ3hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTO0FBQ2pCLEFBQUE7QUFDQSxBQUFBLEFB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LE1BQU0sQ0FBTyxNQUFOLE1BQU0sQ0FBQyxDQUFFLENBQUMsQ0FBQyxDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNuRCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDO0FBQUMsQ0FBQTtBQUNqQyxBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBUSxNQUFSLFFBQVEsQ0FBQyxDQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNqRCxBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLEM7QUFBQyxDQUFBO0FBQ3RELEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU07QUFDeEMsQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQVUsTUFBVCxTQUFTLENBQUMsQ0FBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQSxDQUFBO0FBQ3BELEFBQUE7QUFDQSxBQUFBLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTTtBQUNqQixBQUFBLENBQUMsR0FBRyxDQUFDLENBQUEsTUFBQSxJQUFJLENBQUMs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QUFFLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFBLENBQUEsQ0FBQTtBQUN0RSxBQUFBLE1BQU0sTUFBTSxDQUFDLElBQUksQ0FBQSxBQUFDLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDLEM7S0FBQSxDQUFBO0FBQzlCLEFBQUEsS0FBSyxJQUFJLENBQUEsQ0FBQTtBQUNULEFBQUEsTUFBTSxNQUFNLENBQUMsSUFBSSxDQUFBLEFBQUMsR0FBRyxDQUFBO0FBQ3JCLEFBQUEsTUFBZSxNQUFULFNBQVMsQ0FBQyxDQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7QUFDekQsQUFBQSxNQUFNLE1BQU0sQ0FBQyxJQUFJLENBQUEsQUFBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUyxDQUFDLEM7S0FBQSxDO0lBQUEsQ0FBQTtBQUM1QyxBQUFBLElBQUksR0FBRyxDQUFBLE9BQU8sQ0FBQSxDQUFBLENBQUE7QUFDZCxBQUFBLEtBQUssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRztJQUFHLENBQUE7QUFDeEMsQUFBQSxJQUFJLElBQUksQ0FBQSxDQUFBO0FBQ1IsQUFBQSxLQUFLLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDO0lBQUMsQztHQUFBLENBQUE7QUFDM0IsQUFBQTtBQUNBLEFBQUEsR0FBUSxNQUFMLEtBQUssQ0FBQyxDQUFFLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDMUIsQUFBQSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQSxDQUFBO0FBQ3pCLEFBQUEsSUFBSSxNQUFNLENBQUMsSTtHQUFJLENBQUE7QUFDZixBQUFBO0FBQ0EsQUFB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QyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNwQyxBQUFBLENBQUMsTTtBQUFNLENBQUE7QUFDUCIsIm5hbWVzIjpbXSwic291cmNlc0NvbnRlbnQiOlsiIyB0by1uaWNlLmxpYi5jaXZldFxuXG5pbXBvcnQge2N5YW4sIGJsdWV9IGZyb20gXCJAc3RkL2ZtdC9jb2xvcnNcIlxuXG5pbXBvcnQge3NlcH0gZnJvbSAnYmFzZS11dGlscydcbmltcG9ydCB7XG5cdGFzc2VydCwgY3JvYWssIHVuZGVmLCBkZWZpbmVkLCBub3RkZWZpbmVkLCBoYXNoLCBoYXNob2YsXG5cdGlzU3RyaW5nLCBpc0FycmF5LCBpc0NsYXNzLCBpc1JlZ0V4cCwgaXNQcmltaXRpdmUsXG5cdGlzRW1wdHksIG5vbkVtcHR5LCBhc3NlcnRJc0hhc2gsIGludGVnZXIsXG5cdHN5bWJvbE5hbWUsIGNsYXNzTmFtZSwgZnVuY3Rpb25OYW1lLCByZWdleHBEZWYsXG5cdH0gZnJvbSAnZGF0YXR5cGVzJ1xuaW1wb3J0IHtcblx0Z2V0T3B0aW9ucywgZXNjYXBlU3RyLCBvLCB0b0Jsb2NrLCBzcGFjZXMsIG1hcEVhY2hMaW5lLFxuXHR9IGZyb20gJ2xsdXRpbHMnXG5cbmV4cG9ydCB0eXBlIFRDb21wYXJlRnVuYyA9IChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gbnVtYmVyXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBhbHBoYUNvbXBhcmU6IFRDb21wYXJlRnVuYyA6PSAoXG5cdFx0YTogc3RyaW5nLFxuXHRcdGI6IHN0cmluZ1xuXHRcdCk6IG51bWJlciA9PlxuXG5cdHJldHVybiAoYSA8IGIpID8gLTEgOiAoYSA+IGIpID8gMSA6IDBcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIGFueSBsZWFkaW5nIGRpZ2l0IG11c3QgYmUgcHJlY2VkZWQgYnkgYSBzaW5nbGUgJ1xcJ1xuXG5leHBvcnQgdG9OaWNlU3RyaW5nIDo9IChzdHI6IHN0cmluZyk6IHN0cmluZyA9PlxuXG5cdCMgLS0tIGVzY2FwZSBzcGFjZXMgYW5kIFxcdCwgXFxuIG9yIFxcciB3aXRoIHVuaWNvZGUgY2hhcnNcblxuXHRzdHIxIDo9IGVzY2FwZVN0cihzdHIpXG5cblx0IyAtLS0gcHJlY2VkZSB3aXRoICdcXCcgaWYgc3RhcnRzIHdpdGggZGlnaXQsICcuJyBvciAnLSdcblx0IyAgICAgICAgICAgICAgICAgICAgICBvciBsb29rcyBsaWtlIGEgbGFiZWxcblxuXHRzdHIyIDo9IHN0cjEubWF0Y2goL15bXFxkLi1dLykgPyBcIlxcXFwje3N0cjF9XCIgOiBzdHIxXG5cdHN0cjMgOj0gc3RyMi5tYXRjaCgvXltey7NcXHNdKzovKSA/IFwiXFxcXCN7c3RyMn1cIiA6IHN0cjJcblx0cmV0dXJuIHN0cjNcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIyAtLS0gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQ6XG4jICAgICAgICBjb21wYXJlcyAyIHN0cmluZ3MgYmFzZWQgb24gdGhlaXIgcG9zaXRpb24gaW4gbFNvcnRLZXlzXG4jICAgICAgICBlbHNlIGNvbXBhcmVzIGFscGhhYmV0aWNhbGx5XG5cbmdldENvbXBhcmVGdW5jIDo9IChcblx0XHRsU29ydEtleXM6IHN0cmluZ1tdXG5cdFx0KTogVENvbXBhcmVGdW5jID0+XG5cblx0IyAtLS0gQ3JlYXRlIG1hcCBvZiBrZXkgdG8gbnVtYmVyXG5cdGg6IGhhc2hvZjxudW1iZXI+IDo9IHt9XG5cdGZvciBrZXksaSBvZiBsU29ydEtleXNcblx0XHRoW2tleV0gPSBpKzFcblxuXHRyZXR1cm4gKGE6IHN0cmluZywgYjogc3RyaW5nKTogbnVtYmVyIC0+XG5cdFx0YVZhbCA6PSBoW2FdXG5cdFx0YlZhbCA6PSBoW2JdXG5cblx0XHRpZiBkZWZpbmVkKGFWYWwpXG5cdFx0XHRpZiBkZWZpbmVkKGJWYWwpXG5cdFx0XHRcdCMgLS0tIGNvbXBhcmUgbnVtZXJpY2FsbHlcblx0XHRcdFx0cmV0dXJuIChhVmFsIDwgYlZhbCkgPyAtMSA6IChhVmFsID4gYlZhbCkgPyAxIDogMFxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gLTFcblx0XHRlbHNlXG5cdFx0XHRpZiBkZWZpbmVkKGJWYWwpXG5cdFx0XHRcdHJldHVybiAxXG5cdFx0XHRlbHNlXG5cdFx0XHRcdHJldHVybiBhbHBoYUNvbXBhcmUoYSwgYilcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IHJvdHBvcyA6PSA8VD4obEFycmF5OiBUW10sIGk6IGludGVnZXIpOiBUID0+XG5cblx0cmV0dXJuIGxBcnJheVtpICUgbEFycmF5Lmxlbmd0aF1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuaW5kZW50ZWQgOj0gKGJsb2NrOiBzdHJpbmcsIG9uZUluZGVudDogc3RyaW5nKSA9PlxuXG5cdHJldHVybiBtYXBFYWNoTGluZShibG9jaywgKGxpbmUpID0+IG9uZUluZGVudCArIGxpbmUpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCB0eXBlIFRQYXRoSW5kZXggPSBzdHJpbmcgfCBudW1iZXJcblxuZXhwb3J0IGJ1aWxkUGF0aCA6PSAobFBhdGg6IFRQYXRoSW5kZXhbXSk6IHN0cmluZyA9PlxuXG5cdGxldCBzdHIgPSAncm9vdCdcblx0Zm9yIGl0ZW0gb2YgbFBhdGhcblx0XHRpZiBpc1N0cmluZyhpdGVtKVxuXHRcdFx0c3RyICs9IFwiLiN7aXRlbX1cIlxuXHRcdGVsc2Vcblx0XHRcdHN0ciArPSBcIlsje2l0ZW0udG9TdHJpbmcoKX1dXCJcblx0cmV0dXJuIHN0clxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgdHlwZSBUTWFwRnVuYyA9IChcblx0a2V5OiBzdHJpbmdcblx0dmFsdWU6IHVua25vd25cblx0aFBhcmVudDogaGFzaFxuXHQpID0+IHVua25vd25cblxuZXhwb3J0IGVtcHR5TWFwRnVuYyA6PSAoXG5cdFx0a2V5OiBzdHJpbmdcblx0XHR2YWx1ZTogdW5rbm93blxuXHRcdGhQYXJlbnQ6IGhhc2hcblx0XHQpOiB1bmtub3duID0+XG5cdHJldHVybiB1bmRlZlxuXG5leHBvcnQgdG9OaWNlIDo9IChcblx0XHR4OiB1bmtub3duLFxuXHRcdGhPcHRpb25zOiBoYXNoPXt9XG5cdFx0bWFwVmlzaXRlZDogTWFwPG9iamVjdCwgc3RyaW5nPiA9IG5ldyBNYXA8b2JqZWN0LCBzdHJpbmc+KClcblx0XHRsUGF0aDogVFBhdGhJbmRleFtdID0gW11cblx0XHQpOiBzdHJpbmcgPT5cblxuXHQjIC0tLSBXaGVuIHJlY292ZXJhYmxlLCBjbGFzc2VzIGFuZCBmdW5jdGlvbnNcblx0IyAgICAgaW5jbHVkZSB0aGVpciBkZWZpbml0aW9ucyxcblx0IyAgICAgd2l0aCBlc2NhcGVkIGNoYXJzXG5cblx0dHlwZSBvcHQgPSB7XG5cdFx0Y29tcGFjdDogYm9vbGVhblxuXHRcdHJlY292ZXJhYmxlOiBib29sZWFuXG5cdFx0aWdub3JlRW1wdHlWYWx1ZXM6IGJvb2xlYW5cblx0XHRzb3J0S2V5czogYm9vbGVhblxuXHRcdHNvcnRGdW5jOiBUQ29tcGFyZUZ1bmM/XG5cdFx0bWFwRnVuYzogVE1hcEZ1bmNcblx0XHRsSW5jbHVkZTogc3RyaW5nW10/XG5cdFx0bEV4Y2x1ZGU6IHN0cmluZ1tdP1xuXHRcdGxJbmRlbnRzOiBzdHJpbmdbXVxuXHRcdH1cblx0e1x0XHRjb21wYWN0XG5cdFx0XHRyZWNvdmVyYWJsZVxuXHRcdFx0aWdub3JlRW1wdHlWYWx1ZXNcblx0XHRcdHNvcnRLZXlzXG5cdFx0XHRzb3J0RnVuY1xuXHRcdFx0bWFwRnVuY1xuXHRcdFx0bEluY2x1ZGVcblx0XHRcdGxFeGNsdWRlXG5cdFx0XHRsSW5kZW50c1xuXHRcdH0gOj0gZ2V0T3B0aW9uczxvcHQ+IGhPcHRpb25zLCB7XG5cdFx0Y29tcGFjdDogZmFsc2Vcblx0XHRyZWNvdmVyYWJsZTogZmFsc2Vcblx0XHRpZ25vcmVFbXB0eVZhbHVlczogZmFsc2Vcblx0XHRzb3J0S2V5czogZmFsc2Vcblx0XHRzb3J0RnVuYzogdW5kZWZcblx0XHRtYXBGdW5jOiBlbXB0eU1hcEZ1bmNcblx0XHRsSW5jbHVkZTogdW5kZWZcblx0XHRsRXhjbHVkZTogdW5kZWZcblx0XHRsSW5kZW50czogWycgICAnLCAn4p2YICAnXVxuXHRcdH1cblxuXHQjIC0tLSBZb3UgY2FuIHByb3ZpZGUgc29ydEtleXMgb3IgYSBzb3J0RnVuYywgYnV0IG5vdCBib3RoXG5cdGFzc2VydCBub3QgKHNvcnRLZXlzICYmIGRlZmluZWQoc29ydEZ1bmMpKSwgXCJCYWQgb3B0aW9uc1wiXG5cblx0c3dpdGNoIHR5cGVvZiB4XG5cdFx0d2hlbiAndW5kZWZpbmVkJ1xuXHRcdFx0cmV0dXJuICcudW5kZWYnXG5cblx0XHR3aGVuICdib29sZWFuJ1xuXHRcdFx0cmV0dXJuIHggPyAnLnRydWUnIDogJy5mYWxzZSdcblxuXHRcdHdoZW4gJ251bWJlcidcblx0XHRcdHJldHVybiAoXG5cdFx0XHRcdCAgTnVtYmVyLmlzTmFOKHgpICAgID8gJy5OYU4nXG5cdFx0XHRcdDogTnVtYmVyLmlzRmluaXRlKHgpID8geC50b1N0cmluZygpXG5cdFx0XHRcdDogKCh4IDwgMCkgPyAnLm5lZ2luZicgOiAnLmluZicpXG5cdFx0XHRcdClcblxuXHRcdHdoZW4gJ2JpZ2ludCdcblx0XHRcdHJldHVybiB4LnRvU3RyaW5nKCkgKyAnbidcblxuXHRcdHdoZW4gJ3N0cmluZydcblx0XHRcdHJldHVybiB0b05pY2VTdHJpbmcoeClcblxuXHRcdHdoZW4gJ3N5bWJvbCdcblx0XHRcdG5hbWUgOj0gc3ltYm9sTmFtZSh4KVxuXHRcdFx0cmV0dXJuIG5hbWUgPyBcIi5zeW1ib2wgI3tuYW1lfVwiIDogJy5zeW1ib2wnXG5cblx0XHR3aGVuICdmdW5jdGlvbidcblx0XHRcdGlmIGlzQ2xhc3MoeClcblx0XHRcdFx0cmV0dXJuIFwiLmNsYXNzICN7Y2xhc3NOYW1lKHgpfVwiXG5cdFx0XHRlbHNlXG5cdFx0XHRcdHJldHVybiBcIi5mdW5jdGlvbiAje2Z1bmN0aW9uTmFtZSh4KX1cIlxuXG5cdFx0d2hlbiAnb2JqZWN0J1xuXHRcdFx0aWYgKHggPT0gbnVsbClcblx0XHRcdFx0cmV0dXJuICcubnVsbCdcblxuXHRcdFx0aWYgaXNSZWdFeHAoeClcblx0XHRcdFx0cmV0dXJuIFwiLnJlZ2V4cCAje2VzY2FwZVN0cihyZWdleHBEZWYoeCkpfVwiXG5cblx0XHRcdCMgLS0tIENoZWNrIGlmIG9iamVjdCB3YXMgcHJldmlvdXNseSB2aXNpdGVkXG5cdFx0XHRwcmV2cGF0aCA6PSBtYXBWaXNpdGVkLmdldCB4XG5cdFx0XHRpZiBwcmV2cGF0aFxuXHRcdFx0XHRyZXR1cm4gXCIucmVmICN7cHJldnBhdGh9XCJcblxuXHRcdFx0aWYgaXNBcnJheSh4KVxuXHRcdFx0XHRpZiAoeC5sZW5ndGggPT0gMClcblx0XHRcdFx0XHRyZXR1cm4gJ1tdJ1xuXG5cdFx0XHRcdG1hcFZpc2l0ZWQuc2V0IHgsIGJ1aWxkUGF0aChsUGF0aClcblx0XHRcdFx0bExpbmVzIDo9IFtdXG5cdFx0XHRcdGZvciB2YWwsaSBvZiB4XG5cdFx0XHRcdFx0YmxvY2sgOj0gdG9OaWNlKFxuXHRcdFx0XHRcdFx0XHR2YWwsXG5cdFx0XHRcdFx0XHRcdGhPcHRpb25zLFxuXHRcdFx0XHRcdFx0XHRtYXBWaXNpdGVkLFxuXHRcdFx0XHRcdFx0XHRbbFBhdGguLi4sIGldXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRpZiBjb21wYWN0XG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBibG9ja1xuXHRcdFx0XHRcdGVsc2UgaWYgaXNQcmltaXRpdmUodmFsKSB8fCBibG9jay5zdGFydHNXaXRoKCcuJykgfHwgaXNFbXB0eSh2YWwpXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBcIi0gI3tibG9ja31cIlxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdGxMaW5lcy5wdXNoICctJ1xuXHRcdFx0XHRcdFx0b25lSW5kZW50IDo9IHJvdHBvczxzdHJpbmc+KGxJbmRlbnRzLCBsUGF0aC5sZW5ndGgpXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBpbmRlbnRlZChibG9jaywgb25lSW5kZW50KVxuXHRcdFx0XHRpZiBjb21wYWN0XG5cdFx0XHRcdFx0cmV0dXJuICdbJyArIGxMaW5lcy5qb2luKCcgJykgKyAnXSdcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHJldHVybiB0b0Jsb2NrKGxMaW5lcylcblxuXHRcdFx0bEtleXMgOj0gT2JqZWN0LmtleXMoeClcblx0XHRcdGlmIChsS2V5cy5sZW5ndGggPT0gMClcblx0XHRcdFx0cmV0dXJuICd7fSdcblxuXHRcdFx0ZnVuYzogVENvbXBhcmVGdW5jPyA6PSAoXG5cdFx0XHRcdCAgZGVmaW5lZChzb3J0RnVuYykgPyBzb3J0RnVuY1xuXHRcdFx0XHQ6IGRlZmluZWQobEluY2x1ZGUpID8gZ2V0Q29tcGFyZUZ1bmMobEluY2x1ZGUpXG5cdFx0XHRcdDogc29ydEtleXMgICAgICAgICAgPyBhbHBoYUNvbXBhcmVcblx0XHRcdFx0OiAgICAgICAgICAgICAgICAgICAgIHVuZGVmXG5cdFx0XHRcdClcblxuXHRcdFx0dXNlS2V5IDo9IChrZXk6IHVua25vd24pOiBib29sZWFuID0+XG5cdFx0XHRcdGlmICh0eXBlb2Yga2V5ICE9ICdzdHJpbmcnKVxuXHRcdFx0XHRcdHJldHVybiBmYWxzZVxuXHRcdFx0XHRpZiBkZWZpbmVkKGxFeGNsdWRlKSAmJiBsRXhjbHVkZS5pbmNsdWRlcyhrZXkpXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdGlmIGRlZmluZWQobEluY2x1ZGUpICYmIG5vdCBsSW5jbHVkZS5pbmNsdWRlcyhrZXkpXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdHJldHVybiB0cnVlXG5cblx0XHRcdG1hcFZpc2l0ZWQuc2V0IHgsIGJ1aWxkUGF0aChsUGF0aClcblxuXHRcdFx0YXNzZXJ0SXNIYXNoIHggICAgIyAtLS0gd2lsbCBhbGxvdyB1cyB0byBpbmRleCB3aXRoIGFueSBzdHJpbmdcblxuXHRcdFx0bExpbmVzIDo9IFtdXG5cdFx0XHRmb3Iga2V5IG9mIChkZWZpbmVkKGZ1bmMpID8gbEtleXMuc29ydChmdW5jKSA6IGxLZXlzKS5maWx0ZXIodXNlS2V5KVxuXHRcdFx0XHR2YWwgOj0geFtrZXldXG5cdFx0XHRcdGlmIG5vdCBpZ25vcmVFbXB0eVZhbHVlcyB8fCBub25FbXB0eSh2YWwpXG5cdFx0XHRcdFx0bWFwcGVkIDo9IHJlY292ZXJhYmxlID8gdW5kZWYgOiBtYXBGdW5jKGtleSwgdmFsLCB4KVxuXHRcdFx0XHRcdG5ld3ZhbCA6PSBtYXBwZWQgfHwgdmFsXG5cdFx0XHRcdFx0YmxvY2sgOj0gaXNTdHJpbmcobWFwcGVkKSA/IG1hcHBlZCA6IHRvTmljZShcblx0XHRcdFx0XHRcdFx0bmV3dmFsLFxuXHRcdFx0XHRcdFx0XHRoT3B0aW9ucyxcblx0XHRcdFx0XHRcdFx0bWFwVmlzaXRlZCxcblx0XHRcdFx0XHRcdFx0W2xQYXRoLi4uLCBrZXldXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRcdFx0Y29tcGFjdFxuXHRcdFx0XHRcdFx0XHR8fCAoZGVmaW5lZChuZXd2YWwpICYmIGlzUHJpbWl0aXZlKG5ld3ZhbCkpXG5cdFx0XHRcdFx0XHRcdHx8IGJsb2NrLnN0YXJ0c1dpdGgoJy4nKVxuXHRcdFx0XHRcdFx0XHR8fCBpc0VtcHR5KG5ld3ZhbClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggXCIje2tleX06ICN7YmxvY2t9XCJcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBcIiN7a2V5fTpcIlxuXHRcdFx0XHRcdFx0b25lSW5kZW50IDo9IHJvdHBvczxzdHJpbmc+KGxJbmRlbnRzLCBsUGF0aC5sZW5ndGgpXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBpbmRlbnRlZChibG9jaywgb25lSW5kZW50KVxuXHRcdFx0aWYgY29tcGFjdFxuXHRcdFx0XHRyZXR1cm4gJ3snICsgbExpbmVzLmpvaW4oJyAnKSArICd9J1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gdG9CbG9jayhsTGluZXMpXG5cblx0cmV0dXJuIFwiPFVua25vd24gb2JqZWN0ICN7eH0+XCJcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IE9MIDo9ICh4OiB1bmtub3duKTogc3RyaW5nID0+XG5cblx0cmV0dXJuIHRvTmljZSB4LCB7Y29tcGFjdDogdHJ1ZX1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IE1MIDo9ICh4OiB1bmtub3duKTogc3RyaW5nID0+XG5cblx0cmV0dXJuIHRvTmljZSB4LCB7Y29tcGFjdDogZmFsc2V9XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBEVU1QIDo9IChcblx0XHR4OiB1bmtub3duXG5cdFx0bGFiZWw6IHN0cmluZz8gPSB1bmRlZlxuXHRcdGhPcHRpb25zOiBoYXNoID0ge31cblx0XHQpOiB2b2lkID0+XG5cblx0dHlwZSBvcHQgPSB7XG5cdFx0d2lkdGg6IG51bWJlclxuXHRcdGNoYXI6IHN0cmluZ1xuXHRcdH1cblx0e3dpZHRoLCBjaGFyfSA6PSBnZXRPcHRpb25zPG9wdD4gaE9wdGlvbnMsIHtcblx0XHR3aWR0aDogNjRcblx0XHRjaGFyOiAnLSdcblx0XHR9XG5cblx0Y29uc29sZS5sb2cgc2VwKGxhYmVsLCBjaGFyLCB3aWR0aClcblx0aWYgaXNTdHJpbmcgeFxuXHRcdGlmIG5vbkVtcHR5IHhcblx0XHRcdGNvbnNvbGUubG9nIHhcblx0ZWxzZVxuXHRcdGNvbnNvbGUubG9nIHRvTmljZSh4LCBoT3B0aW9ucylcblx0Y29uc29sZS5sb2cgc2VwKHVuZGVmLCBjaGFyLCB3aWR0aClcblx0cmV0dXJuXG4iXX0=