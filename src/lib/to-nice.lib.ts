"use strict";
// to-nice.lib.civet

import {cyan, blue} from "@std/fmt/colors"

import {sep, centered} from 'base-utils'
import {
	assert, croak, undef, defined, notdefined, hash, hashof,
	isString, isArray, isClass, isRegExp, isPrimitive,
	isEmpty, nonEmpty, assertIsHash,
	symbolName, className, functionName, regexpDef,
	} from 'datatypes'
import {
	getOptions, escapeStr, o, toBlock, spaces, mapEachLine,
	} from 'llutils'

export type TCompareFunc = (a: string, b: string) => number

// ---------------------------------------------------------------------------

export const alphaCompare: TCompareFunc = (
		a: string,
		b: string
		): number => {

	return (a < b) ? -1 : (a > b) ? 1 : 0
}

// ---------------------------------------------------------------------------
// --- any leading digit must be preceded by a single '\'

export const toNiceString = (str: string): string => {

	// --- escape spaces and \t, \n or \r with unicode chars

	const str1 = escapeStr(str)

	// --- precede with '\' if starts with digit, '.' or '-'
	//                      or looks like a label

	const str2 = str1.match(/^[\d.-]/) ? `\\${str1}` : str1
	const str3 = str2.match(/^[^Ë³\s]+:/) ? `\\${str2}` : str2
	return str3
}

// ---------------------------------------------------------------------------

const pathadd = (
		path: string,
		key: string | number
		): string => {

	const newkey = (
		  (typeof key === 'number')
		? `[${key.toString()}]`
		: `/${key}`
		)
	return (path === '/') ? newkey : `${path}${newkey}`
}

// ---------------------------------------------------------------------------

// --- Returns a function that:
//        compares 2 strings based on their position in lSortKeys
//        else compares alphabetically

const getCompareFunc = (
		lSortKeys: string[]
		): TCompareFunc => {

	// --- Create map of key to number
	const h: hashof<number> = {}
	let i1 = 0;for (const key of lSortKeys) {const i = i1++;
		h[key] = i+1
	}

	return function(a: string, b: string): number {
		const aVal = h[a]
		const bVal = h[b]

		if (defined(aVal)) {
			if (defined(bVal)) {
				// --- compare numerically
				return (aVal < bVal) ? -1 : (aVal > bVal) ? 1 : 0
			}
			else {
				return -1
			}
		}
		else {
			if (defined(bVal)) {
				return 1
			}
			else {
				return alphaCompare(a, b)
			}
		}
	}
}

// ---------------------------------------------------------------------------

const indented = (block: string, oneIndent: string) => {

	return mapEachLine(block, (line) => oneIndent + line)
}

// ---------------------------------------------------------------------------

export type TMapFunc = (
	key: string,
	value: unknown,
	hParent: hash
	) => unknown

export const emptyMapFunc = (
		key: string,
		value: unknown,
		hParent: hash
		): unknown => {
	return undef
}

export const toNice = (
		x: unknown,
		hOptions: hash={},
		mapVisited: Map<object, string> = new Map<object, string>(),
		path: string = '/'
		): string => {

	// --- When recoverable, classes and functions
	//     include their definitions,
	//     with escaped chars

	type opt = {
		compact: boolean
		recoverable: boolean
		ignoreEmptyValues: boolean
		sortKeys: boolean
		sortFunc: (TCompareFunc | undefined)
		mapFunc: TMapFunc
		lInclude: ((string[]) | undefined)
		lExclude: ((string[]) | undefined)
		oneIndent: string
		}
	const {		compact,
			recoverable,
			ignoreEmptyValues,
			sortKeys,
			sortFunc,
			mapFunc,
			lInclude,
			lExclude,
			oneIndent
		} = getOptions<opt>(hOptions, {
		compact: false,
		recoverable: false,
		ignoreEmptyValues: false,
		sortKeys: false,
		sortFunc: undef,
		mapFunc: emptyMapFunc,
		lInclude: undef,
		lExclude: undef,
		oneIndent: spaces(3)
		})

	// --- You can provide sortKeys or a sortFunc, but not both
	assert(!(sortKeys && defined(sortFunc)), "Bad options")

	switch(typeof x) {
		case 'undefined': {
			return '.undef'
		}

		case 'boolean': {
			return x ? '.true' : '.false'
		}

		case 'number': {
			return (
				  Number.isNaN(x)    ? '.NaN'
				: Number.isFinite(x) ? x.toString()
				: ((x < 0) ? '.neginf' : '.inf')
				)
		}

		case 'bigint': {
			return x.toString() + 'n'
		}

		case 'string': {
			return toNiceString(x)
		}

		case 'symbol': {
			const name = symbolName(x)
			return name ? `.symbol ${name}` : '.symbol'
		}

		case 'function': {
			if (isClass(x)) {
				return `.class ${className(x)}`
			}
			else {
				return `.function ${functionName(x)}`
			}
		}

		case 'object': {
			if (x === null) {
				return '.null'
			}

			if (isRegExp(x)) {
				return `.regexp ${escapeStr(regexpDef(x))}`
			}

			// --- Check if object was previously visited
			const prevpath = mapVisited.get(x)
			if (prevpath) {
				return `.ref ${prevpath}`
			}

			if (isArray(x)) {
				if (x.length === 0) {
					return '[]'
				}

				mapVisited.set(x, path)
				const lLines = []
				let i2 = 0;for (const val of x) {const i = i2++;
					const block = toNice(
							val,
							hOptions,
							mapVisited,
							pathadd(path, i)
							)
					if (compact) {
						lLines.push(block)
					}
					else if (isPrimitive(val) || block.startsWith('.')) {
						lLines.push(`- ${block}`)
					}
					else {
						lLines.push('-')
						lLines.push(indented(block, oneIndent))
					}
				}
				if (compact) {
					return '[' + lLines.join(' ') + ']'
				}
				else {
					return toBlock(lLines)
				}
			}

			const lKeys = Object.keys(x)
			if (lKeys.length === 0) {
				return '{}'
			}

			const func: (TCompareFunc | undefined) = (
				  defined(sortFunc) ? sortFunc
				: defined(lInclude) ? getCompareFunc(lInclude)
				: sortKeys          ? alphaCompare
				:                     undef
				)

			const useKey = (key: unknown): boolean => {
				if (typeof key !== 'string') {
					return false
				}
				if (defined(lExclude) && lExclude.includes(key)) {
					return false
				}
				if (defined(lInclude) && !lInclude.includes(key)) {
					return false
				}
				return true
			}

			mapVisited.set(x, path)

			assertIsHash(x)    // --- will allow us to index with any string

			const lLines = []
			for (const key of (defined(func) ? lKeys.sort(func) : lKeys)) {
				if (useKey(key)) {
					const val = x[key]
					if (!ignoreEmptyValues || nonEmpty(val)) {
						const mapped = recoverable ? undef : mapFunc(key, val, x)
						const newval = mapped || val
						const block = isString(mapped) ? mapped : toNice(
								newval,
								hOptions,
								mapVisited,
								pathadd(path, key)
								)
						if (
								   compact
								|| (defined(newval) && isPrimitive(newval))
								|| block.startsWith('.')
								) {
							lLines.push(`${key}: ${block}`)
						}
						else {
							lLines.push(`${key}:`)
							lLines.push(indented(block, oneIndent))
						}
					}
				}
			}
			if (compact) {
				return '{' + lLines.join(' ') + '}'
			}
			else {
				return toBlock(lLines)
			}
		}
	}

	return `<Unknown object ${x}>`
}

// ---------------------------------------------------------------------------

export const OL = (x: unknown): string => {

	return toNice(x, {compact: true})
}

// ---------------------------------------------------------------------------

export const ML = (x: unknown): string => {

	return toNice(x, {compact: false})
}

// ---------------------------------------------------------------------------

export const DUMP = (
		x: unknown,
		label: (string | undefined) = undef,
		hOptions: hash = {},
		width: number = 64
		): void => {

	if (isEmpty(label)) {
		console.log(sep(width))
	}
	else if (defined(label)) {
		console.log(centered(label, width, '-'))
	}
	if (isString(x)) {
		console.log(x)
	}
	else {
		console.log(toNice(x, hOptions))
	}
	console.log(sep(width))
	return
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcbGliXFx0by1uaWNlLmxpYi5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXGxpYlxcdG8tbmljZS5saWIuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSxvQkFBbUI7QUFDbkIsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQjtBQUMxQyxBQUFBO0FBQ0EsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZO0FBQ3hDLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3pELENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ25ELENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDO0FBQ2pDLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsU0FBUyxDQUFDO0FBQ2hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXO0FBQ25CLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ3hELENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTO0FBQ2pCLEFBQUE7QUFDQSxBQUFBLEFB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QyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQztDQUFBLENBQUE7QUFDakMsQUFBQSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUEsQUFBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDdkIsQUFBQSxDQUFDLE07QUFBTSxDQUFBO0FBQ1AiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgdG8tbmljZS5saWIuY2l2ZXRcblxuaW1wb3J0IHtjeWFuLCBibHVlfSBmcm9tIFwiQHN0ZC9mbXQvY29sb3JzXCJcblxuaW1wb3J0IHtzZXAsIGNlbnRlcmVkfSBmcm9tICdiYXNlLXV0aWxzJ1xuaW1wb3J0IHtcblx0YXNzZXJ0LCBjcm9haywgdW5kZWYsIGRlZmluZWQsIG5vdGRlZmluZWQsIGhhc2gsIGhhc2hvZixcblx0aXNTdHJpbmcsIGlzQXJyYXksIGlzQ2xhc3MsIGlzUmVnRXhwLCBpc1ByaW1pdGl2ZSxcblx0aXNFbXB0eSwgbm9uRW1wdHksIGFzc2VydElzSGFzaCxcblx0c3ltYm9sTmFtZSwgY2xhc3NOYW1lLCBmdW5jdGlvbk5hbWUsIHJlZ2V4cERlZixcblx0fSBmcm9tICdkYXRhdHlwZXMnXG5pbXBvcnQge1xuXHRnZXRPcHRpb25zLCBlc2NhcGVTdHIsIG8sIHRvQmxvY2ssIHNwYWNlcywgbWFwRWFjaExpbmUsXG5cdH0gZnJvbSAnbGx1dGlscydcblxuZXhwb3J0IHR5cGUgVENvbXBhcmVGdW5jID0gKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBudW1iZXJcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IGFscGhhQ29tcGFyZTogVENvbXBhcmVGdW5jIDo9IChcblx0XHRhOiBzdHJpbmcsXG5cdFx0Yjogc3RyaW5nXG5cdFx0KTogbnVtYmVyID0+XG5cblx0cmV0dXJuIChhIDwgYikgPyAtMSA6IChhID4gYikgPyAxIDogMFxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAtLS0gYW55IGxlYWRpbmcgZGlnaXQgbXVzdCBiZSBwcmVjZWRlZCBieSBhIHNpbmdsZSAnXFwnXG5cbmV4cG9ydCB0b05pY2VTdHJpbmcgOj0gKHN0cjogc3RyaW5nKTogc3RyaW5nID0+XG5cblx0IyAtLS0gZXNjYXBlIHNwYWNlcyBhbmQgXFx0LCBcXG4gb3IgXFxyIHdpdGggdW5pY29kZSBjaGFyc1xuXG5cdHN0cjEgOj0gZXNjYXBlU3RyKHN0cilcblxuXHQjIC0tLSBwcmVjZWRlIHdpdGggJ1xcJyBpZiBzdGFydHMgd2l0aCBkaWdpdCwgJy4nIG9yICctJ1xuXHQjICAgICAgICAgICAgICAgICAgICAgIG9yIGxvb2tzIGxpa2UgYSBsYWJlbFxuXG5cdHN0cjIgOj0gc3RyMS5tYXRjaCgvXltcXGQuLV0vKSA/IFwiXFxcXCN7c3RyMX1cIiA6IHN0cjFcblx0c3RyMyA6PSBzdHIyLm1hdGNoKC9eW17Ls1xcc10rOi8pID8gXCJcXFxcI3tzdHIyfVwiIDogc3RyMlxuXHRyZXR1cm4gc3RyM1xuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5wYXRoYWRkIDo9IChcblx0XHRwYXRoOiBzdHJpbmdcblx0XHRrZXk6IHN0cmluZyB8IG51bWJlclxuXHRcdCk6IHN0cmluZyA9PlxuXG5cdG5ld2tleSA6PSAoXG5cdFx0ICAodHlwZW9mIGtleSA9PSAnbnVtYmVyJylcblx0XHQ/IFwiWyN7a2V5LnRvU3RyaW5nKCl9XVwiXG5cdFx0OiBcIi8je2tleX1cIlxuXHRcdClcblx0cmV0dXJuIChwYXRoID09ICcvJykgPyBuZXdrZXkgOiBcIiN7cGF0aH0je25ld2tleX1cIlxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4jIC0tLSBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdDpcbiMgICAgICAgIGNvbXBhcmVzIDIgc3RyaW5ncyBiYXNlZCBvbiB0aGVpciBwb3NpdGlvbiBpbiBsU29ydEtleXNcbiMgICAgICAgIGVsc2UgY29tcGFyZXMgYWxwaGFiZXRpY2FsbHlcblxuZ2V0Q29tcGFyZUZ1bmMgOj0gKFxuXHRcdGxTb3J0S2V5czogc3RyaW5nW11cblx0XHQpOiBUQ29tcGFyZUZ1bmMgPT5cblxuXHQjIC0tLSBDcmVhdGUgbWFwIG9mIGtleSB0byBudW1iZXJcblx0aDogaGFzaG9mPG51bWJlcj4gOj0ge31cblx0Zm9yIGtleSxpIG9mIGxTb3J0S2V5c1xuXHRcdGhba2V5XSA9IGkrMVxuXG5cdHJldHVybiAoYTogc3RyaW5nLCBiOiBzdHJpbmcpOiBudW1iZXIgLT5cblx0XHRhVmFsIDo9IGhbYV1cblx0XHRiVmFsIDo9IGhbYl1cblxuXHRcdGlmIGRlZmluZWQoYVZhbClcblx0XHRcdGlmIGRlZmluZWQoYlZhbClcblx0XHRcdFx0IyAtLS0gY29tcGFyZSBudW1lcmljYWxseVxuXHRcdFx0XHRyZXR1cm4gKGFWYWwgPCBiVmFsKSA/IC0xIDogKGFWYWwgPiBiVmFsKSA/IDEgOiAwXG5cdFx0XHRlbHNlXG5cdFx0XHRcdHJldHVybiAtMVxuXHRcdGVsc2Vcblx0XHRcdGlmIGRlZmluZWQoYlZhbClcblx0XHRcdFx0cmV0dXJuIDFcblx0XHRcdGVsc2Vcblx0XHRcdFx0cmV0dXJuIGFscGhhQ29tcGFyZShhLCBiKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5pbmRlbnRlZCA6PSAoYmxvY2s6IHN0cmluZywgb25lSW5kZW50OiBzdHJpbmcpID0+XG5cblx0cmV0dXJuIG1hcEVhY2hMaW5lKGJsb2NrLCAobGluZSkgPT4gb25lSW5kZW50ICsgbGluZSlcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0IHR5cGUgVE1hcEZ1bmMgPSAoXG5cdGtleTogc3RyaW5nXG5cdHZhbHVlOiB1bmtub3duXG5cdGhQYXJlbnQ6IGhhc2hcblx0KSA9PiB1bmtub3duXG5cbmV4cG9ydCBlbXB0eU1hcEZ1bmMgOj0gKFxuXHRcdGtleTogc3RyaW5nXG5cdFx0dmFsdWU6IHVua25vd25cblx0XHRoUGFyZW50OiBoYXNoXG5cdFx0KTogdW5rbm93biA9PlxuXHRyZXR1cm4gdW5kZWZcblxuZXhwb3J0IHRvTmljZSA6PSAoXG5cdFx0eDogdW5rbm93bixcblx0XHRoT3B0aW9uczogaGFzaD17fVxuXHRcdG1hcFZpc2l0ZWQ6IE1hcDxvYmplY3QsIHN0cmluZz4gPSBuZXcgTWFwPG9iamVjdCwgc3RyaW5nPigpXG5cdFx0cGF0aDogc3RyaW5nID0gJy8nXG5cdFx0KTogc3RyaW5nID0+XG5cblx0IyAtLS0gV2hlbiByZWNvdmVyYWJsZSwgY2xhc3NlcyBhbmQgZnVuY3Rpb25zXG5cdCMgICAgIGluY2x1ZGUgdGhlaXIgZGVmaW5pdGlvbnMsXG5cdCMgICAgIHdpdGggZXNjYXBlZCBjaGFyc1xuXG5cdHR5cGUgb3B0ID0ge1xuXHRcdGNvbXBhY3Q6IGJvb2xlYW5cblx0XHRyZWNvdmVyYWJsZTogYm9vbGVhblxuXHRcdGlnbm9yZUVtcHR5VmFsdWVzOiBib29sZWFuXG5cdFx0c29ydEtleXM6IGJvb2xlYW5cblx0XHRzb3J0RnVuYzogVENvbXBhcmVGdW5jP1xuXHRcdG1hcEZ1bmM6IFRNYXBGdW5jXG5cdFx0bEluY2x1ZGU6IHN0cmluZ1tdP1xuXHRcdGxFeGNsdWRlOiBzdHJpbmdbXT9cblx0XHRvbmVJbmRlbnQ6IHN0cmluZ1xuXHRcdH1cblx0e1x0XHRjb21wYWN0XG5cdFx0XHRyZWNvdmVyYWJsZVxuXHRcdFx0aWdub3JlRW1wdHlWYWx1ZXNcblx0XHRcdHNvcnRLZXlzXG5cdFx0XHRzb3J0RnVuY1xuXHRcdFx0bWFwRnVuY1xuXHRcdFx0bEluY2x1ZGVcblx0XHRcdGxFeGNsdWRlXG5cdFx0XHRvbmVJbmRlbnRcblx0XHR9IDo9IGdldE9wdGlvbnM8b3B0PiBoT3B0aW9ucywge1xuXHRcdGNvbXBhY3Q6IGZhbHNlXG5cdFx0cmVjb3ZlcmFibGU6IGZhbHNlXG5cdFx0aWdub3JlRW1wdHlWYWx1ZXM6IGZhbHNlXG5cdFx0c29ydEtleXM6IGZhbHNlXG5cdFx0c29ydEZ1bmM6IHVuZGVmXG5cdFx0bWFwRnVuYzogZW1wdHlNYXBGdW5jXG5cdFx0bEluY2x1ZGU6IHVuZGVmXG5cdFx0bEV4Y2x1ZGU6IHVuZGVmXG5cdFx0b25lSW5kZW50OiBzcGFjZXMoMylcblx0XHR9XG5cblx0IyAtLS0gWW91IGNhbiBwcm92aWRlIHNvcnRLZXlzIG9yIGEgc29ydEZ1bmMsIGJ1dCBub3QgYm90aFxuXHRhc3NlcnQgbm90IChzb3J0S2V5cyAmJiBkZWZpbmVkKHNvcnRGdW5jKSksIFwiQmFkIG9wdGlvbnNcIlxuXG5cdHN3aXRjaCB0eXBlb2YgeFxuXHRcdHdoZW4gJ3VuZGVmaW5lZCdcblx0XHRcdHJldHVybiAnLnVuZGVmJ1xuXG5cdFx0d2hlbiAnYm9vbGVhbidcblx0XHRcdHJldHVybiB4ID8gJy50cnVlJyA6ICcuZmFsc2UnXG5cblx0XHR3aGVuICdudW1iZXInXG5cdFx0XHRyZXR1cm4gKFxuXHRcdFx0XHQgIE51bWJlci5pc05hTih4KSAgICA/ICcuTmFOJ1xuXHRcdFx0XHQ6IE51bWJlci5pc0Zpbml0ZSh4KSA/IHgudG9TdHJpbmcoKVxuXHRcdFx0XHQ6ICgoeCA8IDApID8gJy5uZWdpbmYnIDogJy5pbmYnKVxuXHRcdFx0XHQpXG5cblx0XHR3aGVuICdiaWdpbnQnXG5cdFx0XHRyZXR1cm4geC50b1N0cmluZygpICsgJ24nXG5cblx0XHR3aGVuICdzdHJpbmcnXG5cdFx0XHRyZXR1cm4gdG9OaWNlU3RyaW5nKHgpXG5cblx0XHR3aGVuICdzeW1ib2wnXG5cdFx0XHRuYW1lIDo9IHN5bWJvbE5hbWUoeClcblx0XHRcdHJldHVybiBuYW1lID8gXCIuc3ltYm9sICN7bmFtZX1cIiA6ICcuc3ltYm9sJ1xuXG5cdFx0d2hlbiAnZnVuY3Rpb24nXG5cdFx0XHRpZiBpc0NsYXNzKHgpXG5cdFx0XHRcdHJldHVybiBcIi5jbGFzcyAje2NsYXNzTmFtZSh4KX1cIlxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyZXR1cm4gXCIuZnVuY3Rpb24gI3tmdW5jdGlvbk5hbWUoeCl9XCJcblxuXHRcdHdoZW4gJ29iamVjdCdcblx0XHRcdGlmICh4ID09IG51bGwpXG5cdFx0XHRcdHJldHVybiAnLm51bGwnXG5cblx0XHRcdGlmIGlzUmVnRXhwKHgpXG5cdFx0XHRcdHJldHVybiBcIi5yZWdleHAgI3tlc2NhcGVTdHIocmVnZXhwRGVmKHgpKX1cIlxuXG5cdFx0XHQjIC0tLSBDaGVjayBpZiBvYmplY3Qgd2FzIHByZXZpb3VzbHkgdmlzaXRlZFxuXHRcdFx0cHJldnBhdGggOj0gbWFwVmlzaXRlZC5nZXQgeFxuXHRcdFx0aWYgcHJldnBhdGhcblx0XHRcdFx0cmV0dXJuIFwiLnJlZiAje3ByZXZwYXRofVwiXG5cblx0XHRcdGlmIGlzQXJyYXkoeClcblx0XHRcdFx0aWYgKHgubGVuZ3RoID09IDApXG5cdFx0XHRcdFx0cmV0dXJuICdbXSdcblxuXHRcdFx0XHRtYXBWaXNpdGVkLnNldCB4LCBwYXRoXG5cdFx0XHRcdGxMaW5lcyA6PSBbXVxuXHRcdFx0XHRmb3IgdmFsLGkgb2YgeFxuXHRcdFx0XHRcdGJsb2NrIDo9IHRvTmljZShcblx0XHRcdFx0XHRcdFx0dmFsLFxuXHRcdFx0XHRcdFx0XHRoT3B0aW9ucyxcblx0XHRcdFx0XHRcdFx0bWFwVmlzaXRlZCxcblx0XHRcdFx0XHRcdFx0cGF0aGFkZChwYXRoLCBpKVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0aWYgY29tcGFjdFxuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggYmxvY2tcblx0XHRcdFx0XHRlbHNlIGlmIGlzUHJpbWl0aXZlKHZhbCkgfHwgYmxvY2suc3RhcnRzV2l0aCgnLicpXG5cdFx0XHRcdFx0XHRsTGluZXMucHVzaCBcIi0gI3tibG9ja31cIlxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdGxMaW5lcy5wdXNoICctJ1xuXHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggaW5kZW50ZWQoYmxvY2ssIG9uZUluZGVudClcblx0XHRcdFx0aWYgY29tcGFjdFxuXHRcdFx0XHRcdHJldHVybiAnWycgKyBsTGluZXMuam9pbignICcpICsgJ10nXG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRyZXR1cm4gdG9CbG9jayhsTGluZXMpXG5cblx0XHRcdGxLZXlzIDo9IE9iamVjdC5rZXlzKHgpXG5cdFx0XHRpZiAobEtleXMubGVuZ3RoID09IDApXG5cdFx0XHRcdHJldHVybiAne30nXG5cblx0XHRcdGZ1bmM6IFRDb21wYXJlRnVuYz8gOj0gKFxuXHRcdFx0XHQgIGRlZmluZWQoc29ydEZ1bmMpID8gc29ydEZ1bmNcblx0XHRcdFx0OiBkZWZpbmVkKGxJbmNsdWRlKSA/IGdldENvbXBhcmVGdW5jKGxJbmNsdWRlKVxuXHRcdFx0XHQ6IHNvcnRLZXlzICAgICAgICAgID8gYWxwaGFDb21wYXJlXG5cdFx0XHRcdDogICAgICAgICAgICAgICAgICAgICB1bmRlZlxuXHRcdFx0XHQpXG5cblx0XHRcdHVzZUtleSA6PSAoa2V5OiB1bmtub3duKTogYm9vbGVhbiA9PlxuXHRcdFx0XHRpZiAodHlwZW9mIGtleSAhPSAnc3RyaW5nJylcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2Vcblx0XHRcdFx0aWYgZGVmaW5lZChsRXhjbHVkZSkgJiYgbEV4Y2x1ZGUuaW5jbHVkZXMoa2V5KVxuXHRcdFx0XHRcdHJldHVybiBmYWxzZVxuXHRcdFx0XHRpZiBkZWZpbmVkKGxJbmNsdWRlKSAmJiBub3QgbEluY2x1ZGUuaW5jbHVkZXMoa2V5KVxuXHRcdFx0XHRcdHJldHVybiBmYWxzZVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZVxuXG5cdFx0XHRtYXBWaXNpdGVkLnNldCB4LCBwYXRoXG5cblx0XHRcdGFzc2VydElzSGFzaCB4ICAgICMgLS0tIHdpbGwgYWxsb3cgdXMgdG8gaW5kZXggd2l0aCBhbnkgc3RyaW5nXG5cblx0XHRcdGxMaW5lcyA6PSBbXVxuXHRcdFx0Zm9yIGtleSBvZiAoZGVmaW5lZChmdW5jKSA/IGxLZXlzLnNvcnQoZnVuYykgOiBsS2V5cylcblx0XHRcdFx0aWYgdXNlS2V5KGtleSlcblx0XHRcdFx0XHR2YWwgOj0geFtrZXldXG5cdFx0XHRcdFx0aWYgbm90IGlnbm9yZUVtcHR5VmFsdWVzIHx8IG5vbkVtcHR5KHZhbClcblx0XHRcdFx0XHRcdG1hcHBlZCA6PSByZWNvdmVyYWJsZSA/IHVuZGVmIDogbWFwRnVuYyhrZXksIHZhbCwgeClcblx0XHRcdFx0XHRcdG5ld3ZhbCA6PSBtYXBwZWQgfHwgdmFsXG5cdFx0XHRcdFx0XHRibG9jayA6PSBpc1N0cmluZyhtYXBwZWQpID8gbWFwcGVkIDogdG9OaWNlKFxuXHRcdFx0XHRcdFx0XHRcdG5ld3ZhbCxcblx0XHRcdFx0XHRcdFx0XHRoT3B0aW9ucyxcblx0XHRcdFx0XHRcdFx0XHRtYXBWaXNpdGVkLFxuXHRcdFx0XHRcdFx0XHRcdHBhdGhhZGQocGF0aCwga2V5KVxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdFx0XHQgICBjb21wYWN0XG5cdFx0XHRcdFx0XHRcdFx0fHwgKGRlZmluZWQobmV3dmFsKSAmJiBpc1ByaW1pdGl2ZShuZXd2YWwpKVxuXHRcdFx0XHRcdFx0XHRcdHx8IGJsb2NrLnN0YXJ0c1dpdGgoJy4nKVxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggXCIje2tleX06ICN7YmxvY2t9XCJcblx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggXCIje2tleX06XCJcblx0XHRcdFx0XHRcdFx0bExpbmVzLnB1c2ggaW5kZW50ZWQoYmxvY2ssIG9uZUluZGVudClcblx0XHRcdGlmIGNvbXBhY3Rcblx0XHRcdFx0cmV0dXJuICd7JyArIGxMaW5lcy5qb2luKCcgJykgKyAnfSdcblx0XHRcdGVsc2Vcblx0XHRcdFx0cmV0dXJuIHRvQmxvY2sobExpbmVzKVxuXG5cdHJldHVybiBcIjxVbmtub3duIG9iamVjdCAje3h9PlwiXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBPTCA6PSAoeDogdW5rbm93bik6IHN0cmluZyA9PlxuXG5cdHJldHVybiB0b05pY2UgeCwge2NvbXBhY3Q6IHRydWV9XG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmV4cG9ydCBNTCA6PSAoeDogdW5rbm93bik6IHN0cmluZyA9PlxuXG5cdHJldHVybiB0b05pY2UgeCwge2NvbXBhY3Q6IGZhbHNlfVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgRFVNUCA6PSAoXG5cdFx0eDogdW5rbm93blxuXHRcdGxhYmVsOiBzdHJpbmc/ID0gdW5kZWZcblx0XHRoT3B0aW9uczogaGFzaCA9IHt9XG5cdFx0d2lkdGg6IG51bWJlciA9IDY0XG5cdFx0KTogdm9pZCA9PlxuXG5cdGlmIGlzRW1wdHkgbGFiZWxcblx0XHRjb25zb2xlLmxvZyBzZXAod2lkdGgpXG5cdGVsc2UgaWYgZGVmaW5lZCBsYWJlbFxuXHRcdGNvbnNvbGUubG9nIGNlbnRlcmVkKGxhYmVsLCB3aWR0aCwgJy0nKVxuXHRpZiBpc1N0cmluZyh4KVxuXHRcdGNvbnNvbGUubG9nIHhcblx0ZWxzZVxuXHRcdGNvbnNvbGUubG9nIHRvTmljZSh4LCBoT3B0aW9ucylcblx0Y29uc29sZS5sb2cgc2VwKHdpZHRoKVxuXHRyZXR1cm5cbiJdfQ==