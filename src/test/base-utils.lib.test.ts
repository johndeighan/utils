"use strict";
// base-utils.lib.test.civet

import {
	assert, TDefined, TNotDefined, undef, defined,
	notdefined, assertIsDefined, assertNotDefined,
	croak, checkSetup, flag, replaceInArray,
	fileExt, withExt, normalizePath, relpath,
	TPathInfo, parsePath, TExecResult, TReplaceHash,
	execCmd, cmdSucceeds, newerDestFileExists,
	splitPatterns, allFilesMatching, findFile,
	TProcFunc, TProcResult, procFiles,
	} from 'base-utils'
import {
	equal, like, succeeds, fails, truthy, falsy,
	isType, notType,
	} from 'unit-test'

// ---------------------------------------------------------------------------

succeeds(() => assert(2 === 2))
fails(   () => assert(2 === 3 + 5))
succeeds(() => defined('abc'))
fails(   () => defined(undef))
succeeds(() => notdefined(undef))
fails(   () => notdefined('abc'))
fails(   () => croak("Bad"))
succeeds(() => checkSetup())
truthy(  flag('c', ['-c']))
truthy(  flag('c', ['-cm']))
falsy(   flag('c', []))
falsy(   flag('c', ['-def']))
equal(   replaceInArray(['-cm','%PATH'], {'%PATH': '/temp.txt'}),
	['-cm', '/temp.txt'])

// ---------------------------------------------------------------------------

equal(fileExt('temp.txt'), '.txt')
equal(withExt('temp.txt', '.md'), 'temp.md')
equal(normalizePath('c:\\Users\\johnd\\utils\\src\\lib\\fsys.lib.civet'),
	'C:/Users/johnd/utils/src/lib/fsys.lib.civet')
equal(parsePath('c:\\path\\dir\\file.lib.ts'), {
	root: 'C:/',
	dir: 'C:/path/dir',
	fileName: 'file.lib.ts',

	stub: 'file',
	purpose: 'lib',
	ext: '.ts'
	})


truthy(cmdSucceeds('ls'))
truthy(flag('c', ['-c']))
truthy(flag('x', ['-cx']))
falsy( flag('x', ['-c']))

equal(replaceInArray(['a','b','c'], {
	b: 'x'
	}), ['a','x','c']);

(async () => {
	const hResult = await execCmd('echo', ['Hello'], {}, true)
	console.dir(hResult)
	truthy(hResult.success)
	equal(hResult.code, 0)
	equal(hResult.stdout, "Hello\n")
	equal(hResult.stderr, "")
}
	)()

truthy(cmdSucceeds('echo', ['Hello']))

equal(splitPatterns([
	'**/temp.txt',
	'!**/temp*',
	'*.test.ts',
	'! **/special.txt'
	]), [
		['**/temp.txt', '*.test.ts'],
		['**/temp*', '**/special.txt'],
		])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcdGVzdFxcYmFzZS11dGlscy5saWIudGVzdC5jaXZldC50c3giLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcam9obmRcXHV0aWxzXFxzcmNcXHRlc3RcXGJhc2UtdXRpbHMubGliLnRlc3QuY2l2ZXQiXSwibWFwcGluZ3MiOiI7QUFBQSw0QkFBMkI7QUFDM0IsQUFBQTtBQUNBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUMvQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0FBQy9DLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDO0FBQ3pDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzFDLENBQUMsU0FBUyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDO0FBQ2pELENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsbUJBQW1CLENBQUM7QUFDM0MsQ0FBQyxhQUFhLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQTtBQUMxQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUNuQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWTtBQUNwQixBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUM7QUFDUixDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUM3QyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUNqQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztBQUNuQixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxRQUFRLENBQUEsQUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFBLEFBQUMsQ0FBQyxDQUFDLEdBQUUsQ0FBQyxDQUFDLENBQUEsQ0FBQTtBQUM1QixBQUFBLEFBQUEsS0FBSyxDQUFBLEdBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQSxBQUFDLENBQUMsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQTtBQUNoQyxBQUFBLEFBQUEsUUFBUSxDQUFBLEFBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQSxBQUFDLEtBQUssQ0FBQSxDQUFBO0FBQzVCLEFBQUEsQUFBQSxLQUFLLENBQUEsR0FBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFBLEFBQUMsS0FBSyxDQUFBLENBQUE7QUFDNUIsQUFBQSxBQUFBLFFBQVEsQ0FBQSxBQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUEsQUFBQyxLQUFLLENBQUEsQ0FBQTtBQUMvQixBQUFBLEFBQUEsS0FBSyxDQUFBLEdBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQSxBQUFDLEtBQUssQ0FBQSxDQUFBO0FBQy9CLEFBQUEsQUFBQSxLQUFLLENBQUEsR0FBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFBLEFBQUMsS0FBSyxDQUFBLENBQUE7QUFDMUIsQUFBQSxBQUFBLFFBQVEsQ0FBQSxBQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFBO0FBQzNCLEFBQUEsQUFBQSxNQUFNLENBQUEsRUFBRyxJQUFJLENBQUEsQUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxD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RyxDQUFBLEFBQUMsT0FBTyxDQUFBO0FBQ3BCLEFBQUEsQ0FBQyxNQUFNLENBQUEsQUFBQyxPQUFPLENBQUMsT0FBTyxDQUFBO0FBQ3ZCLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3RCLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFBO0FBQ2hDLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDO0FBQUEsQ0FBQTtBQUN6QixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0osQUFBQTtBQUNBLEFBQUEsQUFBQSxNQUFNLENBQUEsQUFBQyxXQUFXLENBQUEsQUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFBLENBQUE7QUFDcEMsQUFBQTtBQUNBLEFBQUEsQUFBQSxLQUFLLENBQUEsQUFBQyxhQUFhLENBQUMsQ0FBQztBQUNyQixBQUFBLENBQUMsYUFBYSxDQUFBO0FBQ2QsQUFBQSxDQUFDLFdBQVcsQ0FBQTtBQUNaLEFBQUEsQ0FBQyxXQUFXLENBQUE7QUFDWixBQUFBLENBQUMsa0JBQWtCO0FBQ25CLEFBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTixBQUFBLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUMvQixBQUFBLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ2pDLEFBQUEsRUFBRSxDQUNGIiwibmFtZXMiOltdLCJzb3VyY2VzQ29udGVudCI6WyIjIGJhc2UtdXRpbHMubGliLnRlc3QuY2l2ZXRcclxuXHJcbmltcG9ydCB7XHJcblx0YXNzZXJ0LCBURGVmaW5lZCwgVE5vdERlZmluZWQsIHVuZGVmLCBkZWZpbmVkLFxyXG5cdG5vdGRlZmluZWQsIGFzc2VydElzRGVmaW5lZCwgYXNzZXJ0Tm90RGVmaW5lZCxcclxuXHRjcm9haywgY2hlY2tTZXR1cCwgZmxhZywgcmVwbGFjZUluQXJyYXksXHJcblx0ZmlsZUV4dCwgd2l0aEV4dCwgbm9ybWFsaXplUGF0aCwgcmVscGF0aCxcclxuXHRUUGF0aEluZm8sIHBhcnNlUGF0aCwgVEV4ZWNSZXN1bHQsIFRSZXBsYWNlSGFzaCxcclxuXHRleGVjQ21kLCBjbWRTdWNjZWVkcywgbmV3ZXJEZXN0RmlsZUV4aXN0cyxcclxuXHRzcGxpdFBhdHRlcm5zLCBhbGxGaWxlc01hdGNoaW5nLCBmaW5kRmlsZVxyXG5cdFRQcm9jRnVuYywgVFByb2NSZXN1bHQsIHByb2NGaWxlcyxcclxuXHR9IGZyb20gJ2Jhc2UtdXRpbHMnXHJcbmltcG9ydCB7XHJcblx0ZXF1YWwsIGxpa2UsIHN1Y2NlZWRzLCBmYWlscywgdHJ1dGh5LCBmYWxzeSxcclxuXHRpc1R5cGUsIG5vdFR5cGUsXHJcblx0fSBmcm9tICd1bml0LXRlc3QnXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuc3VjY2VlZHMgKCkgPT4gYXNzZXJ0IDIgPT0gMlxyXG5mYWlscyAgICAoKSA9PiBhc3NlcnQgMiA9PSAzICsgNVxyXG5zdWNjZWVkcyAoKSA9PiBkZWZpbmVkICdhYmMnXHJcbmZhaWxzICAgICgpID0+IGRlZmluZWQgdW5kZWZcclxuc3VjY2VlZHMgKCkgPT4gbm90ZGVmaW5lZCB1bmRlZlxyXG5mYWlscyAgICAoKSA9PiBub3RkZWZpbmVkICdhYmMnXHJcbmZhaWxzICAgICgpID0+IGNyb2FrIFwiQmFkXCJcclxuc3VjY2VlZHMgKCkgPT4gY2hlY2tTZXR1cCgpXHJcbnRydXRoeSAgIGZsYWcgJ2MnLCBbJy1jJ11cclxudHJ1dGh5ICAgZmxhZyAnYycsIFsnLWNtJ11cclxuZmFsc3kgICAgZmxhZyAnYycsIFtdXHJcbmZhbHN5ICAgIGZsYWcgJ2MnLCBbJy1kZWYnXVxyXG5lcXVhbCAgICByZXBsYWNlSW5BcnJheShbJy1jbScsJyVQQVRIJ10sIHsnJVBBVEgnOiAnL3RlbXAudHh0J30pLFxyXG5cdFsnLWNtJywgJy90ZW1wLnR4dCddXHJcblxyXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZXF1YWwgZmlsZUV4dCgndGVtcC50eHQnKSwgJy50eHQnXHJcbmVxdWFsIHdpdGhFeHQoJ3RlbXAudHh0JywgJy5tZCcpLCAndGVtcC5tZCdcclxuZXF1YWwgbm9ybWFsaXplUGF0aCgnYzpcXFxcVXNlcnNcXFxcam9obmRcXFxcdXRpbHNcXFxcc3JjXFxcXGxpYlxcXFxmc3lzLmxpYi5jaXZldCcpLFxyXG5cdCdDOi9Vc2Vycy9qb2huZC91dGlscy9zcmMvbGliL2ZzeXMubGliLmNpdmV0J1xyXG5lcXVhbCBwYXJzZVBhdGgoJ2M6XFxcXHBhdGhcXFxcZGlyXFxcXGZpbGUubGliLnRzJyksIHtcclxuXHRyb290OiAnQzovJ1xyXG5cdGRpcjogJ0M6L3BhdGgvZGlyJ1xyXG5cdGZpbGVOYW1lOiAnZmlsZS5saWIudHMnXHJcblxyXG5cdHN0dWI6ICdmaWxlJ1xyXG5cdHB1cnBvc2U6ICdsaWInXHJcblx0ZXh0OiAnLnRzJ1xyXG5cdH1cclxuXHJcblxyXG50cnV0aHkgY21kU3VjY2VlZHMgJ2xzJ1xyXG50cnV0aHkgZmxhZygnYycsIFsnLWMnXSlcclxudHJ1dGh5IGZsYWcoJ3gnLCBbJy1jeCddKVxyXG5mYWxzeSAgZmxhZygneCcsIFsnLWMnXSlcclxuXHJcbmVxdWFsIHJlcGxhY2VJbkFycmF5KFsnYScsJ2InLCdjJ10sIHtcclxuXHRiOiAneCdcclxuXHR9KSwgWydhJywneCcsJ2MnXVxyXG5cclxuKCgpID0+XHJcblx0aFJlc3VsdCA6PSBhd2FpdCBleGVjQ21kKCdlY2hvJywgWydIZWxsbyddLCB7fSwgdHJ1ZSlcclxuXHRjb25zb2xlLmRpciBoUmVzdWx0XHJcblx0dHJ1dGh5IGhSZXN1bHQuc3VjY2Vzc1xyXG5cdGVxdWFsIGhSZXN1bHQuY29kZSwgMFxyXG5cdGVxdWFsIGhSZXN1bHQuc3Rkb3V0LCBcIkhlbGxvXFxuXCJcclxuXHRlcXVhbCBoUmVzdWx0LnN0ZGVyciwgXCJcIlxyXG5cdCkoKVxyXG5cclxudHJ1dGh5IGNtZFN1Y2NlZWRzICdlY2hvJywgWydIZWxsbyddXHJcblxyXG5lcXVhbCBzcGxpdFBhdHRlcm5zKFtcclxuXHQnKiovdGVtcC50eHQnXHJcblx0JyEqKi90ZW1wKidcclxuXHQnKi50ZXN0LnRzJ1xyXG5cdCchICoqL3NwZWNpYWwudHh0J1xyXG5cdF0pLCBbXHJcblx0XHRbJyoqL3RlbXAudHh0JywgJyoudGVzdC50cyddLFxyXG5cdFx0WycqKi90ZW1wKicsICcqKi9zcGVjaWFsLnR4dCddLFxyXG5cdFx0XSJdfQ==