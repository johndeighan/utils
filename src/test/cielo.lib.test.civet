# cielo.lib.test.civet

import {defined, isFunction} from 'datatypes'
import {DBG} from 'logger'
import {getCmdArgs} from 'cmd-args'
import {setDirTree} from 'pllfile'
import {
	cielo2civet, cielo2civetFile, configFromFile,
	} from 'cielo'
import {
	equal, like, succeeds, fails, truthy, falsy,
	} from 'unit-test'

getCmdArgs()

# ---------------------------------------------------------------------------

setup := (): void =>

	DBG "setDirTree()"

	setDirTree 'src/test/cielo', """
		file.config.ts
			export default new Object({
				a: 1,
				b: 'abc',
				f: () => 'hello'
				})
		"""

setup()

# ---------------------------------------------------------------------------

DBG "cielo2civet(code)", "cielo2civetFile()"

equal cielo2civet('abc'), 'abc'

DBG "configFromFile(path)"

(() =>
	hConfig := configFromFile 'src/test/cielo/file.config.ts'
	truthy defined(hConfig)
	truthy defined(hConfig.a)
	falsy  defined(hConfig.x)
	if isFunction(hConfig.f)
		equal hConfig.f(), 'hello'
	)
