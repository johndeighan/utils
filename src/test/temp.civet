# temp.civet

import {
	undef, defined, notdefined, LOG, FAIL, SUCCEED, findFile,
	} from 'base-utils'
import {o} from 'llutils'
import {withExt} from 'fsys'
import {getCmdArgs} from 'cmd-args'
import {getSourceMap, mapSourcePos} from 'source-map'
import {setDirTree} from 'unit-test'

getCmdArgs()

# ---------------------------------------------------------------------------

fileName := 'source-map-test.civet'

setDirTree 'src/test/temporary', """
	#{fileName}
		import {undef} from 'datatypes'

		export sum := (x: number, y: number) =>

			return x + y
	""", o'clear compile'

path := findFile withExt(fileName, '.ts')
if defined path
	smap := getSourceMap path
	if notdefined smap
		FAIL "Source Map NOT FOUND"

	newPos := mapSourcePos {
		path
		line: 6
		column: 2
		}
	console.log newPos
else
	FAIL "File #{fileName} not found"
