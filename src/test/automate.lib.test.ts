"use strict";
// automate.lib.test.civet

import {defined, isHash, isFunction} from 'datatypes'
import {o} from 'llutils'
import {getCmdArgs} from 'cmd-args'
import {withExt, TPathInfo, isFile} from 'fsys'
import {DBG} from 'logger'
import {execCmd, getCmdOutput} from 'exec'
import {
	TTesterFunc, TCompileStatus, TCompilerFunc, TPostProcessor,
	TCompilerConfig, isCompilerConfig,
	TCompilerInfo, isCompilerInfo,
	TCompileResult, TUnitTestResult,
	getCompilerConfig, getCompilerInfo, getPostProcessor,
	compileFile,
	runUnitTestsFor, runAllUnitTests,
	installCmd, uninstallCmd,
	} from 'automate'
import {
	equal, like, succeeds, fails, truthy, falsy, setDirTree,
	matches, isType, notType, objListLike, strListLike,
	} from 'unit-test'

getCmdArgs()

// ---------------------------------------------------------------------------

const setup = (): void => {

	setDirTree('src/test/automate', `test1.cielo
	# test1.cielo

	LOG := (str) => console.log str
	LOG "Hello, World!"

test2.civet
	# test2.civet

	LOG := (str) => console.log str
	LOG "Hello, World!"

test3.coffee
	# test3.coffee

	LOG = (str) => console.log str
	LOG "Hello, World!"

graph.dot
	EE -> EO | OE | OO
	EO -> EE
	OE -> EE
	OO -> EE
hello.ts
	console.log("Hello, World!");
comp.config.civet
	import {withExt} from 'fsys'
	export default new Object {
		hCompilers: {
			'.test': {
				getOutPaths: (path: string) => [withExt(path, '.out')],
				tester: () => true,
				compiler: (path: string) => undefined
				}
			},
		hPostProcessors: {}
		}`, o`clear`)
	return
}

setup()

// ---------------------------------------------------------------------------

DBG("type TTesterFunc")

isType('TTesterFunc', () => {
	console.log("Hello, World!")
	return true
})

DBG("type TCompileStatus")

isType('TCompileStatus', 'temp')
isType('TCompileStatus', 'exists')
isType('TCompileStatus', 'compiled')
notType('TCompileStatus', 'dummy')

DBG("type TCompilerFunc")

isType('TCompilerFunc', (path: string) => {
	console.log(path)
	return 'compiled'
})

DBG("type TPostProcessor");

(() => {
	const logit = (hInfo: TPathInfo) => {
		console.log("done")
		return
	}
	isType('TPostProcessor', logit)
}
	)()

DBG("type TCompilerInfo")

isType('TCompilerInfo', {
	tester: () => true,
	compiler: (path: string) => { return 'compiled' },
	getOutPaths: (path: string) => { return ['temp.ts'] }
	})

DBG("type TCompilerConfig", "isCompilerConfig()")

isType('TCompilerConfig', {
	hCompilers: {},
	hPostProcessors: {}
	})

DBG("type TCompileResult")

isType('TCompileResult', {
	status: 'compiled',
	path: 'temp.civet'
	})

DBG("type TUnitTestResult")

isType('TUnitTestResult', {
	stub: 'temp',
	success: true
	})

DBG("getCompilerConfig(path)");

(() => {
	const civetPath = 'src/test/automate/comp.config.civet'
	const hConfig = getCompilerConfig(civetPath)
	isType('TCompilerConfig', hConfig, isCompilerConfig)
}
	)()

DBG("getCompilerInfo()")

isType('TCompilerInfo', getCompilerInfo('.dot'), isCompilerInfo)

DBG("getPostProcessor()");

(() => {
	const pp = getPostProcessor('test')
	truthy(defined(pp))
	truthy(isFunction(pp))
}
	)();

(() => {
	const pp = getPostProcessor('lib')
	truthy(defined(pp))
	truthy(isFunction(pp))
}
	)();

(() => {
	const pp = getPostProcessor('cmd')
	truthy(defined(pp))
	truthy(isFunction(pp))
}
	)()

DBG("compileFile()")

fails(() => compileFile('nosuchfile.civet'));

(() => {
	const hResult = compileFile('src/test/automate/test1.cielo', o`nopp`)
	truthy(isFile('src/test/automate/test1.temp.civet'))
}
	)()

DBG("runUnitTestsFor(stub)");

(() => {
	const lResults = Array.from(runUnitTestsFor('llutils.lib'))
	objListLike(lResults, [
		{stub: 'llutils.lib', success: true}
		])
}
	)()

DBG("runAllUnitTests()")

succeeds(() => {
	runAllUnitTests()
	return
})

// DBG "installCmd()", "uninstallCmd()"

// await installCmd 'src/test/automate/hello.ts', 'hello'
// hResult := await getCmdOutput 'hello', []
// str := hResult.stdout
// equal str, "Hello, World!\n"
// await uninstallCmd 'hello'

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcdGVzdFxcYXV0b21hdGUubGliLnRlc3QuY2l2ZXQudHN4Iiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGpvaG5kXFx1dGlsc1xcc3JjXFx0ZXN0XFxhdXRvbWF0ZS5saWIudGVzdC5jaXZldCJdLCJtYXBwaW5ncyI6IjtBQUFBLDBCQUF5QjtBQUN6QixBQUFBO0FBQ0EsQUFBQSxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztBQUNyRCxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVM7QUFDekIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVO0FBQ25DLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTTtBQUMvQyxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVE7QUFDMUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNO0FBQzFDLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsV0FBVyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsY0FBYyxDQUFDO0FBQzVELENBQUMsZUFBZSxDQUFDLENBQUMsZ0JBQWdCLENBQUM7QUFDbkMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxjQUFjLENBQUM7QUFDL0IsQ0FBQyxjQUFjLENBQUMsQ0FBQyxlQUFlLENBQUM7QUFDakMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0FBQ3RELENB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QUFBLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDbEIsQUFBQSxDQUFDLE07QUFBTSxDQUFBLENBQUE7QUFDUDtBQUNBLEFBQUEsdUNBQXNDO0FBQ3RDO0FBQ0EsQUFBQSx5REFBd0Q7QUFDeEQsQUFBQSw0Q0FBMkM7QUFDM0MsQUFBQSx3QkFBdUI7QUFDdkIsQUFBQSwrQkFBOEI7QUFDOUIsQUFBQSw2QkFBNEI7QUFDNUIiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgYXV0b21hdGUubGliLnRlc3QuY2l2ZXRcclxuXHJcbmltcG9ydCB7ZGVmaW5lZCwgaXNIYXNoLCBpc0Z1bmN0aW9ufSBmcm9tICdkYXRhdHlwZXMnXHJcbmltcG9ydCB7b30gZnJvbSAnbGx1dGlscydcclxuaW1wb3J0IHtnZXRDbWRBcmdzfSBmcm9tICdjbWQtYXJncydcclxuaW1wb3J0IHt3aXRoRXh0LCBUUGF0aEluZm8sIGlzRmlsZX0gZnJvbSAnZnN5cydcclxuaW1wb3J0IHtEQkd9IGZyb20gJ2xvZ2dlcidcclxuaW1wb3J0IHtleGVjQ21kLCBnZXRDbWRPdXRwdXR9IGZyb20gJ2V4ZWMnXHJcbmltcG9ydCB7XHJcblx0VFRlc3RlckZ1bmMsIFRDb21waWxlU3RhdHVzLCBUQ29tcGlsZXJGdW5jLCBUUG9zdFByb2Nlc3NvcixcclxuXHRUQ29tcGlsZXJDb25maWcsIGlzQ29tcGlsZXJDb25maWcsXHJcblx0VENvbXBpbGVySW5mbywgaXNDb21waWxlckluZm8sXHJcblx0VENvbXBpbGVSZXN1bHQsIFRVbml0VGVzdFJlc3VsdCxcclxuXHRnZXRDb21waWxlckNvbmZpZywgZ2V0Q29tcGlsZXJJbmZvLCBnZXRQb3N0UHJvY2Vzc29yLFxyXG5cdGNvbXBpbGVGaWxlLFxyXG5cdHJ1blVuaXRUZXN0c0ZvciwgcnVuQWxsVW5pdFRlc3RzLFxyXG5cdGluc3RhbGxDbWQsIHVuaW5zdGFsbENtZCxcclxuXHR9IGZyb20gJ2F1dG9tYXRlJ1xyXG5pbXBvcnQge1xyXG5cdGVxdWFsLCBsaWtlLCBzdWNjZWVkcywgZmFpbHMsIHRydXRoeSwgZmFsc3ksIHNldERpclRyZWUsXHJcblx0bWF0Y2hlcywgaXNUeXBlLCBub3RUeXBlLCBvYmpMaXN0TGlrZSwgc3RyTGlzdExpa2UsXHJcblx0fSBmcm9tICd1bml0LXRlc3QnXHJcblxyXG5nZXRDbWRBcmdzKClcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5zZXR1cCA6PSAoKTogdm9pZCA9PlxyXG5cclxuXHRzZXREaXJUcmVlKCdzcmMvdGVzdC9hdXRvbWF0ZScsIFwiXCJcIlxyXG5cdFx0dGVzdDEuY2llbG9cclxuXHRcdFx0IyB0ZXN0MS5jaWVsb1xyXG5cclxuXHRcdFx0TE9HIDo9IChzdHIpID0+IGNvbnNvbGUubG9nIHN0clxyXG5cdFx0XHRMT0cgXCJIZWxsbywgV29ybGQhXCJcclxuXHJcblx0XHR0ZXN0Mi5jaXZldFxyXG5cdFx0XHQjIHRlc3QyLmNpdmV0XHJcblxyXG5cdFx0XHRMT0cgOj0gKHN0cikgPT4gY29uc29sZS5sb2cgc3RyXHJcblx0XHRcdExPRyBcIkhlbGxvLCBXb3JsZCFcIlxyXG5cclxuXHRcdHRlc3QzLmNvZmZlZVxyXG5cdFx0XHQjIHRlc3QzLmNvZmZlZVxyXG5cclxuXHRcdFx0TE9HID0gKHN0cikgPT4gY29uc29sZS5sb2cgc3RyXHJcblx0XHRcdExPRyBcIkhlbGxvLCBXb3JsZCFcIlxyXG5cclxuXHRcdGdyYXBoLmRvdFxyXG5cdFx0XHRFRSAtPiBFTyB8IE9FIHwgT09cclxuXHRcdFx0RU8gLT4gRUVcclxuXHRcdFx0T0UgLT4gRUVcclxuXHRcdFx0T08gLT4gRUVcclxuXHRcdGhlbGxvLnRzXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiSGVsbG8sIFdvcmxkIVwiKTtcclxuXHRcdGNvbXAuY29uZmlnLmNpdmV0XHJcblx0XHRcdGltcG9ydCB7d2l0aEV4dH0gZnJvbSAnZnN5cydcclxuXHRcdFx0ZXhwb3J0IGRlZmF1bHQgbmV3IE9iamVjdCB7XHJcblx0XHRcdFx0aENvbXBpbGVyczoge1xyXG5cdFx0XHRcdFx0Jy50ZXN0Jzoge1xyXG5cdFx0XHRcdFx0XHRnZXRPdXRQYXRoczogKHBhdGg6IHN0cmluZykgPT4gW3dpdGhFeHQocGF0aCwgJy5vdXQnKV0sXHJcblx0XHRcdFx0XHRcdHRlc3RlcjogKCkgPT4gdHJ1ZSxcclxuXHRcdFx0XHRcdFx0Y29tcGlsZXI6IChwYXRoOiBzdHJpbmcpID0+IHVuZGVmaW5lZFxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdGhQb3N0UHJvY2Vzc29yczoge31cclxuXHRcdFx0XHR9XHJcblx0XHRcIlwiXCIsIG8nY2xlYXInKVxyXG5cdHJldHVyblxyXG5cclxuc2V0dXAoKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbkRCRyBcInR5cGUgVFRlc3RlckZ1bmNcIlxyXG5cclxuaXNUeXBlICdUVGVzdGVyRnVuYycsICgpID0+XHJcblx0Y29uc29sZS5sb2cgXCJIZWxsbywgV29ybGQhXCJcclxuXHRyZXR1cm4gdHJ1ZVxyXG5cclxuREJHIFwidHlwZSBUQ29tcGlsZVN0YXR1c1wiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlU3RhdHVzJywgJ3RlbXAnXHJcbmlzVHlwZSAnVENvbXBpbGVTdGF0dXMnLCAnZXhpc3RzJ1xyXG5pc1R5cGUgJ1RDb21waWxlU3RhdHVzJywgJ2NvbXBpbGVkJ1xyXG5ub3RUeXBlICdUQ29tcGlsZVN0YXR1cycsICdkdW1teSdcclxuXHJcbkRCRyBcInR5cGUgVENvbXBpbGVyRnVuY1wiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlckZ1bmMnLCAocGF0aDogc3RyaW5nKSA9PlxyXG5cdGNvbnNvbGUubG9nIHBhdGhcclxuXHRyZXR1cm4gJ2NvbXBpbGVkJ1xyXG5cclxuREJHIFwidHlwZSBUUG9zdFByb2Nlc3NvclwiXHJcblxyXG4oKCkgPT5cclxuXHRsb2dpdCA6PSAoaEluZm86IFRQYXRoSW5mbykgPT5cclxuXHRcdGNvbnNvbGUubG9nIFwiZG9uZVwiXHJcblx0XHRyZXR1cm5cclxuXHRpc1R5cGUgJ1RQb3N0UHJvY2Vzc29yJywgbG9naXRcclxuXHQpKClcclxuXHJcbkRCRyBcInR5cGUgVENvbXBpbGVySW5mb1wiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlckluZm8nLCB7XHJcblx0dGVzdGVyOiAoKSA9PiB0cnVlLFxyXG5cdGNvbXBpbGVyOiAocGF0aDogc3RyaW5nKSA9PiByZXR1cm4gJ2NvbXBpbGVkJyxcclxuXHRnZXRPdXRQYXRoczogKHBhdGg6IHN0cmluZykgPT4gcmV0dXJuIFsndGVtcC50cyddXHJcblx0fVxyXG5cclxuREJHIFwidHlwZSBUQ29tcGlsZXJDb25maWdcIiwgXCJpc0NvbXBpbGVyQ29uZmlnKClcIlxyXG5cclxuaXNUeXBlICdUQ29tcGlsZXJDb25maWcnLCB7XHJcblx0aENvbXBpbGVyczoge31cclxuXHRoUG9zdFByb2Nlc3NvcnM6IHt9XHJcblx0fVxyXG5cclxuREJHIFwidHlwZSBUQ29tcGlsZVJlc3VsdFwiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlUmVzdWx0Jywge1xyXG5cdHN0YXR1czogJ2NvbXBpbGVkJ1xyXG5cdHBhdGg6ICd0ZW1wLmNpdmV0J1xyXG5cdH1cclxuXHJcbkRCRyBcInR5cGUgVFVuaXRUZXN0UmVzdWx0XCJcclxuXHJcbmlzVHlwZSAnVFVuaXRUZXN0UmVzdWx0Jywge1xyXG5cdHN0dWI6ICd0ZW1wJ1xyXG5cdHN1Y2Nlc3M6IHRydWVcclxuXHR9XHJcblxyXG5EQkcgXCJnZXRDb21waWxlckNvbmZpZyhwYXRoKVwiXHJcblxyXG4oKCkgPT5cclxuXHRjaXZldFBhdGggOj0gJ3NyYy90ZXN0L2F1dG9tYXRlL2NvbXAuY29uZmlnLmNpdmV0J1xyXG5cdGhDb25maWcgOj0gZ2V0Q29tcGlsZXJDb25maWcoY2l2ZXRQYXRoKVxyXG5cdGlzVHlwZSAnVENvbXBpbGVyQ29uZmlnJywgaENvbmZpZywgaXNDb21waWxlckNvbmZpZ1xyXG5cdCkoKVxyXG5cclxuREJHIFwiZ2V0Q29tcGlsZXJJbmZvKClcIlxyXG5cclxuaXNUeXBlICdUQ29tcGlsZXJJbmZvJywgZ2V0Q29tcGlsZXJJbmZvKCcuZG90JyksIGlzQ29tcGlsZXJJbmZvXHJcblxyXG5EQkcgXCJnZXRQb3N0UHJvY2Vzc29yKClcIlxyXG5cclxuKCgpID0+XHJcblx0cHAgOj0gZ2V0UG9zdFByb2Nlc3NvcigndGVzdCcpXHJcblx0dHJ1dGh5IGRlZmluZWQocHApXHJcblx0dHJ1dGh5IGlzRnVuY3Rpb24ocHApXHJcblx0KSgpXHJcblxyXG4oKCkgPT5cclxuXHRwcCA6PSBnZXRQb3N0UHJvY2Vzc29yKCdsaWInKVxyXG5cdHRydXRoeSBkZWZpbmVkKHBwKVxyXG5cdHRydXRoeSBpc0Z1bmN0aW9uKHBwKVxyXG5cdCkoKVxyXG5cclxuKCgpID0+XHJcblx0cHAgOj0gZ2V0UG9zdFByb2Nlc3NvcignY21kJylcclxuXHR0cnV0aHkgZGVmaW5lZChwcClcclxuXHR0cnV0aHkgaXNGdW5jdGlvbihwcClcclxuXHQpKClcclxuXHJcbkRCRyBcImNvbXBpbGVGaWxlKClcIlxyXG5cclxuZmFpbHMgKCkgPT4gY29tcGlsZUZpbGUgJ25vc3VjaGZpbGUuY2l2ZXQnXHJcblxyXG4oKCkgPT5cclxuXHRoUmVzdWx0IDo9IGNvbXBpbGVGaWxlKCdzcmMvdGVzdC9hdXRvbWF0ZS90ZXN0MS5jaWVsbycsIG8nbm9wcCcpXHJcblx0dHJ1dGh5IGlzRmlsZSgnc3JjL3Rlc3QvYXV0b21hdGUvdGVzdDEudGVtcC5jaXZldCcpXHJcblx0KSgpXHJcblxyXG5EQkcgXCJydW5Vbml0VGVzdHNGb3Ioc3R1YilcIlxyXG5cclxuKCgpID0+XHJcblx0bFJlc3VsdHMgOj0gQXJyYXkuZnJvbShydW5Vbml0VGVzdHNGb3IoJ2xsdXRpbHMubGliJykpXHJcblx0b2JqTGlzdExpa2UgbFJlc3VsdHMsIFtcclxuXHRcdHtzdHViOiAnbGx1dGlscy5saWInLCBzdWNjZXNzOiB0cnVlfVxyXG5cdFx0XVxyXG5cdCkoKVxyXG5cclxuREJHIFwicnVuQWxsVW5pdFRlc3RzKClcIlxyXG5cclxuc3VjY2VlZHMgKCkgPT5cclxuXHRydW5BbGxVbml0VGVzdHMoKVxyXG5cdHJldHVyblxyXG5cclxuIyBEQkcgXCJpbnN0YWxsQ21kKClcIiwgXCJ1bmluc3RhbGxDbWQoKVwiXHJcblxyXG4jIGF3YWl0IGluc3RhbGxDbWQgJ3NyYy90ZXN0L2F1dG9tYXRlL2hlbGxvLnRzJywgJ2hlbGxvJ1xyXG4jIGhSZXN1bHQgOj0gYXdhaXQgZ2V0Q21kT3V0cHV0ICdoZWxsbycsIFtdXHJcbiMgc3RyIDo9IGhSZXN1bHQuc3Rkb3V0XHJcbiMgZXF1YWwgc3RyLCBcIkhlbGxvLCBXb3JsZCFcXG5cIlxyXG4jIGF3YWl0IHVuaW5zdGFsbENtZCAnaGVsbG8nXHJcbiJdfQ==