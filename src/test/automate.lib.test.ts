"use strict";
// automate.lib.test.civet

import {defined, isHash, isFunction} from 'datatypes'
import {o} from 'llutils'
import {getCmdArgs} from 'cmd-args'
import {withExt, TPathInfo} from 'fsys'
import {DBG} from 'logger'
import {execCmd, getCmdOutput} from 'exec'
import {
	TTesterFunc, TCompileStatus, TCompilerFunc, TPostProcessor,
	TCompilerConfig, isCompilerConfig,
	TCompilerInfo, isCompilerInfo,
	TCompileResult, TUnitTestResult,
	getCompilerConfig, getCompilerInfo, getPostProcessor,
	compileFile,
	runUnitTestsFor, runAllUnitTests,
	installCmd, uninstallCmd,
	} from 'automate'
import {
	equal, like, succeeds, fails, truthy, falsy, setDirTree,
	matches, isType, notType, objListLike, strListLike,
	} from 'unit-test'

getCmdArgs()

// ---------------------------------------------------------------------------

const setup = (): void => {

	setDirTree('src/test/automate', `test1.cielo
	# test1.cielo

	LOG := (str) => console.log str
	LOG "Hello, World!"

test2.civet
	# test2.civet

	LOG := (str) => console.log str
	LOG "Hello, World!"

test3.coffee
	# test3.coffee

	LOG = (str) => console.log str
	LOG "Hello, World!"

graph.dot
	EE -> EO | OE | OO
	EO -> EE
	OE -> EE
	OO -> EE
hello.ts
	console.log("Hello, World!");
comp.config.civet
	import {withExt} from 'fsys'
	export default new Object {
		hCompilers: {
			'.test': {
				getOutPaths: (path: string) => [withExt(path, '.out')],
				tester: () => true,
				compiler: (path: string) => undefined
				}
			},
		hPostProcessors: {}
		}`, o`clear`)
	return
}

setup()

// ---------------------------------------------------------------------------

DBG("type TTesterFunc")

isType('TTesterFunc', () => {
	console.log("Hello, World!")
	return true
})

DBG("type TCompileStatus")

isType('TCompileStatus', 'temp')
isType('TCompileStatus', 'exists')
isType('TCompileStatus', 'compiled')
notType('TCompileStatus', 'dummy')

DBG("type TCompilerFunc")

isType('TCompilerFunc', (path: string) => {
	console.log(path)
	return 'compiled'
})

DBG("type TPostProcessor");

(() => {
	const logit = (hInfo: TPathInfo) => {
		console.log("done")
		return
	}
	isType('TPostProcessor', logit)
}
	)()

DBG("type TCompilerInfo")

isType('TCompilerInfo', {
	tester: () => true,
	compiler: (path: string) => { return 'compiled' },
	getOutPaths: (path: string) => { return ['temp.ts'] }
	})

DBG("type TCompilerConfig", "isCompilerConfig()")

isType('TCompilerConfig', {
	hCompilers: {},
	hPostProcessors: {}
	})

DBG("type TCompileResult")

isType('TCompileResult', {
	status: 'compiled',
	path: 'temp.civet'
	})

DBG("type TUnitTestResult")

isType('TUnitTestResult', {
	stub: 'temp',
	success: true
	})

DBG("getCompilerConfig(path)");

(() => {
	const civetPath = 'src/test/compile/comp.config.civet'
	const hConfig = getCompilerConfig(civetPath)
	isType('TCompilerConfig', hConfig, isCompilerConfig)
}
	)()

DBG("getCompilerInfo()")

isType('TCompilerInfo', getCompilerInfo('.dot'), isCompilerInfo)

DBG("getPostProcessor()");

(() => {
	const pp = getPostProcessor('test')
	truthy(defined(pp))
	truthy(isFunction(pp))
}
	)();

(() => {
	const pp = getPostProcessor('lib')
	truthy(defined(pp))
	truthy(isFunction(pp))
}
	)();

(() => {
	const pp = getPostProcessor('cmd')
	truthy(defined(pp))
	truthy(isFunction(pp))
}
	)()

DBG("compileFile()")

fails(() => compileFile('nosuchfile.civet'));

(() => {
	const hResult = compileFile('src/test/compile/test1.cielo', o`nopp`)
}
	// truthy isFile('test/compile/test1.civet')
	)()

DBG("runUnitTestsFor(stub)");

(() => {
	const lResults = Array.from(runUnitTestsFor('llutils.lib'))
	objListLike(lResults, [
		{stub: 'llutils.lib', success: true}
		])
}
	)()

DBG("runAllUnitTests()")

succeeds(() => {
	runAllUnitTests()
	return
})

// DBG "installCmd()", "uninstallCmd()"

// await installCmd 'src/test/compile/hello.ts', 'hello'
// hResult := await getCmdOutput 'hello', []
// str := hResult.stdout
// equal str, "Hello, World!\n"
// await uninstallCmd 'hello'

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxqb2huZFxcdXRpbHNcXHNyY1xcdGVzdFxcYXV0b21hdGUubGliLnRlc3QuY2l2ZXQudHN4Iiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGpvaG5kXFx1dGlsc1xcc3JjXFx0ZXN0XFxhdXRvbWF0ZS5saWIudGVzdC5jaXZldCJdLCJtYXBwaW5ncyI6IjtBQUFBLDBCQUF5QjtBQUN6QixBQUFBO0FBQ0EsQUFBQSxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVztBQUNyRCxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVM7QUFDekIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVO0FBQ25DLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTTtBQUN2QyxBQUFBLEFBQUEsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVE7QUFDMUIsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNO0FBQzFDLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsV0FBVyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsY0FBYyxDQUFDO0FBQzVELENBQUMsZUFBZSxDQUFDLENBQUMsZ0JBQWdCLENBQUM7QUFDbkMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxjQUFjLENBQUM7QUFDL0IsQ0FBQyxjQUFjLENBQUMsQ0FBQyxlQUFlLENBQUM7QUFDakMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0FBQ3RELENBQUMsV0FBVyxDQUFDO0FB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QTtBQUNQO0FBQ0EsQUFBQSx1Q0FBc0M7QUFDdEM7QUFDQSxBQUFBLHdEQUF1RDtBQUN2RCxBQUFBLDRDQUEyQztBQUMzQyxBQUFBLHdCQUF1QjtBQUN2QixBQUFBLCtCQUE4QjtBQUM5QixBQUFBLDZCQUE0QjtBQUM1QiIsIm5hbWVzIjpbXSwic291cmNlc0NvbnRlbnQiOlsiIyBhdXRvbWF0ZS5saWIudGVzdC5jaXZldFxyXG5cclxuaW1wb3J0IHtkZWZpbmVkLCBpc0hhc2gsIGlzRnVuY3Rpb259IGZyb20gJ2RhdGF0eXBlcydcclxuaW1wb3J0IHtvfSBmcm9tICdsbHV0aWxzJ1xyXG5pbXBvcnQge2dldENtZEFyZ3N9IGZyb20gJ2NtZC1hcmdzJ1xyXG5pbXBvcnQge3dpdGhFeHQsIFRQYXRoSW5mb30gZnJvbSAnZnN5cydcclxuaW1wb3J0IHtEQkd9IGZyb20gJ2xvZ2dlcidcclxuaW1wb3J0IHtleGVjQ21kLCBnZXRDbWRPdXRwdXR9IGZyb20gJ2V4ZWMnXHJcbmltcG9ydCB7XHJcblx0VFRlc3RlckZ1bmMsIFRDb21waWxlU3RhdHVzLCBUQ29tcGlsZXJGdW5jLCBUUG9zdFByb2Nlc3NvcixcclxuXHRUQ29tcGlsZXJDb25maWcsIGlzQ29tcGlsZXJDb25maWcsXHJcblx0VENvbXBpbGVySW5mbywgaXNDb21waWxlckluZm8sXHJcblx0VENvbXBpbGVSZXN1bHQsIFRVbml0VGVzdFJlc3VsdCxcclxuXHRnZXRDb21waWxlckNvbmZpZywgZ2V0Q29tcGlsZXJJbmZvLCBnZXRQb3N0UHJvY2Vzc29yLFxyXG5cdGNvbXBpbGVGaWxlLFxyXG5cdHJ1blVuaXRUZXN0c0ZvciwgcnVuQWxsVW5pdFRlc3RzLFxyXG5cdGluc3RhbGxDbWQsIHVuaW5zdGFsbENtZCxcclxuXHR9IGZyb20gJ2F1dG9tYXRlJ1xyXG5pbXBvcnQge1xyXG5cdGVxdWFsLCBsaWtlLCBzdWNjZWVkcywgZmFpbHMsIHRydXRoeSwgZmFsc3ksIHNldERpclRyZWUsXHJcblx0bWF0Y2hlcywgaXNUeXBlLCBub3RUeXBlLCBvYmpMaXN0TGlrZSwgc3RyTGlzdExpa2UsXHJcblx0fSBmcm9tICd1bml0LXRlc3QnXHJcblxyXG5nZXRDbWRBcmdzKClcclxuXHJcbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5zZXR1cCA6PSAoKTogdm9pZCA9PlxyXG5cclxuXHRzZXREaXJUcmVlKCdzcmMvdGVzdC9hdXRvbWF0ZScsIFwiXCJcIlxyXG5cdFx0dGVzdDEuY2llbG9cclxuXHRcdFx0IyB0ZXN0MS5jaWVsb1xyXG5cclxuXHRcdFx0TE9HIDo9IChzdHIpID0+IGNvbnNvbGUubG9nIHN0clxyXG5cdFx0XHRMT0cgXCJIZWxsbywgV29ybGQhXCJcclxuXHJcblx0XHR0ZXN0Mi5jaXZldFxyXG5cdFx0XHQjIHRlc3QyLmNpdmV0XHJcblxyXG5cdFx0XHRMT0cgOj0gKHN0cikgPT4gY29uc29sZS5sb2cgc3RyXHJcblx0XHRcdExPRyBcIkhlbGxvLCBXb3JsZCFcIlxyXG5cclxuXHRcdHRlc3QzLmNvZmZlZVxyXG5cdFx0XHQjIHRlc3QzLmNvZmZlZVxyXG5cclxuXHRcdFx0TE9HID0gKHN0cikgPT4gY29uc29sZS5sb2cgc3RyXHJcblx0XHRcdExPRyBcIkhlbGxvLCBXb3JsZCFcIlxyXG5cclxuXHRcdGdyYXBoLmRvdFxyXG5cdFx0XHRFRSAtPiBFTyB8IE9FIHwgT09cclxuXHRcdFx0RU8gLT4gRUVcclxuXHRcdFx0T0UgLT4gRUVcclxuXHRcdFx0T08gLT4gRUVcclxuXHRcdGhlbGxvLnRzXHJcblx0XHRcdGNvbnNvbGUubG9nKFwiSGVsbG8sIFdvcmxkIVwiKTtcclxuXHRcdGNvbXAuY29uZmlnLmNpdmV0XHJcblx0XHRcdGltcG9ydCB7d2l0aEV4dH0gZnJvbSAnZnN5cydcclxuXHRcdFx0ZXhwb3J0IGRlZmF1bHQgbmV3IE9iamVjdCB7XHJcblx0XHRcdFx0aENvbXBpbGVyczoge1xyXG5cdFx0XHRcdFx0Jy50ZXN0Jzoge1xyXG5cdFx0XHRcdFx0XHRnZXRPdXRQYXRoczogKHBhdGg6IHN0cmluZykgPT4gW3dpdGhFeHQocGF0aCwgJy5vdXQnKV0sXHJcblx0XHRcdFx0XHRcdHRlc3RlcjogKCkgPT4gdHJ1ZSxcclxuXHRcdFx0XHRcdFx0Y29tcGlsZXI6IChwYXRoOiBzdHJpbmcpID0+IHVuZGVmaW5lZFxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdGhQb3N0UHJvY2Vzc29yczoge31cclxuXHRcdFx0XHR9XHJcblx0XHRcIlwiXCIsIG8nY2xlYXInKVxyXG5cdHJldHVyblxyXG5cclxuc2V0dXAoKVxyXG5cclxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbkRCRyBcInR5cGUgVFRlc3RlckZ1bmNcIlxyXG5cclxuaXNUeXBlICdUVGVzdGVyRnVuYycsICgpID0+XHJcblx0Y29uc29sZS5sb2cgXCJIZWxsbywgV29ybGQhXCJcclxuXHRyZXR1cm4gdHJ1ZVxyXG5cclxuREJHIFwidHlwZSBUQ29tcGlsZVN0YXR1c1wiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlU3RhdHVzJywgJ3RlbXAnXHJcbmlzVHlwZSAnVENvbXBpbGVTdGF0dXMnLCAnZXhpc3RzJ1xyXG5pc1R5cGUgJ1RDb21waWxlU3RhdHVzJywgJ2NvbXBpbGVkJ1xyXG5ub3RUeXBlICdUQ29tcGlsZVN0YXR1cycsICdkdW1teSdcclxuXHJcbkRCRyBcInR5cGUgVENvbXBpbGVyRnVuY1wiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlckZ1bmMnLCAocGF0aDogc3RyaW5nKSA9PlxyXG5cdGNvbnNvbGUubG9nIHBhdGhcclxuXHRyZXR1cm4gJ2NvbXBpbGVkJ1xyXG5cclxuREJHIFwidHlwZSBUUG9zdFByb2Nlc3NvclwiXHJcblxyXG4oKCkgPT5cclxuXHRsb2dpdCA6PSAoaEluZm86IFRQYXRoSW5mbykgPT5cclxuXHRcdGNvbnNvbGUubG9nIFwiZG9uZVwiXHJcblx0XHRyZXR1cm5cclxuXHRpc1R5cGUgJ1RQb3N0UHJvY2Vzc29yJywgbG9naXRcclxuXHQpKClcclxuXHJcbkRCRyBcInR5cGUgVENvbXBpbGVySW5mb1wiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlckluZm8nLCB7XHJcblx0dGVzdGVyOiAoKSA9PiB0cnVlLFxyXG5cdGNvbXBpbGVyOiAocGF0aDogc3RyaW5nKSA9PiByZXR1cm4gJ2NvbXBpbGVkJyxcclxuXHRnZXRPdXRQYXRoczogKHBhdGg6IHN0cmluZykgPT4gcmV0dXJuIFsndGVtcC50cyddXHJcblx0fVxyXG5cclxuREJHIFwidHlwZSBUQ29tcGlsZXJDb25maWdcIiwgXCJpc0NvbXBpbGVyQ29uZmlnKClcIlxyXG5cclxuaXNUeXBlICdUQ29tcGlsZXJDb25maWcnLCB7XHJcblx0aENvbXBpbGVyczoge31cclxuXHRoUG9zdFByb2Nlc3NvcnM6IHt9XHJcblx0fVxyXG5cclxuREJHIFwidHlwZSBUQ29tcGlsZVJlc3VsdFwiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlUmVzdWx0Jywge1xyXG5cdHN0YXR1czogJ2NvbXBpbGVkJ1xyXG5cdHBhdGg6ICd0ZW1wLmNpdmV0J1xyXG5cdH1cclxuXHJcbkRCRyBcInR5cGUgVFVuaXRUZXN0UmVzdWx0XCJcclxuXHJcbmlzVHlwZSAnVFVuaXRUZXN0UmVzdWx0Jywge1xyXG5cdHN0dWI6ICd0ZW1wJ1xyXG5cdHN1Y2Nlc3M6IHRydWVcclxuXHR9XHJcblxyXG5EQkcgXCJnZXRDb21waWxlckNvbmZpZyhwYXRoKVwiXHJcblxyXG4oKCkgPT5cclxuXHRjaXZldFBhdGggOj0gJ3NyYy90ZXN0L2NvbXBpbGUvY29tcC5jb25maWcuY2l2ZXQnXHJcblx0aENvbmZpZyA6PSBnZXRDb21waWxlckNvbmZpZyhjaXZldFBhdGgpXHJcblx0aXNUeXBlICdUQ29tcGlsZXJDb25maWcnLCBoQ29uZmlnLCBpc0NvbXBpbGVyQ29uZmlnXHJcblx0KSgpXHJcblxyXG5EQkcgXCJnZXRDb21waWxlckluZm8oKVwiXHJcblxyXG5pc1R5cGUgJ1RDb21waWxlckluZm8nLCBnZXRDb21waWxlckluZm8oJy5kb3QnKSwgaXNDb21waWxlckluZm9cclxuXHJcbkRCRyBcImdldFBvc3RQcm9jZXNzb3IoKVwiXHJcblxyXG4oKCkgPT5cclxuXHRwcCA6PSBnZXRQb3N0UHJvY2Vzc29yKCd0ZXN0JylcclxuXHR0cnV0aHkgZGVmaW5lZChwcClcclxuXHR0cnV0aHkgaXNGdW5jdGlvbihwcClcclxuXHQpKClcclxuXHJcbigoKSA9PlxyXG5cdHBwIDo9IGdldFBvc3RQcm9jZXNzb3IoJ2xpYicpXHJcblx0dHJ1dGh5IGRlZmluZWQocHApXHJcblx0dHJ1dGh5IGlzRnVuY3Rpb24ocHApXHJcblx0KSgpXHJcblxyXG4oKCkgPT5cclxuXHRwcCA6PSBnZXRQb3N0UHJvY2Vzc29yKCdjbWQnKVxyXG5cdHRydXRoeSBkZWZpbmVkKHBwKVxyXG5cdHRydXRoeSBpc0Z1bmN0aW9uKHBwKVxyXG5cdCkoKVxyXG5cclxuREJHIFwiY29tcGlsZUZpbGUoKVwiXHJcblxyXG5mYWlscyAoKSA9PiBjb21waWxlRmlsZSAnbm9zdWNoZmlsZS5jaXZldCdcclxuXHJcbigoKSA9PlxyXG5cdGhSZXN1bHQgOj0gY29tcGlsZUZpbGUoJ3NyYy90ZXN0L2NvbXBpbGUvdGVzdDEuY2llbG8nLCBvJ25vcHAnKVxyXG5cdCMgdHJ1dGh5IGlzRmlsZSgndGVzdC9jb21waWxlL3Rlc3QxLmNpdmV0JylcclxuXHQpKClcclxuXHJcbkRCRyBcInJ1blVuaXRUZXN0c0ZvcihzdHViKVwiXHJcblxyXG4oKCkgPT5cclxuXHRsUmVzdWx0cyA6PSBBcnJheS5mcm9tKHJ1blVuaXRUZXN0c0ZvcignbGx1dGlscy5saWInKSlcclxuXHRvYmpMaXN0TGlrZSBsUmVzdWx0cywgW1xyXG5cdFx0e3N0dWI6ICdsbHV0aWxzLmxpYicsIHN1Y2Nlc3M6IHRydWV9XHJcblx0XHRdXHJcblx0KSgpXHJcblxyXG5EQkcgXCJydW5BbGxVbml0VGVzdHMoKVwiXHJcblxyXG5zdWNjZWVkcyAoKSA9PlxyXG5cdHJ1bkFsbFVuaXRUZXN0cygpXHJcblx0cmV0dXJuXHJcblxyXG4jIERCRyBcImluc3RhbGxDbWQoKVwiLCBcInVuaW5zdGFsbENtZCgpXCJcclxuXHJcbiMgYXdhaXQgaW5zdGFsbENtZCAnc3JjL3Rlc3QvY29tcGlsZS9oZWxsby50cycsICdoZWxsbydcclxuIyBoUmVzdWx0IDo9IGF3YWl0IGdldENtZE91dHB1dCAnaGVsbG8nLCBbXVxyXG4jIHN0ciA6PSBoUmVzdWx0LnN0ZG91dFxyXG4jIGVxdWFsIHN0ciwgXCJIZWxsbywgV29ybGQhXFxuXCJcclxuIyBhd2FpdCB1bmluc3RhbGxDbWQgJ2hlbGxvJ1xyXG4iXX0=