"use strict";
// logger.lib.test.civet

import {
	assert, throwsError,
	DBG, LOG, WARN, ERR, LOGVALUE, DBGVALUE,
	getLog, getFullLog, setLogLevel, clearLog,
	curLogLevel, pushLogLevel, popLogLevel,
	LogCmd, getCmdArgs, spaces,
	} from '../src/lib/utils.lib.ts'
import {
	equal, truthy, falsy, succeeds, fails, matches,
	} from '../src/lib/unit-test.lib.ts'

const hArgs = getCmdArgs()

// ---------------------------------------------------------------------------

DBG("enum LogCmd")

succeeds(() => {
	clearLog()
	setLogLevel('info')
	LOG("info", LogCmd.INDENT)
	LOG("stuff", LogCmd.UNDENT)
	LOG("done")
	equal(getLog(), `I info
I    stuff
I done`)
})

DBG("clearLog()", "getLog()")

succeeds(() => {
	clearLog()
	setLogLevel('info')
	LOG("info", LogCmd.INDENT)
	LOG("stuff", LogCmd.UNDENT)
	LOG("finished")
	equal(getLog(), `I info
I    stuff
I finished`)
})

succeeds(() => {
	clearLog()
	setLogLevel('profile')
	LOG("info", LogCmd.INDENT)
	LOG("stuff", LogCmd.UNDENT)
	LOG("done")

	matches(getLog(), /^ms\n-{5}\n\s*\d+\sI\sinfo\n\s*\d+\sI\s{4}stuff\s*\d+\sI\sdone$/)
})

DBG("pushLogLevel()", "popLogLevel()", "curLogLevel()");

(() => {
	const save = curLogLevel()
	pushLogLevel('warn')
	equal(curLogLevel(), 'warn')
	pushLogLevel('debug')
	equal(curLogLevel(), 'debug')
	popLogLevel()
	equal(curLogLevel(), 'warn')
	popLogLevel()
	equal(curLogLevel(), save)
}
	)()

DBG("DBG()", "DBGVALUE()", "LOG()", "LOGVALUE()", "WARN()", "ERR()", "setLogLevel()", "getFullLog()")

// --- Define 2 functions, useful in unit tests

const logAll = (): void => {
	DBG("debug")
	DBGVALUE("lItems", ['a','b'])
	LOG("info")
	LOGVALUE("hItems", {meaning: 42})
	WARN("warning")
	ERR("error")
	return
}

const getTestLog = (level: string='info'): string => {
	clearLog()
	setLogLevel(level)
	logAll()
	return getLog()
}

succeeds(() => {
	clearLog()
	setLogLevel('warn')
	logAll()
	assert((curLogLevel() === 'warn'))

	setLogLevel('info')
	logAll()
	assert((curLogLevel() === 'info'))

	pushLogLevel('error')
	logAll()
	assert((curLogLevel() === 'error'))

	popLogLevel()
	logAll()
	assert((curLogLevel() === 'info'))

	assert((getLog() === `W warning
ERROR: error
I info
I hItems = {
${spaces(3)}"meaning": 42
}
W warning
ERROR: error
ERROR: error
I info
I hItems = {
${spaces(3)}"meaning": 42
}
W warning
ERROR: error`))

	assert((getFullLog() === `W warning
ERROR: error
I info
I hItems = {
${spaces(3)}"meaning": 42
}
W warning
ERROR: error
ERROR: error
I info
I hItems = {
${spaces(3)}"meaning": 42
}
W warning
ERROR: error`))
})

// ---------------------------------------------------------------------------

DBG("getLog()");

(() => {
	equal(getTestLog(), `I info
I hItems = {
${spaces(3)}"meaning": 42
}
W warning
ERROR: error`)
}
	)();

(() => {
	equal(getTestLog('debug'), `D debug
D lItems = [
${spaces(3)}"a",
${spaces(3)}"b"
]
I info
I hItems = {
${spaces(3)}"meaning": 42
}
W warning
ERROR: error`)
}
	)();

(() => {
	equal(getTestLog('error'), `ERROR: error`)
}
	)()

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC9sb2dnZXIubGliLnRlc3QuY2l2ZXQudHN4Iiwic291cmNlcyI6WyJ0ZXN0L2xvZ2dlci5saWIudGVzdC5jaXZldCJdLCJtYXBwaW5ncyI6IjtBQUFBLHdCQUF1QjtBQUN2QixBQUFBO0FBQ0EsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ3JCLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQ3pDLENBQUMsTUFBTSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQzNDLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQ3hDLENBQUMsTUFBTSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQzVCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBeUI7QUFDakMsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDaEQsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLDZCQUE2QjtBQUNyQyxBQUFBO0FBQ0EsQUFBQSxBQUFLLE1BQUwsS0FBSyxDQUFDLENBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNyQixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxHQUFHLENBQUEsQUFBQyxhQUFhLENBQUE7QUFDakIsQUFBQTtBQUNBLEFBQUEsQUFBQSxRQUFRLENBQUEsQUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNkLEFBQUEsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNYLEFBQUEsQ0FBQyxXQUFXLENBQUEsQUFBQyxNQUFNLENBQUE7QUFDbkIsQUFBQSxDQUFDLEdBQUcsQ0FBQSxBQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUE7QUFDMUIsQUFBQSxDQUFDLEdBQUcsQ0FBQSxBQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUE7QUFDM0IsQUFBQSxDQUFDLEdBQUcsQ0FBQSxBQUFDLE1BQU0sQ0FBQTtBQUNYLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBRztBQUNwQjtBQUNBLE1BRUUsQ0FBRyxDO0FBQUEsQ0FBQSxDQUFBO0FBQ0wsQUFBQTtBQUNBLEFBQUEsQUFBQSxHQUFHLENBQUEsQUFBQyxZQUFZLENBQUMsQ0FBQyxVQUFVLENBQUE7QUFDNUIsQUFBQTtBQUNBLEFBQUEsQUFBQSxRQUFRLENBQUEsQUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNkLEFBQUEsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNYLEFBQUEsQ0FBQyxXQUFXLENBQUEsQUFBQyxNQUFNLENBQUE7QUFDbkIsQUFBQSxDQUFDLEdBQUcsQ0FBQSxBQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUE7QUFDMUIsQUFBQSxDQUFDLEdBQUcsQ0FBQSxBQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUE7QUFDM0IsQUFBQSxDQUFDLEdBQUcsQ0FBQSxBQUFDLFVBQVUsQ0FBQTtBQUNmLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBRztBQUNwQjtBQUNBLFVBRUUsQ0FBRyxDO0FBQUEsQ0FBQSxDQUFBO0FBQ0wsQUFBQTtBQUNBLEFBQUEsQUFBQSxRQUFRLENBQUEsQUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNkLEFBQUEsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNYLEFBQUEs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QUEsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNkLEFBQUEsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNULEFBQUEsQ0FBQyxNQUFNLENBQUEsQUFBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsR0FBRSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0FBQ2pDLEFBQUE7QUFDQSxBQUFBLENBQUMsTUFBTSxDQUFBLEFBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUUsQ0FBQyxDQUFHO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLEFBQ0UsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxBQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2Q7QUFDQTtBQUNBLFlBQ0UsQ0FBRyxDQUFDLENBQUE7QUFDTixBQUFBO0FBQ0EsQUFBQSxDQUFDLE1BQU0sQ0FBQSxBQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxHQUFFLENBQUMsQ0FBRztBQUM1QjtBQUNBO0FBQ0E7QUFDQSxBQUNFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNkO0FBQ0E7QUFDQSxZQUNFLENBQUcsQ0FBQyxDO0FBQUEsQ0FBQSxDQUFBO0FBQ04sQUFBQTtBQUNBLEFBQUEsOEVBQTZFO0FBQzdFLEFBQUE7QUFDQSxBQUFBLEFBQUEsR0FBRyxDQUFBLEFBQUMsVUFBVSxDLENBQUE7QUFDZCxBQUFBO0FBQ0EsQUFBQSxBQUFBLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBLENBQUE7QUFDTixBQUFBLENBQUMsS0FBSyxDQUFBLEFBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUc7QUFDeEI7QUFDQSxBQUNFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2Q7QUFDQTtBQUNBLFlBQ0UsQ0FBRyxDO0FBQUEsQ0FBQTtBQUNMLENBQUMsQ0FBQyxDQUFDLEMsQ0FBQztBQUNKLEFBQUE7QUFDQSxBQUFBLEFBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNOLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFHO0FBQy9CO0FBQ0EsQUFDRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNkLEFBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxBQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2Q7QUFDQTtBQUNBLFlBQ0UsQ0FBRyxDO0FBQUEsQ0FBQTtBQUNMLENBQUMsQ0FBQyxDQUFDLEMsQ0FBQztBQUNKLEFBQUE7QUFDQSxBQUFBLEFBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQTtBQUNOLEFBQUEsQ0FBQyxLQUFLLENBQUEsQUFBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFHLFlBRTdCLENBQUcsQztBQUFBLENBQUE7QUFDTCxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0oiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgbG9nZ2VyLmxpYi50ZXN0LmNpdmV0XG5cbmltcG9ydCB7XG5cdGFzc2VydCwgdGhyb3dzRXJyb3IsXG5cdERCRywgTE9HLCBXQVJOLCBFUlIsIExPR1ZBTFVFLCBEQkdWQUxVRSxcblx0Z2V0TG9nLCBnZXRGdWxsTG9nLCBzZXRMb2dMZXZlbCwgY2xlYXJMb2csXG5cdGN1ckxvZ0xldmVsLCBwdXNoTG9nTGV2ZWwsIHBvcExvZ0xldmVsLFxuXHRMb2dDbWQsIGdldENtZEFyZ3MsIHNwYWNlcyxcblx0fSBmcm9tICcuLi9zcmMvbGliL3V0aWxzLmxpYi50cydcbmltcG9ydCB7XG5cdGVxdWFsLCB0cnV0aHksIGZhbHN5LCBzdWNjZWVkcywgZmFpbHMsIG1hdGNoZXMsXG5cdH0gZnJvbSAnLi4vc3JjL2xpYi91bml0LXRlc3QubGliLnRzJ1xuXG5oQXJncyA6PSBnZXRDbWRBcmdzKClcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuREJHIFwiZW51bSBMb2dDbWRcIlxuXG5zdWNjZWVkcyAoKSA9PlxuXHRjbGVhckxvZygpXG5cdHNldExvZ0xldmVsICdpbmZvJ1xuXHRMT0cgXCJpbmZvXCIsIExvZ0NtZC5JTkRFTlRcblx0TE9HIFwic3R1ZmZcIiwgTG9nQ21kLlVOREVOVFxuXHRMT0cgXCJkb25lXCJcblx0ZXF1YWwgZ2V0TG9nKCksIFwiXCJcIlxuXHRcdEkgaW5mb1xuXHRcdEkgICAgc3R1ZmZcblx0XHRJIGRvbmVcblx0XHRcIlwiXCJcblxuREJHIFwiY2xlYXJMb2coKVwiLCBcImdldExvZygpXCJcblxuc3VjY2VlZHMgKCkgPT5cblx0Y2xlYXJMb2coKVxuXHRzZXRMb2dMZXZlbCAnaW5mbydcblx0TE9HIFwiaW5mb1wiLCBMb2dDbWQuSU5ERU5UXG5cdExPRyBcInN0dWZmXCIsIExvZ0NtZC5VTkRFTlRcblx0TE9HIFwiZmluaXNoZWRcIlxuXHRlcXVhbCBnZXRMb2coKSwgXCJcIlwiXG5cdFx0SSBpbmZvXG5cdFx0SSAgICBzdHVmZlxuXHRcdEkgZmluaXNoZWRcblx0XHRcIlwiXCJcblxuc3VjY2VlZHMgKCkgPT5cblx0Y2xlYXJMb2coKVxuXHRzZXRMb2dMZXZlbCAncHJvZmlsZSdcblx0TE9HIFwiaW5mb1wiLCBMb2dDbWQuSU5ERU5UXG5cdExPRyBcInN0dWZmXCIsIExvZ0NtZC5VTkRFTlRcblx0TE9HIFwiZG9uZVwiXG5cblx0bWF0Y2hlcyBnZXRMb2coKSwgLy8vXlxuXHRcdG1zIFxcblxuXHRcdC17NX0gXFxuXG5cdFx0XFxzKiBcXGQrIFxccyBJIFxccyBpbmZvIFxcblxuXHRcdFxccyogXFxkKyBcXHMgSSBcXHN7NH0gc3R1ZmZcblx0XHRcXHMqIFxcZCsgXFxzIEkgXFxzIGRvbmVcblx0XHQkLy8vXG5cbkRCRyBcInB1c2hMb2dMZXZlbCgpXCIsIFwicG9wTG9nTGV2ZWwoKVwiLCBcImN1ckxvZ0xldmVsKClcIlxuXG4oKCkgPT5cblx0c2F2ZSA6PSBjdXJMb2dMZXZlbCgpXG5cdHB1c2hMb2dMZXZlbCAnd2Fybidcblx0ZXF1YWwgY3VyTG9nTGV2ZWwoKSwgJ3dhcm4nXG5cdHB1c2hMb2dMZXZlbCAnZGVidWcnXG5cdGVxdWFsIGN1ckxvZ0xldmVsKCksICdkZWJ1Zydcblx0cG9wTG9nTGV2ZWwoKVxuXHRlcXVhbCBjdXJMb2dMZXZlbCgpLCAnd2Fybidcblx0cG9wTG9nTGV2ZWwoKVxuXHRlcXVhbCBjdXJMb2dMZXZlbCgpLCBzYXZlXG5cdCkoKVxuXG5EQkcgXCJEQkcoKVwiLCBcIkRCR1ZBTFVFKClcIiwgXCJMT0coKVwiLCBcIkxPR1ZBTFVFKClcIiwgXCJXQVJOKClcIiwgXCJFUlIoKVwiLCBcInNldExvZ0xldmVsKClcIiwgXCJnZXRGdWxsTG9nKClcIlxuXG4jIC0tLSBEZWZpbmUgMiBmdW5jdGlvbnMsIHVzZWZ1bCBpbiB1bml0IHRlc3RzXG5cbmxvZ0FsbCA6PSAoKTogdm9pZCA9PlxuXHREQkcgXCJkZWJ1Z1wiXG5cdERCR1ZBTFVFIFwibEl0ZW1zXCIsIFsnYScsJ2InXVxuXHRMT0cgXCJpbmZvXCJcblx0TE9HVkFMVUUgXCJoSXRlbXNcIiwge21lYW5pbmc6IDQyfVxuXHRXQVJOIFwid2FybmluZ1wiXG5cdEVSUiBcImVycm9yXCJcblx0cmV0dXJuXG5cbmdldFRlc3RMb2cgOj0gKGxldmVsOiBzdHJpbmc9J2luZm8nKTogc3RyaW5nID0+XG5cdGNsZWFyTG9nKClcblx0c2V0TG9nTGV2ZWwgbGV2ZWxcblx0bG9nQWxsKClcblx0cmV0dXJuIGdldExvZygpXG5cbnN1Y2NlZWRzICgpID0+XG5cdGNsZWFyTG9nKClcblx0c2V0TG9nTGV2ZWwgJ3dhcm4nXG5cdGxvZ0FsbCgpXG5cdGFzc2VydCAoY3VyTG9nTGV2ZWwoKSA9PSAnd2FybicpXG5cblx0c2V0TG9nTGV2ZWwoJ2luZm8nKVxuXHRsb2dBbGwoKVxuXHRhc3NlcnQgKGN1ckxvZ0xldmVsKCkgPT0gJ2luZm8nKVxuXG5cdHB1c2hMb2dMZXZlbCgnZXJyb3InKVxuXHRsb2dBbGwoKVxuXHRhc3NlcnQgKGN1ckxvZ0xldmVsKCkgPT0gJ2Vycm9yJylcblxuXHRwb3BMb2dMZXZlbCgpXG5cdGxvZ0FsbCgpXG5cdGFzc2VydCAoY3VyTG9nTGV2ZWwoKSA9PSAnaW5mbycpXG5cblx0YXNzZXJ0IChnZXRMb2coKSA9PSBcIlwiXCJcblx0XHRXIHdhcm5pbmdcblx0XHRFUlJPUjogZXJyb3Jcblx0XHRJIGluZm9cblx0XHRJIGhJdGVtcyA9IHtcblx0XHQje3NwYWNlcygzKX1cIm1lYW5pbmdcIjogNDJcblx0XHR9XG5cdFx0VyB3YXJuaW5nXG5cdFx0RVJST1I6IGVycm9yXG5cdFx0RVJST1I6IGVycm9yXG5cdFx0SSBpbmZvXG5cdFx0SSBoSXRlbXMgPSB7XG5cdFx0I3tzcGFjZXMoMyl9XCJtZWFuaW5nXCI6IDQyXG5cdFx0fVxuXHRcdFcgd2FybmluZ1xuXHRcdEVSUk9SOiBlcnJvclxuXHRcdFwiXCJcIilcblxuXHRhc3NlcnQgKGdldEZ1bGxMb2coKSA9PSBcIlwiXCJcblx0XHRXIHdhcm5pbmdcblx0XHRFUlJPUjogZXJyb3Jcblx0XHRJIGluZm9cblx0XHRJIGhJdGVtcyA9IHtcblx0XHQje3NwYWNlcygzKX1cIm1lYW5pbmdcIjogNDJcblx0XHR9XG5cdFx0VyB3YXJuaW5nXG5cdFx0RVJST1I6IGVycm9yXG5cdFx0RVJST1I6IGVycm9yXG5cdFx0SSBpbmZvXG5cdFx0SSBoSXRlbXMgPSB7XG5cdFx0I3tzcGFjZXMoMyl9XCJtZWFuaW5nXCI6IDQyXG5cdFx0fVxuXHRcdFcgd2FybmluZ1xuXHRcdEVSUk9SOiBlcnJvclxuXHRcdFwiXCJcIilcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuREJHIFwiZ2V0TG9nKClcIlxuXG4oKCkgPT5cblx0ZXF1YWwgZ2V0VGVzdExvZygpLCBcIlwiXCJcblx0XHRJIGluZm9cblx0XHRJIGhJdGVtcyA9IHtcblx0XHQje3NwYWNlcygzKX1cIm1lYW5pbmdcIjogNDJcblx0XHR9XG5cdFx0VyB3YXJuaW5nXG5cdFx0RVJST1I6IGVycm9yXG5cdFx0XCJcIlwiXG5cdCkoKVxuXG4oKCkgPT5cblx0ZXF1YWwgZ2V0VGVzdExvZygnZGVidWcnKSwgXCJcIlwiXG5cdFx0RCBkZWJ1Z1xuXHRcdEQgbEl0ZW1zID0gW1xuXHRcdCN7c3BhY2VzKDMpfVwiYVwiLFxuXHRcdCN7c3BhY2VzKDMpfVwiYlwiXG5cdFx0XVxuXHRcdEkgaW5mb1xuXHRcdEkgaEl0ZW1zID0ge1xuXHRcdCN7c3BhY2VzKDMpfVwibWVhbmluZ1wiOiA0MlxuXHRcdH1cblx0XHRXIHdhcm5pbmdcblx0XHRFUlJPUjogZXJyb3Jcblx0XHRcIlwiXCJcblx0KSgpXG5cbigoKSA9PlxuXHRlcXVhbCBnZXRUZXN0TG9nKCdlcnJvcicpLCBcIlwiXCJcblx0XHRFUlJPUjogZXJyb3Jcblx0XHRcIlwiXCJcblx0KSgpXG4iXX0=