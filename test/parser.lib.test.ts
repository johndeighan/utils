"use strict";
// parser.lib.test.civet

import {
	hash, getCmdArgs, DBG,
	} from '../src/lib/utils.lib.ts'
import {
	KeppelGrammar,
	} from './parser/keppel.grammar.ts'
import {
	TState, getState, StringMatcher, RegexMatcher,
	getParser, Node,
	} from '../src/lib/parser.lib.ts'
import {
	equal, same, like, succeeds, fails, truthy, falsy,
	matches, isType, notType, objListLike,
	} from '../src/lib/unit-test.lib.ts'

getCmdArgs()
const htmlParse = getParser<hash>(KeppelGrammar)

// ---------------------------------------------------------------------------
// --- test getState()

equal(getState('abc'), {
	text: 'abc',
	ignore: [],
	stack: [],
	sp: 0,
	lastPos: {pos: 0, line: 1, column: 1},
	pos: 0
	})

equal(getState('abc', 2), {
	text: 'abc',
	ignore: [],
	stack: [],
	sp: 0,
	lastPos: {pos: 0, line: 1, column: 1},
	pos: 2
	});

// ---------------------------------------------------------------------------
// --- test StringMatcher()

(() => {
	const rule = StringMatcher('abc')
	like(rule(getState('abcdef')), {pos: 3})
	fails(() => rule(getState('abcdef', 3)))
}
	)();

(() => {
	const rule = StringMatcher('def')
	like(rule(getState('abcdef')), {pos: 0})
	like(rule(getState('abcdef', 3)), {pos: 6})

	// --- On failure to match, should return the same TState
	const $ = getState('abcdef')
	same(rule($), $)
}
	)();

// ---------------------------------------------------------------------------
// --- test RegexMatcher()

(() => {
	const rule = RegexMatcher(/^[\.\#]\s/)
	like(rule(getState('. abc')), {pos: 2})
	fails(() => rule(getState('. abc', 1)))
}
	)();

(() => {
	const rule = RegexMatcher(/^[\.\#]\s/)
	like(rule(getState('abc . def')), {pos: 0})
	like(rule(getState('abc . def', 4)), {pos: 6})

	// --- On failure to match, should return the same TState
	const $ = getState('abc . abc')
	same(rule($), $)
}
	)();

// ---------------------------------------------------------------------------
// --- test Node<T>

(() => {
	const reducer = (
			lMatches: string[],
			$: TState,
			$next: TState
			): string => {
		return 'X'
	}

	// --- This rule will attempt to match the string 'abc'
	//     when it matches, the reducer is called, and
	//     what it returns is put on the stack
	const rule = Node<string>('abc', reducer)

	const $ = getState('abcdef')
	equal(rule($), {
	   "text": "abcdef",
	   "ignore": [],
	   "stack": ['X'],
	   "sp": 1,
	   "lastPos": {
	      "pos": 0,
	      "line": 1,
	      "column": 1
			},
		"pos": 3
		})
}
	)()

// ---------------------------------------------------------------------------

equal(htmlParse('p'), {
	type: 'element',
	tag: 'p'
	})

const keppelStr99 = `body [    // I am a comment
  div #navbar .navbar.navbar-inverse.navbar-fixed-top [
	 div.navbar-inner [
		a(href="#", test="My test").brand ['Awesome']
		ul.nav [
		  li[ a(href="#") ['Item 1'] ]
		  li[ a(href="#") ['Item 2'] ]
		]
	 ]
  ]
]
// I am a comment in the end of input`

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC9wYXJzZXIubGliLnRlc3QuY2l2ZXQudHN4Iiwic291cmNlcyI6WyJ0ZXN0L3BhcnNlci5saWIudGVzdC5jaXZldCJdLCJtYXBwaW5ncyI6IjtBQUFBLHdCQUF1QjtBQUN2QixBQUFBO0FBQ0EsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsSUFBSSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQ3ZCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBeUI7QUFDakMsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxhQUFhLENBQUM7QUFDZixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsNEJBQTRCO0FBQ3BDLEFBQUEsQUFBQSxNQUFNLENBQUMsQ0FBQztBQUNSLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsWUFBWSxDQUFDO0FBQy9DLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ2pCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywwQkFBMEI7QUFDbEMsQUFBQSxBQUFBLE1BQU0sQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUM7QUFDbkQsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLENBQUM7QUFDdkMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLDZCQUE2QjtBQUNyQyxBQUFBO0FBQ0EsQUFBQSxBQUFBLFVBQVUsQ0FBQyxDQUFDO0FBQ1osQUFBQSxBQUFTLE1BQVQsU0FBUyxDQUFDLENBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsYUFBYSxDQUFDO0FBQzNDLEFBQUE7QUFDQSxBQUFBLDhFQUE2RTtBQUM3RSxBQUFBLHNCQUFxQjtBQUNyQixBQUFBO0FBQ0EsQUFBQSxBQUFBLEtBQUssQ0FBQSxBQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDeEIsQUFBQSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQTtBQUNaLEFBQUEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUNYLEFBQUEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUNWLEFBQUEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDTixBQUFBLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUN0QyxBQUFBLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFBO0FBQ0YsQUFBQTtBQUNBLEFBQUEsQUFBQSxLQUFLLENBQUEsQUFBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzNCLEFBQUEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUE7QUFDWixBQUFBLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDWCxBQUFBLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDVixBQUFBLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ04sQUFBQSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDdEMsQUFBQSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQyxDQUFBO0FBQ0YsQUFBQTtBQUNBLEFBQUEs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Q2pCLEFBQUEsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25CLEFBQUEsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDWixBQUFBLElBQUksU0FBUyxDQUFDLENBQUMsQ0FBQztBQUNoQixBQUFBLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2hCLEFBQUEsT0FBTyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakIsQUFBQSxPQUFPLFFBQVEsQ0FBQyxDQUFDLENBQUM7QUFDbEIsR0FBRyxDQUFDLENBQUM7QUFDTCxBQUFBLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztBQUNWLEVBQUUsQ0FBQyxDO0FBQUEsQ0FBQTtBQUNILENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDSixBQUFBO0FBQ0EsQUFBQSw4RUFBNkU7QUFDN0UsQUFBQTtBQUNBLEFBQUEsQUFBQSxLQUFLLENBQUEsQUFBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3ZCLEFBQUEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUE7QUFDaEIsQUFBQSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUc7QUFDVCxDQUFDLENBQUMsQ0FBQTtBQUNGLEFBQUE7QUFDQSxBQUFBLEFBQVcsTUFBWCxXQUFXLENBQUMsQ0FBRSxDQUFDLENBQUc7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FFQyxDQUFHO0FBQ0oiLCJuYW1lcyI6W10sInNvdXJjZXNDb250ZW50IjpbIiMgcGFyc2VyLmxpYi50ZXN0LmNpdmV0XG5cbmltcG9ydCB7XG5cdGhhc2gsIGdldENtZEFyZ3MsIERCRyxcblx0fSBmcm9tICcuLi9zcmMvbGliL3V0aWxzLmxpYi50cydcbmltcG9ydCB7XG5cdEtlcHBlbEdyYW1tYXIsXG5cdH0gZnJvbSAnLi9wYXJzZXIva2VwcGVsLmdyYW1tYXIudHMnXG5pbXBvcnQge1xuXHRUU3RhdGUsIGdldFN0YXRlLCBTdHJpbmdNYXRjaGVyLCBSZWdleE1hdGNoZXIsXG5cdGdldFBhcnNlciwgTm9kZSxcblx0fSBmcm9tICcuLi9zcmMvbGliL3BhcnNlci5saWIudHMnXG5pbXBvcnQge1xuXHRlcXVhbCwgc2FtZSwgbGlrZSwgc3VjY2VlZHMsIGZhaWxzLCB0cnV0aHksIGZhbHN5LFxuXHRtYXRjaGVzLCBpc1R5cGUsIG5vdFR5cGUsIG9iakxpc3RMaWtlLFxuXHR9IGZyb20gJy4uL3NyYy9saWIvdW5pdC10ZXN0LmxpYi50cydcblxuZ2V0Q21kQXJncygpXG5odG1sUGFyc2UgOj0gZ2V0UGFyc2VyPGhhc2g+KEtlcHBlbEdyYW1tYXIpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIC0tLSB0ZXN0IGdldFN0YXRlKClcblxuZXF1YWwgZ2V0U3RhdGUoJ2FiYycpLCB7XG5cdHRleHQ6ICdhYmMnXG5cdGlnbm9yZTogW11cblx0c3RhY2s6IFtdXG5cdHNwOiAwXG5cdGxhc3RQb3M6IHtwb3M6IDAsIGxpbmU6IDEsIGNvbHVtbjogMX1cblx0cG9zOiAwXG5cdH1cblxuZXF1YWwgZ2V0U3RhdGUoJ2FiYycsIDIpLCB7XG5cdHRleHQ6ICdhYmMnXG5cdGlnbm9yZTogW11cblx0c3RhY2s6IFtdXG5cdHNwOiAwXG5cdGxhc3RQb3M6IHtwb3M6IDAsIGxpbmU6IDEsIGNvbHVtbjogMX1cblx0cG9zOiAyXG5cdH1cblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIHRlc3QgU3RyaW5nTWF0Y2hlcigpXG5cbigoKSA9PlxuXHRydWxlIDo9IFN0cmluZ01hdGNoZXIoJ2FiYycpXG5cdGxpa2UgcnVsZShnZXRTdGF0ZSgnYWJjZGVmJykpLCB7cG9zOiAzfVxuXHRmYWlscyAoKSA9PiBydWxlKGdldFN0YXRlKCdhYmNkZWYnLCAzKSlcblx0KSgpXG5cbigoKSA9PlxuXHRydWxlIDo9IFN0cmluZ01hdGNoZXIoJ2RlZicpXG5cdGxpa2UgcnVsZShnZXRTdGF0ZSgnYWJjZGVmJykpLCB7cG9zOiAwfVxuXHRsaWtlIHJ1bGUoZ2V0U3RhdGUoJ2FiY2RlZicsIDMpKSwge3BvczogNn1cblxuXHQjIC0tLSBPbiBmYWlsdXJlIHRvIG1hdGNoLCBzaG91bGQgcmV0dXJuIHRoZSBzYW1lIFRTdGF0ZVxuXHQkIDo9IGdldFN0YXRlKCdhYmNkZWYnKVxuXHRzYW1lIHJ1bGUoJCksICRcblx0KSgpXG5cbiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIC0tLSB0ZXN0IFJlZ2V4TWF0Y2hlcigpXG5cbigoKSA9PlxuXHRydWxlIDo9IFJlZ2V4TWF0Y2hlcigvXltcXC5cXCNdXFxzLylcblx0bGlrZSBydWxlKGdldFN0YXRlKCcuIGFiYycpKSwge3BvczogMn1cblx0ZmFpbHMgKCkgPT4gcnVsZShnZXRTdGF0ZSgnLiBhYmMnLCAxKSlcblx0KSgpXG5cbigoKSA9PlxuXHRydWxlIDo9IFJlZ2V4TWF0Y2hlcigvXltcXC5cXCNdXFxzLylcblx0bGlrZSBydWxlKGdldFN0YXRlKCdhYmMgLiBkZWYnKSksIHtwb3M6IDB9XG5cdGxpa2UgcnVsZShnZXRTdGF0ZSgnYWJjIC4gZGVmJywgNCkpLCB7cG9zOiA2fVxuXG5cdCMgLS0tIE9uIGZhaWx1cmUgdG8gbWF0Y2gsIHNob3VsZCByZXR1cm4gdGhlIHNhbWUgVFN0YXRlXG5cdCQgOj0gZ2V0U3RhdGUoJ2FiYyAuIGFiYycpXG5cdHNhbWUgcnVsZSgkKSwgJFxuXHQpKClcblxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgLS0tIHRlc3QgTm9kZTxUPlxuXG4oKCkgPT5cblx0cmVkdWNlciA6PSAoXG5cdFx0XHRsTWF0Y2hlczogc3RyaW5nW11cblx0XHRcdCQ6IFRTdGF0ZVxuXHRcdFx0JG5leHQ6IFRTdGF0ZVxuXHRcdFx0KTogc3RyaW5nID0+XG5cdFx0cmV0dXJuICdYJ1xuXG5cdCMgLS0tIFRoaXMgcnVsZSB3aWxsIGF0dGVtcHQgdG8gbWF0Y2ggdGhlIHN0cmluZyAnYWJjJ1xuXHQjICAgICB3aGVuIGl0IG1hdGNoZXMsIHRoZSByZWR1Y2VyIGlzIGNhbGxlZCwgYW5kXG5cdCMgICAgIHdoYXQgaXQgcmV0dXJucyBpcyBwdXQgb24gdGhlIHN0YWNrXG5cdHJ1bGUgOj0gTm9kZTxzdHJpbmc+KCdhYmMnLCByZWR1Y2VyKVxuXG5cdCQgOj0gZ2V0U3RhdGUoJ2FiY2RlZicpXG5cdGVxdWFsIHJ1bGUoJCksIHtcblx0ICAgXCJ0ZXh0XCI6IFwiYWJjZGVmXCIsXG5cdCAgIFwiaWdub3JlXCI6IFtdLFxuXHQgICBcInN0YWNrXCI6IFsnWCddLFxuXHQgICBcInNwXCI6IDEsXG5cdCAgIFwibGFzdFBvc1wiOiB7XG5cdCAgICAgIFwicG9zXCI6IDAsXG5cdCAgICAgIFwibGluZVwiOiAxLFxuXHQgICAgICBcImNvbHVtblwiOiAxXG5cdFx0XHR9LFxuXHRcdFwicG9zXCI6IDNcblx0XHR9XG5cdCkoKVxuXG4jIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5lcXVhbCBodG1sUGFyc2UoJ3AnKSwge1xuXHR0eXBlOiAnZWxlbWVudCdcblx0dGFnOiAncCdcblx0fVxuXG5rZXBwZWxTdHI5OSA6PSBcIlwiXCJcblx0Ym9keSBbICAgIC8vIEkgYW0gYSBjb21tZW50XG5cdCAgZGl2ICNuYXZiYXIgLm5hdmJhci5uYXZiYXItaW52ZXJzZS5uYXZiYXItZml4ZWQtdG9wIFtcblx0XHQgZGl2Lm5hdmJhci1pbm5lciBbXG5cdFx0XHRhKGhyZWY9XCIjXCIsIHRlc3Q9XCJNeSB0ZXN0XCIpLmJyYW5kIFsnQXdlc29tZSddXG5cdFx0XHR1bC5uYXYgW1xuXHRcdFx0ICBsaVsgYShocmVmPVwiI1wiKSBbJ0l0ZW0gMSddIF1cblx0XHRcdCAgbGlbIGEoaHJlZj1cIiNcIikgWydJdGVtIDInXSBdXG5cdFx0XHRdXG5cdFx0IF1cblx0ICBdXG5cdF1cblx0Ly8gSSBhbSBhIGNvbW1lbnQgaW4gdGhlIGVuZCBvZiBpbnB1dFxuXHRcIlwiXCJcbiJdfQ==